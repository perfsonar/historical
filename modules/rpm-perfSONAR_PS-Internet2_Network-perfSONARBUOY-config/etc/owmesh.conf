# owmesh.conf - Configuration file for scheduled test component of perfSONAR-BUOY
# $Id$

	# Not likely to change... Probably should move to DEFS in OWP::Conf.pm
BWSessionSuffix	.recv.bw
DevNull			/dev/null
	# SummarySuffix is cat'd onto SessionSuffix
SummarySuffix		.sum

#################
#
# POSSIBLE CHANGE
#
#################
    # binary/location information.  Use this to specify if not found in $PATH
BWCmd			bwctl
BWBinDir		/usr/bin

#################
#
# POSSIBLE CHANGE
#
#################
	# These dirs MUST be in the same filesystem!
BWDataDir		/home/perfsonarbuoy/bwctl
BWCentralDataDir	/home/perfsonarbuoy/bwctl/upload
BWCentralArchDir	/home/perfsonarbuoy/bwctl/archive

	# Global in nature...shouldn't change
ConfigVersion		20080715.0

    # SecretName is "fetched" relative to Node, so that different nodes
    # can use different keys.

SecretNames		15Jul2008 07Jan2007 17Aug2006 21Mar2003 FallBack
SecretName		15Jul2008
15Jul2008       AFestivusForTheRestOfUs
07Jan2007       LongLiveRFC4645
17Aug2006       OwampLivesAgain
21Mar2003       NewFullMeshPasswd
FallBack        TingsBeBerryBerryBadMon

    # Logging info
!Debug
!Verbose
SyslogFacility		local5

    # user:group info
UserName		perfsonarbuoy
GroupName		perfsonar

	# If set, only allow contact from CONTACTADDR's defined for each node
!VerifyPeerAddr
!BWVerifyPeerAddr

	# read timeout on file upload socket.
BWCentralHostTimeout	3600
BWCentralHost		owamp.net.internet2.edu:8570

#################
#
# POSSIBLE CHANGE
#
#################
	# Database info
!CentralDBHost
CentralDBType		DBI:mysql
CentralDBUser		I2NETowamp
CentralDBPass		481l3n0wp
BWCentralDBName 	I2NETbwctl

	# add a read only user so that the cgis have minimum privileges
CGIDBUser		readonly
CGIDBPass		readonly
CGITmpDir               /tmp
#Ploticus                /usr/bin/pl

	# connect/write/read timeout for sending socket (Can be set on a
	# per-node bases if needed.)
SendTimeout		60
SaveThreshold	25

	# Address types and descriptions
	# On Abilene, LAT addrs map to nms4-* and BW addrs map to nms1-*
	# On I2NET, LAT addrs map to nms-rlat and BW addrs map to nms-?thr?
ADDRTYPES   [[BW4 BW6]]

	# ADDRDESC is relative to 'node' so it can be over-ridden in NODE blocks
	# (Useful for specifying the ISP a given address is associated with.)
BW4ADDRDESC   IPv4 Throughput
BW6ADDRDESC   IPv6 Throughput


#######################################################################
# BWCTL Iperf-TCP Test Definition

<TESTSPEC=BWTCP>
DESCRIPTION                     TCP Throughput (iperf)
TOOL                            bwctl/iperf

# seconds - every 30 mins (on average)
BWTestInterval			1800

# alpha - percentage to vary each start interval by. (ranomize +/- interval)
BWTestIntervalStartAlpha	25

# seconds
BWReportInterval		2

# TCP send/recv buffer size. (Might not be good to set for auto-scaling kernels)
BWWindowSize			4m

# do a tcp test
BWTCP

# seconds
BWTestDuration		        60

</TESTSPEC>

#######################################################################
# BWCTL Iperf-UDP Test Definition

<TESTSPEC=BWUDP>
DESCRIPTION                     UDP Throughput (iperf)
TOOL                            bwctl/iperf

# udp test
BWUDP

# seconds
BWTestDuration		10

# bandwidth target
BWUDPBandwidthLimit	900m

# len of read/write user-space buffers (iperf -l)
BWBufferLen		8192

# for udp, max read length.
BWWindowSize		1m

# seconds - once per hour
BWTestInterval			3600

# randomize each start by alpha% from the next fixed interval time
BWTestIntervalStartAlpha	25

# intermediate reports (seconds)
BWReportInterval		2

</TESTSPEC>


#################
#
# MUST CHANGE
#
#################

#######################################################################
# Host definitions, should equal the result of a `uname -a`, this is
#   how the master will determine which machine is running a test.  Its a good
#   idea to enter all machines that are involved in all tests here.

<HOST=nms-rthr2.atla*>
NODE    ATLA
</HOST>
<HOST=nms-rthr2.chic*>
NODE    CHIC
</HOST>
<HOST=nms-rthr2.hous*>
NODE    HOUS
</HOST>
<HOST=nms-rthr2.kans*>
NODE    KANS
</HOST>
<HOST=nms-rthr2.losa*>
NODE    LOSA
</HOST>
<HOST=nms-rthr2.newy*>
NODE    NEWY
</HOST>
<HOST=nms-rthr2.salt*>
NODE    SALT
</HOST>
#<HOST=nms-rthr2.seat*>
#NODE    SEAT
#</HOST>
<HOST=nms-rthr2.wash*>
NODE    WASH
</HOST>

#################
#
# MUST CHANGE
#
#################

#######################################################################
# Node Definitions, needed for each potential member of a mesh

#NODES   [[ATLA CHIC HOUS KANS LOSA NEWY SALT SEAT WASH]]
NODES   [[ATLA CHIC HOUS KANS LOSA NEWY SALT WASH]]

<NODE=ATLA>
#IGNORE
LONGNAME        Internet2 Atlanta
CONTACTADDR     64.57.16.66
BW4ADDR         64.57.16.66
BW6ADDR         [2001:468:1:11::16:16]
#NOAGENT
</NODE>

<NODE=CHIC>
#IGNORE
LONGNAME        Internet2 Chicago
CONTACTADDR     64.57.17.22
BW4ADDR         64.57.17.22
BW6ADDR         [2001:468:2:100::17:22]
#NOAGENT
</NODE>

<NODE=HOUS>
#IGNORE
LONGNAME        Internet2 Houston
CONTACTADDR     64.57.16.150
BW4ADDR         64.57.16.150
BW6ADDR         [2001:468:3:100::16:150]
#NOAGENT
</NODE>

<NODE=KANS>
#IGNORE
LONGNAME        Internet2 Kansas City
CONTACTADDR     64.57.16.214
BW4ADDR         64.57.16.214
BW6ADDR         [2001:468:4:100::16:214]
#NOAGENT
</NODE>

<NODE=LOSA>
#IGNORE
LONGNAME        Internet2 Los Angeles
CONTACTADDR     64.57.17.150
BW4ADDR         64.57.17.150
BW6ADDR         [2001:468:5:101::17:150]
#NOAGENT
</NODE>

<NODE=NEWY>
#IGNORE
#DEBUG
LONGNAME        Internet2 New York City
CONTACTADDR     64.57.17.86
BW4ADDR         64.57.17.86
BW6ADDR         [2001:468:6:100::17:86]
#NOAGENT
</NODE>

<NODE=SALT>
#IGNORE
LONGNAME        Internet2 Salt Lake City
CONTACTADDR     64.57.17.214
BW4ADDR         64.57.17.214
BW6ADDR         [2001:468:7:100::17:214]
#NOAGENT
</NODE>

#<NODE=SEAT>
#IGNORE
#LONGNAME        Internet2 Seattle
#CONTACTADDR     64.57.19.??
#BW4ADDR        64.57.19.??
#BW6ADDR        [2001:468:2:101::19:??]
#NOAGENT
#</NODE>

<NODE=WASH>
#IGNORE
LONGNAME        Internet2 Washington
CONTACTADDR     64.57.16.22
BW4ADDR         64.57.16.22
BW6ADDR         [2001:468:9:100::16:22]
#NOAGENT
</NODE>

#################
#
# MUST CHANGE
#
#################

#######################################################################
# Group Definition

<GROUP=I2OBS>
DESCRIPTION     Internet2 Network Observatory Full Mesh
GROUPTYPE       MESH

#NODES   [[ATLA CHIC HOUS KANS LOSA NEWY SALT SEAT WASH]]
NODES   [[ATLA CHIC HOUS KANS LOSA NEWY SALT WASH]]

# Add another node in that will 'send' to every receiver
#INCLUDE_SENDERS
# Remove specific senders from the full mesh (takes precedence)
#EXCLUDE_SENDERS
# Add another node in that will 'recv' from every sender
#INCLUDE_RECEIVERS
# Remove specific receivers from the full mesh (takes precedence)
#EXCLUDE_RECEIVERS
</GROUP>

#######################################################################
# Measurement Sets

# mesh bwctl tcp v4
<MeasurementSet=I2OBSBWTCP4>
DESCRIPTION	Internet2 Network IPv4 TCP Throughput
ADDRTYPE	BW4
GROUP           I2OBS
TESTSPEC        BWTCP

EXCLUDE_SELF
#CENTRALLY_INVOKED
</MeasurementSet>

# mesh bwctl tcp v6
<MeasurementSet=I2OBSBWTCP6>
DESCRIPTION	Internet2 Network IPv6 TCP Throughput
ADDRTYPE	BW6
GROUP           I2OBS
TESTSPEC        BWTCP

EXCLUDE_SELF
#CENTRALLY_INVOKED
</MeasurementSet>

# bwctl udp v4
<MeasurementSet=I2OBSBWUDP4>
DESCRIPTION	Internet2 Network IPv4 UDP Throughput
ADDRTYPE	BW4
GROUP           I2OBS
TESTSPEC        BWUDP

EXCLUDE_SELF
#CENTRALLY_INVOKED
</MeasurementSet>

# bwctl udp v6
<MeasurementSet=I2OBSBWUDP6>
DESCRIPTION	Internet2 Network IPv6 UDP Throughput
ADDRTYPE	BW6
GROUP           I2OBS
TESTSPEC        BWUDP

EXCLUDE_SELF
#CENTRALLY_INVOKED
</MeasurementSet>
