#summary perfSONAR Network Performance Toolkit Quick Start

<wiki:toc max_depth="6" />

== Installation and Configuration ==

The following guide describes in detail the steps required to set up the _perfSONAR_ Network Performance Toolkit.  It is important to follow each step in order.  Upon getting stuck, consult the [NPToolkitQuickStart#FAQ FAQ] at the end of this document.  

=== First Steps ===

  # Download the the latest from:
    * [http://www.perfsonar.net/download/bundles/pS-NPToolkit/current.iso]
    * [http://www.perfsonar.net/download/bundles/pS-NPToolkit/current.md5]
  # Verify the MD5 sum:
    * md5sum -c pS-NPToolkit-2.0.iso 
  # Burn the ISO to a CD-ROM
  # Configure the computer to boot from CD
    * This may require changes to the computer's BIOS to ensure the CD is recognized before an existing harddisk
    * The BIOS may be entered when the computer boots by using a key combination (*F12* in some cases, *Del* in others - consult a manual if unsure or pay close attention to the boot process to enter _setup_).  
  # Insert the CD-ROM into the tray and boot the system
    * The computer will boot with some typical messages, after this it will enter the boot and customization process.
      * http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_1_boot.png
    * The boot process will proceed after this screen where typical linux startup messages will be seen.
      * http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_2_startup.png

=== Console Configuration ===

After the boot process, there will be a menu of options. 

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_3_menu.png

Each step will be explained here with pictures where applicable.  

==== Step 1 ==== 

To properly store configuration information and stored measurement data, a drive must be configured to act as storage.  Normally we would expect the onboard disk to fill this role, but optionally a external drive such as a USB flash device may be used.  There are minimal requirements for the storage:

 * Should be large enough to hold configuration files and measurement data
   * Minimum of a gigabyte for short term use
   * Much larger recommended (80G) for long term deployment
 * Should be in the _ext3_ format
   * If the disk is already formatted, the software will use existing space and _*WILL NOT*_ delete or corrupt existing data.
   * If not, there will be an option to format the disk before use.
   * See also [NPToolkit#FAQ FAQ] for issues regarding disk formatting.

The following images demonstrate the steps of this particular configuration option.

 * First select a drive to use.  In this example there is only one disk available.
   * http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_4_option1_1.png
 * In this screen the option to format was selected.  Note that reboot will be required.
   * http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_5_option1_2.png
 * Similar to the previous step, the option to format was not selected (the disk in this case was already readable).  After the saving step the menu will re-appear.
   * http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_6_option1_3.png

==== Step 2 ====

There are some basic items that are useful to all services from both a customization point of view (e.g. personalized web pages and menus) as well as a global discovery point of view (e.g. finding specific data for a specific institutions resources).

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_7_option2.png

===== Community Keywords =====

A particular question, _Enter the communities of interest_, can be confusing to answer for new users.  This particular question is trying to associate some _loosely coupled_ labels to the data that the perfSONAR NPToolkit disk will be making available to the larger world.  Think of this step similar to assigning labels to photos or music.  Some examples of valid answers are:

 * *Internet2* - The data made available somehow connects the Internet2 backbone
 * *LHC* (*CMS*, *ATLAS*, etc.) - The disk is part of the LHC deployment structure
 * *eVLBI* - The disk is a part of the larger telescope community
 * *MAX* - A connector of member of the MAX gigapop

Use as many community names as necessary to properly categorize the data from the installation.  The menu will appear after this step is completed.

==== Step 3 ====

There are built in accounts for this installation:

 * _*knoppix*_ - user level permissions
 * _*root*_ - administrator permissions

These accounts must have the password set before leaving the configuration as they can be a security risk if let untouched.

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_8_option3.png

After this step, the menu will appear again.

==== Step 4 ====

All services are enabled by default with the exception of SSH.  This screen allows the administrator to turn off or on services before starting, thus allowing the disk use to be customized for specific circumstances.  The first screen lists the current services (disk defaults).  

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_9_option4_1.png

This is the appearance after enabling SSH.  

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_10_option4_2.png

===== Kerberosed SSH =====

Note that there are packages available on the disk that are capable of running ssh through [http://web.mit.edu/Kerberos/ Kerberos] (a requirement of many LHC site installations).  If the installation site has such requirements, ssh may be enabled after some configuration.

The requirement for kerberized SSH means that your Institution runs own PKI infrastructure. If your are not the sysadmin of the monitoring box then please consult with responsible person about PKi credentials for this host.

If you are the sysadmin:

 * If you deployed this disk on already configured linux box with existing  host credentials then mount host system root disk ( usually */UNIONFS/dev/sda1* or */UNIONFS/dev/hda1* ) as */UNIONFS/media/sda1* and copy */UNIONFS/media/sda1/etc/krb5.conf* and */UNIONFS/media/sda1/etc/krb5.keytab* files to */etc/* directory. Then edit /etc/ssh/sshd_config file according to your Institution's security policy.
For example in case of Fermilab it is required to prohibit all kinds of authentication except for Kerberos ticket exchange and GSSAPI.
 * If you deployed this disk on fresh box without any OS or without any host credentials then you should comply with your home Institution's security policy and apply for host registration and host's Kerberos credentials. Usually that means downloading *krb5.conf* file from some inranet location in the */etc/* deirectory and creating */etc/krb5.keytab*.  

==== Step 5 ====

Section 5 allows a finer grain of control over user accounts.  The first screen lists the available options.

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_11_option5_1.png

The first option is to add a new user, pictured below:

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_12_option5_2.png

The second option removes users.  Note that when a user does not exist the option will respond appropriately.  

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_13_option5_3.png

This shows a proper removal of a user.

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_14_option5_4.png

The last option is to change the password for a user.  Note that in the event a user doesn't exist a proper error message will be displayed.

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_15_option5_5.png

The final image shows a proper password change.  

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_16_option5_6.png

After done, the menu will re-appear.
   
==== Step 6 ====

In this step the BWCTL tool will be configured. It is recommended that very liberal and permissive rules are entered to allow maximum functionality. 

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_17_option6.png

After finishing, the menu will appear again.

==== Step 7 ====

To properly run several measurement tools, NTP is required.  This step allows the user to pick NTP services from a list.

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_18_option7_1.png

It is recommended that 3 to 4 _close_ servers are selected for timekeeping.  Do not choose _*more*_ than this because it may confuse NTP.  

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_19_option7_2.png

After selection is completed, the menu will re-appear.

==== Step 8 ====

In this step the OWAMP tool will be configured.  It is recommended that very liberal and permissive rules are entered to allow maximum functionality. 

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_20_option8.png

After finishing, the menu will appear again.

==== Step 9 ====

This is an optional step that can be called to configure a static IP address (instead of DHCP).  Note that this step will take some time to complete due to use of various network configuration tools.

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_21_option9.png

The menu will come back after completion.  

==== Step 10 ====

This step is also optional, and allows the user to change the timezone.  The first image shows that the default is EST/EDT: 

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_22_option10_1.png

The screen below shows the first stage after choosing the change the zone, selecting a region.  

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_23_option10_2.png

After selecting a region, localities will be printed to the screen.

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_24_option10_3.png

Finally we choose a new (or in this case the same) timezone.

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_25_option10_4.png

The menu will appear after this.

==== Step 11 ====

The final step allows the user to select the _advertised_ interface.  This simply means the interface that will be registered to the global directories.  

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_26_option11.png

After this step the menu will appear again.

==== Post Configuration ====

After exiting the menu, the machine may require a reboot.  

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_27_exit.png

If this is the case, please do so.  When the machine comes back up then simply exit the configuration (all menu items should be _green_ or _magenta_).  After performing all of these steps and exiting the menu the bootup process will start:
      
http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_28_reboot.png

The user will be faced with a prompt where loggin through the user accounts is possible:

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_29_prompt.png

There are some additional steps that can now be taken to configure some other services, specifically the _perfSONAR_ services. 

=== Web Configuration ===

Once the machine has booted it is now accessible via the static IP or a DHCP address.  To see the address use the */sbin/ifconfig* command from the console:

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_30_ifconfig.png

Once the contact information is known, use a web browser to view the status of the disk, e.g. visit *http://HOST_OR_ADDRESS* or *https://HOST_OR_ADDRESS* (_*https*_ is the default, and all communication will be redirected to there):

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_31_services_cgi.png

There are several GUIs that can be used configure services (note: to do this logging in as the _knoppix_ or other users added in [NPToolkitQuickStart#Step_5 Step 5] above is required.  Root _*cannot*_ log in):

 * https://HOST_OR_ADDRESS/admin/pinger
   * Used to configure hosts for the PingER tool
   * http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_32_PingER_Start.png
 * https://HOST_OR_ADDRESS/admin/perfsonarbuoy
   * Used to configure hosts for the perfSONAR-BUOY Bandwidth and Latency Tester
   * http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_33_pSB_Start.png
 * https://HOST_OR_ADDRESS/admin/cacti
   * Used to configure SNMP Hosts for the perfSONAR SNMP MA
   * http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_34_Cacti.png

==== Cacti Configuration ==== 

Please visit [NPToolkitCacti] for complete instructions regarding setting up Cacti for the polling of SNMP enabled network elements.

==== perfSONAR BUOY Configuration ==== 

Please visit [NPToolkitPerfSONARBUOY] for complete instructions on using the perfSONAR-BUOY configuration GUI to manage the scheduled polling of bandwidth and latency hosts.

==== PingER Configuration ==== 

Please visit [NPToolkitPingER] for complete instructions on using the PingER administrative GUI to manage the scheduled latency tests to remote sites.

=== Disk Verification ===

Once the machine has booted it is now accessible via the static IP or a DHCP address.  To see the address use the */sbin/ifconfig* command from the console:

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_30_ifconfig.png

Once he contact information is known, use a web browser to view the status of the disk, e.g. visit *http://HOST_OR_ADDRESS* or *https://HOST_OR_ADDRESS* (https is the default, and all communication will be redirected there anyway):

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_31_services_cgi.png

There are also several GUIs linked directly from this page that can be used to view the status of services:

==== Global Service Directory ==== 

Through the power of the Global Lookup Service (*gLS*) there are several GUIs available on the disk that can be used to display and locate services from around the world (including the newly set up instance after some requisite registration time).  The main interface is _directory.cgi_:

 * View services by category
 * Includes links to GUIs when applicable
 * http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_35_Directory.png

Note that many GUIs take advantage of caching techniques to limit the scope and frequency of the information queries: e.g. do not use this as a _real-time_ information source.

====  Cacti ==== 

This is a non-administrative view of cacti data.  This link can be shared with individuals and does not require a username or password.

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_36_Cacti.png

====  PingER ==== 

This GUI can be used to view the data of the on-board PingER instance or that of any other remote service.  Note that this GUI has a lot more power for selecting the time range and data sources than some of the [NPToolkitQuickStart#Service_Test Service Test] tools.

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_37_PingER.png

==== Java Owamp Client ==== 

The Java version of an OWAMP Client (jowping) has a simple interface that can be used to perform owamp tests to the onboard or any other OWAMP server.  

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_38_Java_OWAMP.png

==== NPAD ==== 

In addition to being a performance tool, NPAD features a web interface that can be used to locate the results of past tests.

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_39_NPAD.png

==== NDT ==== 

In addition to being a performance tool, NDT features a web interface that contains other relevant information.

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_40_NDT.png

==== Service Test ==== 

The _serviceTest.cgi_ script is able to test simple perfSONAR tasks to a variety of services; namely the three services included on this disk:

 * perfSONAR-BUOY
   * http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_41_pSB.png
 * PingER
   * http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_42_PingER.png
 * SNMP MA
   * http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_43_SNMP.png

Also note that if something is not configured properly, the following error condition can be seen:

http://perfsonar-ps.googlecode.com/svn/wiki/NPToolkit/NPK_44_Error.png
   
== FAQ ==

 * *Q: How do I logon to the console?*
 * *A:* The NPToolkit console is accessed by logging in as the user *_knoppix_*. In [NPToolkitQuickStart#Step_3 Step 3] it was required that the password for this user and _*root*_ were changed; use the values entered here to log in.  If other users were entered in [NPToolkitQuickStart#Step_5 Step 5] they may also log in.
 
 * *Q: How do I get an X-windows environment?*
 * *A:* The NPToolkit was designed for hands-off operations, so it boots into the console mode by default.  For users interested in working in an XWindows environment, [http://www.kde.org KDE] is available.  To bring the system up in X11 mode log in as *_knoppix_*, or any other valid user, and run the _startx_ command.

 * *Q: Where can I ask questions or report bugs?*
 * *A:* 
   * For questions, email to performance-node-users _at_ internet2 _dot_ edu.  You may also join the mailing list by visiting https://mail.internet2.edu/wws/subrequest/performance-node-users
   * For bugs, report at http://code.google.com/p/perfsonar-ps/issues/list . Label the bug as _*Component-NPToolkit*_, or state in the bug description the issue involves the NPToolkit.

 * *Q: How do I configure the SNMP MA?*
 * *A:* The SNMP MA is pre-configured to use the Cacti SNMP collection system. A step by step guide to configuring cacti is available in [NPToolkitCacti].

 * *Q: How do I configure the hosts PingER pings?*
 * *A:* There's an included GUI for configuring the sites PingER should collect ping between. A step by step guide to configuring PingER is available in [NPToolkitPingER].

 * *Q: How do I configure the hosts perfSONAR-BUOY pings?*
 * *A:* There's an included GUI for configuring the sites perfSONAR-BUOY should perform OWAMP/BWCTL tests between. A step by step guide to configuration is available in [NPToolkitPerfSONARBUOY].

 * *Q: How do I test that my services are working?*
 * *A:* There is a _self status_ page available on every installation: https://HOST.  See also [NPToolkitQuickStart#Service_Test Service Test] for information on the self testing.

 * *Q: What should I enter for the _Communities of interest_ configuration question?*
 * *A:* 
   * This question can be confusing to answer for new users.  The goal is to associate some _loosely coupled_ labels to the data that the perfSONAR NPToolkit disk will be making available to the larger world.  Think of this step similar to assigning labels to photos or music.  Some examples of valid answers are:
     * *Internet2* - The data made available somehow connects the Internet2 backbone
     * *LHC* (*CMS*, *ATLAS*, etc.) - The disk is part of the LHC deployment structure
     * *eVLBI* - The disk is a part of the larger telescope community
     * *MAX* - A connector of member of the MAX gigapop
   * Use as many community names as necessary to properly categorize the data from the installation. 

 * *Q: How do I enable jumbo frames so that it survives a reboot?*
 * *A:*  Add a line like "ifconfig eth0 mtu 9000" to the bottom of the file "/etc/rc.local".

 * *Q: What can I do if see errors like the following after booting up the CD:*
{{{
ide: failed opcode was: unknown
hda: no DRQ after issuing MULTWRITE_EXT
ide0: reset: success
}}}
 * *A:* A solution found by one user was to make a change in his BIOS. By default, their !SuperMicro motherboard was configured to see SATA drives as IDE so they had to change it to see the drive as SATA. For the !SuperMicro motherboard, they changed the BIOS option 'Serial ATA -> Native Mode Operation' from the default value of 'Auto' to 'Serial ATA'. If this does not solve your issue send an email the users list and we can try and figure out what's happening.

== Last Updated ==

$Id$