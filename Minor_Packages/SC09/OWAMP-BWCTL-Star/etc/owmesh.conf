# $Id: owmesh.conf 135 2007-02-08 02:03:25Z boote $
# Internet2 Network mesh config script.
#
# - boote

# Not likely to change... Probably should move to DEFS in Conf.pm.
OWPSessionSuffix	.owp
# SummarySuffix is cat'd onto SessionSuffix
SummarySuffix		.sum

OWPCmd			powstream
SessionSumCmd		owstats -M
DevNull			/dev/null

# Global in nature...
ConfigVersion		20070126.0

SecretNames		07Jan2007 17Aug2006 21Mar2003 FallBack
# SecretName is "fetched" relative to Node, so that different nodes
# can use different keys.
SecretName		07Jan2007
07Jan2007               LongLiveRFC4645
17Aug2006		OwampLivesAgain
21Mar2003		NewFullMeshPasswd
FallBack		TingsBeBerryBerryBadMon

# BEGIN BEGIN BEGIN BEGIN BEGIN BEGIN BEGIN BEGIN
#
# BEGIN of options that may need modification on a per-host basis
#
# BEGIN BEGIN BEGIN BEGIN BEGIN BEGIN BEGIN BEGIN
!Debug
!Verbose
SyslogFacility		local5

# TODO: Find a way to pass these in on the command-line so this
# config file doesn't need to change when owamp or ami is upgraded.
# owamp binaries and run-time paths
OWPBinDir		/usr/bin
OwampdVarDir		/var/run/ctp
OWPDataDir		/var/lib/owamp.ctp

UserName		owamp
GroupName		owamp

# END END END END END END END END
#
# END of options that may need modification on a per-host basis
#
# END END END END END END END END

<HOST=nms-rlat.wash*>
NODE    WASH
</HOST>

<HOST=nms-rlat.newy*>
NODE    NEWY
</HOST>

<HOST=nms-rlat.chic*>
NODE    CHIC
</HOST>

# this sucks, these may change...

<HOST=prpoly-dhcp34*>
NODE    AATRAVERSE 
</HOST>
<HOST=desk188*>
NODE    MITC
</HOST>
<HOST=lab248*>
NODE    HOTEL
</HOST>
<HOST=lab231*>
NODE    HOTELCAKEBOX
</HOST>
<HOST=lab249*>
NODE    HOTELSHUTTLE
</HOST>
<HOST=desk160*>
NODE    HARVARD
</HOST>
<HOST=Knoppix*>
NODE    MAX
</HOST>
<HOST=lab233*>
NODE    NOX
</HOST>

# Central host config params
# How do nms nodes contact the central database.
OWPCentralHost		ndb1.internet2.edu
OWPCentralHostPort	8801

# If set, only allow contact from CONTACTADDR's defined for each node
!OWPVerifyPeerAddr

# Where to uptime reports get sent for the central portion?
UpTimeSendToAddr	ndb1.internet2.edu
UpTimeSendToPort	8802

# read timeout on file upload socket.
OWPCentralHostTimeout	600

# These two dirs MUST be in the same filesystem!
OWPCentralDataDir		/home/ami/ctp/upload
OWPCentralArchDir		/home/ami/ctp/archive

# Database
!CentralDBHost
CentralDBType		DBI:mysql
CentralDBUser		LHCAmi
CentralDBPass		7hc4m1

OWPCentralDBName	owamp
BWCentralDBName 	bwctl

# add a read only user so that the cgis have minimum privileges
CGIDBUser		readonly
CGIDBPass		readonly

CGITmpDir               /tmp
Ploticus                /usr/bin/pl

#
# These define how the nms nodes deal with the uptime pairs on the local
# side and how often they send the updates.
#
UpTimeDBFile		liveupdate.db
# How often to send uptime updates. (seconds)
UpTimeSendInterval	300
# How many "pairs" of up/down times are send/saved.
UpTimeSendPairs		10
UpTimeMaxMesgLen	1024


# connect/write/read timeout for sending socket
# (Can be set on a per-node bases if needed.)
SendTimeout		60

#
# Stream definitions for each owamp mesh (Can be over-ridden in a MESH)
# (seconds)
#
OWPINTERVAL		0.1
OWPLOSSTHRESH		10.0

# SESSIONDURATION MUST be an even multiple of the lowest sample size
# from DIGESTRESLIST (seconds - indicates sample size for datafile)
# (10800 is 3 hours... Since 2 control connections are in use, this
# means our testing can survive ~6 hour network partitions.)
OWPSESSIONDURATION	10800

# defaults to min...
!OWPPACKETSIZE

#
# This defines how the delay data is aggregated. (This is the width of
# the histogram buckets. (100 usecs)
OWPBUCKETWIDTH		0.0001

# Address types and descriptions
# On Abilene, LAT addrs map to nms4-* and BW addrs map to nms1-*
# On I2NET, LAT addrs map to nms-rlat and BW addrs map to nms-?thr?
ADDRTYPES   [LAT4]

# ADDRDESC is relative to 'node' so it can be over-ridden in NODE blocks
# (Useful for specifying the ISP a given address is associated with.)
LAT4ADDRDESC   IP Latency

<MESH=AA>
TOOL		powstream
DESCRIPTION	CTP Demo Mesh
ADDRTYPE	LAT4

NODES    [[ MNTR AATRAVERSE MITC HOTEL WASH NEWY CHIC MAX HARVARD HARVARDALT NOX HOTELSHUTTLE HOTELCAKEBOX ]]
RECIVERS [[ AATRAVERSE MITC HOTEL WASH NEWY CHIC MAX HARVARD HARVARDALT NOX HOTELSHUTTLE HOTELCAKEBOX ]]
SENDERS  [[ AATRAVERSE MITC HOTEL WASH NEWY CHIC MAX HARVARD HARVARDALT NOX HOTELSHUTTLE HOTELCAKEBOX ]]
</MESH>

# Node specific defs.
<NODE=MNTR>
# bogus node used to identify the "monitoring" host so it can
# more easily be ignored.
IGNORE
CONTACTADDR	207.75.165.135
LONGNAME	patdev
</NODE>

NODES   [[ MNTR AATRAVERSE MITC HOTEL WASH NEWY CHIC MAX HARVARD HARVARDALT HOTELSHUTTLE HOTELCAKEBOX ]]

<NODE=WASH>
#IGNORE
LONGNAME		D.C. - POP
CONTACTADDR     	nms-rlat.wash.net.internet2.edu
UpTimeSendToAddr	nms-rlat.wash.net.internet2.edu

LAT4ADDR		nms-rlat.wash.net.internet2.edu
</NODE>

<NODE=NEWY>
#IGNORE
LONGNAME		NY - POP
CONTACTADDR     	nms-rlat.newy.net.internet2.edu
UpTimeSendToAddr	nms-rlat.newy.net.internet2.edu

LAT4ADDR		nms-rlat.newy.net.internet2.edu
</NODE>

<NODE=CHIC>
#IGNORE
LONGNAME		Chicago - POP
CONTACTADDR     	nms-rlat.chic.net.internet2.edu
UpTimeSendToAddr	nms-rlat.chic.net.internet2.edu

LAT4ADDR		nms-rlat.chic.net.internet2.edu
</NODE>

<NODE=AATRAVERSE>
#IGNORE
LONGNAME		AA - Traverse
CONTACTADDR     	207.75.165.34
UpTimeSendToAddr	207.75.165.34

LAT4ADDR		207.75.165.34
</NODE>

<NODE=MITC>
#IGNORE
LONGNAME                AA - MITC
CONTACTADDR             198.108.27.169
UpTimeSendToAddr        198.108.27.169

LAT4ADDR                198.108.27.169
</NODE>

<NODE=HOTEL>
#IGNORE
LONGNAME		D.C. - Hotel
CONTACTADDR     	206.196.182.51
UpTimeSendToAddr	206.196.182.51

LAT4ADDR		206.196.182.51
</NODE>

<NODE=MAX>
#IGNORE
LONGNAME		D.C. - MAX
CONTACTADDR     	perfsonar.dragon.maxgigapop.net
UpTimeSendToAddr	perfsonar.dragon.maxgigapop.net

LAT4ADDR		perfsonar.dragon.maxgigapop.net
</NODE>

<NODE=NOX>
#IGNORE
LONGNAME		Northern Crossroads
CONTACTADDR     	192.5.89.12
UpTimeSendToAddr	192.5.89.12

LAT4ADDR		192.5.89.12

#TESTPORTRANGE           8000-8025
</NODE>

<NODE=HARVARD>
#IGNORE
LONGNAME		Harvard
CONTACTADDR     	128.103.56.254
UpTimeSendToAddr	128.103.56.254

LAT4ADDR		128.103.56.254

#TESTPORTRANGE           8000-8025
</NODE>

<NODE=HARVARDALT>
#IGNORE
LONGNAME		Harvard - Alternate
CONTACTADDR     	128.103.56.252
UpTimeSendToAddr	128.103.56.252

LAT4ADDR		128.103.56.252

#TESTPORTRANGE           8000-8025
</NODE>

<NODE=HOTELSHUTTLE>
#IGNORE
LONGNAME		D.C. - Hotel (Shuttle)
CONTACTADDR     	206.196.182.52
UpTimeSendToAddr	206.196.182.52

LAT4ADDR		206.196.182.52
</NODE>

<NODE=HOTELCAKEBOX>
#IGNORE
LONGNAME		D.C. - Hotel (Cakebox)
CONTACTADDR     	206.196.182.55
UpTimeSendToAddr	206.196.182.55

LAT4ADDR		206.196.182.55
</NODE>


# Section to define resolution of data we are keeping, and what time periods
# we are keeping that data. (Some paramaters are added to aid in the "default"
# visualization of data at that resolution.)

# SaveThreshold indicates the amount (percentage) of "extra" data the
# implementation can keep above the "SavePeriod". It should be retrieved
# relative to the DIGESTRES so that it can be set on a per/resolution bases.
SaveThreshold	25
<DIGESTRES=10>
## 1 day
#SavePeriod	         86400
## 3 days
#SavePeriod	         259200
## (never delete)
#SavePeriod		0
# 6 Months
SavePeriod		16070400

Description		10 Second Samples
# 2 hours
PlotPeriod		7200
PlotPeriodName		2 hours
PLOT_FMT		M
</DIGESTRES>

<DIGESTRES=30>
## 1 day
#SavePeriod	         86400
## 3 days
#SavePeriod	         259200
## (never delete)
#SavePeriod		0
# 6 Months
SavePeriod		16070400

Description		30 Second Samples
# 2 hours
PlotPeriod		7200
PlotPeriodName		2 hours
PLOT_FMT		M
</DIGESTRES>

<DIGESTRES=600>
## 7 days
#SavePeriod	         604800
## (never delete)
#SavePeriod		0
# 6 Months
SavePeriod		16070400

Description		10 Minute Samples
# 24 hours
PlotPeriod		86400
PlotPeriodName	        24 hours
# a subsequence of 'mdHMS'
PLOT_FMT                 HM
</DIGESTRES>

<DIGESTRES=3600>
## 2 weeks
#SavePeriod              1209600
## (never delete)
#SavePeriod		0
# 6 Months
SavePeriod		16070400

Description             1 Hour Samples

# 2 days
PlotPeriod              172800
PlotPeriodName          2 days
PLOT_FMT                dH

</DIGESTRES>

<DIGESTRES=10800>
# 1 Month
SavePeriod	         2678400

Description		3 Hour Samples
# 7 Days
PlotPeriod		604800
PlotPeriodName	        7 days
PLOT_FMT                 dH
</DIGESTRES>

<DIGESTRES=21600>
# 6 Months
SavePeriod		16070400

Description		6 Hour Samples
# 1 Month (31 days)
PlotPeriod		2678400
PlotPeriodName	        1 month
PLOT_FMT                 dH
</DIGESTRES>

<DIGESTRES=86400>
# (never delete)
SavePeriod		0

Description		24 Hour Samples
# 1 year (365 days)
PlotPeriod		31536000
PlotPeriodName	        1 year
PLOT_FMT                 md
</DIGESTRES>
