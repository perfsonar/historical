#summary IP Summarization Algorithm in Perl

<wiki:toc max_depth="6" />


== Introduction ==

The effective and efficient summarization of the IPv4 (and eventually IPv6) address space is paramount for the Information services of perfSONAR.  The goal of the summarization is to achieve a good compression of the address space, in order to optimize the exchange of information for the LookupService (LS) and memory usage.  The current algorithm has been the mainstay since advent of the gLS, and may take liberties with the final output:

 * Summarization is not as _tight_ as possible.  For instance given several addresses that share an A class subnet (e.g. 192.168.0.56, 192.168.48.98, 192.168.48.197) a larger than required CIDR recommendation is made: 192.0.0.0/8.  
 * Multiple ranges may confuse the overall output.  If two primary ranges are seen, 192.168.0.0/16 and 10.10.0.0/16, the recommendation may be returned that is even greater, e.g. 0.0.0.0/0.

Implementations should also consider:

 * Efficiency for input size
 * Internal data structures, such as IPTrie.  
 
The following document describes the current state of the algorithm and then lays out recommendations for upgrade as well as a work plan.  Schedules are not exact.


== Goal of the Summarization ==

The goal of the summarization is to achieve a good compression of the address space, in order to optimize the exchange of information for the LookupService (LS) and memory usage.


== Current ==

The current algorithm was developed by Jason and Martin in the Spring/Summer of 2008.  This culminated in the release of the perfSONAR-PS gLS for June of 2008.  


=== Current Algorithm ===

This algorithm makes heavy use of the concept of an IPTrie data structure.  A basic description follows:

 # Read in complete list of IP addresses.  For a given hLS the pattern should be similar to:
   * Many distinct addresses in a certain range (e.g. an SNMP MA is deployed in a single domain).
   * Potentially several ranges (if the hLS is shared)
   * _Outliers_, this is seen for point to point services such as _PingER_ and _perfSONAR-BUOY_
 # Given our list of IP addresses we need to groom the data.
   * CIDR Summarization (using [http://search.cpan.org/dist/Net-CIDR/CIDR.pm Net::CIDR]).  We really want to get _*all*_ CIDR summaries for any IP Address (simply put, what _range_ is a given IP address valid in). An Example using _*128.4.133.164*_.  A complete list of CIDR descriptions follows:
{{{
       128.4.133.164/32
       128.4.133.164/31
       128.4.133.164/30
       128.4.133.160/29
       128.4.133.160/28
       128.4.133.160/27
       128.4.133.128/26
       128.4.133.128/25
       128.4.133.0/24
       128.4.132.0/23
       128.4.132.0/22
       128.4.128.0/21
       128.4.128.0/20
       128.4.128.0/19
       128.4.128.0/18
       128.4.128.0/17
       128.4.0.0/16
       128.4.0.0/15
       128.4.0.0/14
       128.0.0.0/13
       128.0.0.0/12
       128.0.0.0/11
       128.0.0.0/10
       128.0.0.0/9
       128.0.0.0/8
       128.0.0.0/7
       128.0.0.0/6
       128.0.0.0/5
       128.0.0.0/4
       128.0.0.0/3
       128.0.0.0/2
       128.0.0.0/1
       0.0.0.0/0
}}}
   * The next step involves looking at these numbers for _all_ IP addresses that we started with.  For lack of a better term I refer to this as _*voting*_.  We keep a running tally of how many of the starting addresses share the common ancestors of CIDR descriptions.  An example using _*128.4.40.17*_ and _*128.4.133.164*_.  These addresses share the following CIDR ranges, with the _tightest_ being at the top.
{{{
       128.4.0.0/16
       128.4.0.0/15
       128.4.0.0/14
       128.0.0.0/13
       128.0.0.0/12
       128.0.0.0/11
       128.0.0.0/10
       128.0.0.0/9
       128.0.0.0/8
       128.0.0.0/7
       128.0.0.0/6
       128.0.0.0/5
       128.0.0.0/4
       128.0.0.0/3
       128.0.0.0/2
       128.0.0.0/1
       0.0.0.0/0
}}}
 # Next we need to make the IPTrie (e.g. Patricia Trie - we use the [http://search.cpan.org/~cvicente/Net-IPTrie-v0.4/lib/Net/IPTrie.pm Net::IPTrie] module).  Making the Trie consists of:
   # Insert all of the original addresses into the Trie with a /32 prefix.  This does not need to be done in order.
   # Insert all of the _voted_ and shared CIDR ranges _*in order, from most to least*_.  The ordering matters here for Trie construction.
 # After we have our Trie we have the option of _pruning_ it to remove dead ends
 # Finally we do a walk of the Trie to print out (for Graphical Purposes) and to establish:
   # _*Maximum Dominator*_ - Find the _tightest_ CIDR range for all inputs
   # _*K Dominators*_ - Walk _down the tree_, towards the leaves, and find the _K_ dominators that still describe all leaves in the _tightest_ possible manner.
 

=== Example ===

Consider this input set of data, representative of some service:

{{{
    128.175.13.92
    128.175.13.74
    128.4.40.10
    128.4.40.12
    128.4.40.17
    128.4.131.23
    128.4.133.167
    128.4.133.163
    128.4.133.164
}}}

When all is said and done, we are left with the following Trie (when using the above algorithm:

http://perfsonar-ps.googlecode.com/svn/wiki/IPSummarization/graph.png

The top CIDR, _*128.0.0.0/8*_, dominates all leaves and is as _tight_ as possible.   To select the _K_ dominators we can craft an arbitrary rule to _slice_ off portions of the tree that directly touch a leaf:

http://perfsonar-ps.googlecode.com/svn/wiki/IPSummarization/graph2.png

This allows us to choose 3 dominators:
{{{
    128.175.13.64/27
    128.4.128.0/21
    128.4.40.0/27
}}}


=== Current Implementation ===

The following is a short script that implements the above algorithm.  It is written in perl and currently present in all production gLS instances.  Comments are inserted where obvious changes to the algorithm were made.  Important deviations:

 # The IPTrie object is not sound.  Modifications to the Trie are required after construction to properly link the pointers of children and parents.  For this reason we may wish to implement our own IPTrie.  It remains because it does offer some useful functions (e.g. printing out the Trie)
 # Voting is rather simple.  We simply rank by shared parent
 # Graphviz notation provided to make pretty pictures.

{{{
#!/usr/bin/perl -w

use strict;
use warnings;

=head1 NAME

ipTree.pl - Utility to demonstrate the effectivness of CIDR summarizations of
IP addresses as well as a potential solution to finding dominating values
when used in a Radix Tree (Patricia Trie) data structure.

=head1 USAGE

  perl ipTree.pl

An outputed list of the minimum dominators of the resulting IPTrie will be
be displayed.  This will generate a graphviz .dot file (graph.dot) of the
IPTrie that can then be used with the graphviz executable:

  dot graph.dot -Tpng -o graph.png

=head1 DESCRIPTION

The perfSONAR dLS and gLS require a way to summarize large amounts of
topological data (namely IP addresses of type IPv4 and IPv6).  Using the
well known CIDR way of specificying IP address ranges, this simple script aims
to combine the 'dominating' (i.e. greatest available CIDR summaries) for some
set of source IP addresses.

The output is placed into a graphviz dot file for display.

=cut

use Net::CIDR ':all';
use Net::IPTrie;
use Data::Dumper;

# IP Trie Data Structure (similar to Net::Patricia)
my $tr = Net::IPTrie->new( version => 4 );

# I need to be able to do my own manipulations (e.g. IPTrie is not really
# that great...)
my %tree = ();

# Ensure that each child only has one parent (IPTrie data structure
# uses a strange internal representation).
my %claim = ();

# starting list of IPs

my @map = ( "128.175.13.92", "128.175.13.74", "128.4.40.10", "128.4.40.12", "128.4.40.17", "128.4.131.23", "128.4.133.167", "128.4.133.163", "128.4.133.164" );

#my @map = ("150.254.160.194",
#           "150.254.160.195",
#           "150.254.160.196",
#           "120.10.0.11",
#           "120.10.0.12",
#           "120.10.0.17",
#           "120.11.5.1",
#           "120.11.5.2",
#           "80.15.11.2",
#           "80.15.11.3");

#my @map = ("64.57.25.15",
#           "64.57.27.4",
#           "64.57.27.138",
#           "128.4.12.12",
#           "128.4.13.1",
#           "160.135.1.1",
#           "207.75.165.151",
#           "207.72.226.18",
#           "206.72.224.1");

my $vote = getCDIRSummaries( \@map );
$tr = makePatriciaTrie( \@map, $vote, $tr );
manipulatePatriciaTrie( \@map, $tr );
genGraph( \%tree );
listMinDoms();

exit( 1 );

=head2 getCDIRSummaries($map)

Given a list of IP addresses, gather the CIDR representations then 
group this by a popularity ranking (i.e. if there are 9 hosts, and 9
have a set grouping of CIDR values in common, this is a dominator).

=cut

sub getCDIRSummaries {
    my ( $map ) = @_;

    my %tally = ();
    foreach my $host ( @{$map} ) {
        my @list = Net::CIDR::addr2cidr( $host );
        foreach my $range ( @list ) {

            # we want to ingore the wildcard addresses...
            next if $range =~ m/^0\./;

            $tally{$range}++ if defined $tally{$range};
            $tally{$range} = 1 if not defined $tally{$range};
        }
    }

    return \%tally;
}

=head2 makePatriciaTrie($map, $votes, $tr)

Creates the initial IPTrie structure using the list of 
available hosts (e.g. $map) and the CIDR values for
each (ranked into popularity groups).  The end result is
the IPTrie.

=cut

sub makePatriciaTrie {
    my ( $map, $tally, $tr ) = @_;

    # Start to make the IPTrie data structure.  First we add in all
    # of the 'base' addresses

    foreach my $host ( @{$map} ) {
        $tr->add( address => $host, prefix => "32" );
    }

    # Now we add in the summaries.

    foreach my $t ( sort keys %{$tally} ) {
        my @parts = split( /\//, $t );
        $tr->add( address => $parts[0], prefix => $parts[1] );
    }

    return $tr;
}

=head2 extract($parent, $node, $status, $side)

This aux function recursively walks the nodes of the IPTrie structure
and creates a more usefriendly tree that we will use for manipulation
and final display.

=cut

sub extract {
    my ( $parent, $node, $status, $side ) = @_;
    my $me = "";
    $me = $node->[3] . "/" . $node->[5] if defined $node->[3] and defined $node->[5];
    if ( $me and $side and ( not $claim{$me} ) ) {
        push @{ $tree{$parent}{"C"} }, $me;
        $claim{$me} = 1;
    }
    $status = extract( $parent, $node->[1], $status, "L" ) if $node->[1] and ( not $status->{"L"} );
    $status = extract( $parent, $node->[2], $status, "R" ) if $node->[2] and ( not $status->{"R"} );
    return $status;
}

=head2 manipulatePatriciaTrie($tr)

Given the IPTrie structure, we need to manually manipulate the nodes into
our own format.

=cut

sub manipulatePatriciaTrie {
    my ( $map, $tr ) = @_;

    my $list  = ();
    my $code  = sub { push @$list, shift @_; };
    my $count = $tr->traverse( code => $code );

    # hacky root pointer (gives us unification if the whild card [0.*]
    # was really needed)

    my @temp = ();
    $tree{"Root"}{"C"} = \@temp;
    $tree{"Root"}{"U"} = "NULL";

    # we need to go backwards when looking at the IPTrie print out, this is
    # is really to be sure children aren't all claimed by the root (the internal
    # structure is a little strange) so this ensures we hit the root last.

    foreach my $node ( reverse @{$list} ) {
        my $me = "";
        $me = $node->[3] . "/" . $node->[5] if defined $node->[3] and defined $node->[5];
        next unless $me;

        # each one of our node-keys has some location information
        my @temp = ();
        $tree{$me}{"C"} = \@temp;
        $tree{$me}{"U"} = "";

        # recursively search the tree, stop after you find a left and right
        # child though (N.B. this creates problems unfortunately, so we need
        # to manually manipulate...)
        my %status = (
            "L" => 0,
            "R" => 0
        );
        extract( $me, $node, \%status, "" );
    }

    # link all the parent information for each node and child

    foreach my $item ( keys %tree ) {
        foreach my $c ( @{ $tree{$item}{"C"} } ) {
            $tree{$c}{"U"} = $item if $c and $item;
        }
    }

    # First step: Start at the leaves and walk toward the root.
    # - Every time we see a node with a sinle child, collapse it into the parent
    #   (we are pruning the tree)

    foreach my $host ( @{$map} ) {
        my $current = $host . "/32";
        while ( $current ) {
            my $delete = "";
            if (    $#{ $tree{ $tree{$current}{"U"} }{"C"} } == 0
                and not( $current =~ m/\/32$/ )
                and $#{ $tree{$current}{"C"} } == 0 )
            {
                $delete = $current;
                foreach my $child ( @{ $tree{$current}{"C"} } ) {
                    $tree{$child}{"U"} = $tree{$current}{"U"};
                }
                $tree{ $tree{$current}{"U"} }{"C"} = $tree{$current}{"C"};
                delete $tree{$delete}{"C"};
            }
            $current = $tree{$current}{"U"};
            delete $tree{$delete} if $delete;
        }
    }

    # Second step: Start at the leaves and walk toward the root.
    # - Every time we see a single child node, collapse it into the child (this
    #   is the opposite of what we just did, but this handles branching much
    #   better, this is also a form of pruning).

    foreach my $host ( @{$map} ) {
        my $current = $host . "/32";
        while ( $current ) {
            my $delete = "";
            if ( $#{ $tree{$current}{"C"} } == 0 ) {
                $delete = $current;
                foreach my $child ( @{ $tree{$delete}{"C"} } ) {
                    $tree{$child}{"U"} = $tree{$delete}{"U"};
                    push @{ $tree{ $tree{$delete}{"U"} }{"C"} }, $child;
                }

                my $counter = 0;
                foreach my $child ( @{ $tree{ $tree{$delete}{"U"} }{"C"} } ) {
                    if ( $child eq $current ) {
                        my $remove = splice( @{ $tree{ $tree{$delete}{"U"} }{"C"} }, $counter, 1 );
                    }
                    $counter++;
                }
            }
            $current = $tree{$current}{"U"};
            delete $tree{$delete} if $delete;
        }
    }

    # finally link the tree(s) to the root pointer

    foreach my $node ( keys %tree ) {
        unless ( $tree{$node}{"U"} ) {
            $tree{$node}{"U"} = "Root";
            push @{ $tree{"Root"}{"C"} }, $node;
        }
    }

    return;
}

=head2 genGraph

Outputs the contents of the tree structure into a "Graphviz" formated
DAG file.  

=cut

sub genGraph {

    open( DOT, ">graph.dot" );
    print DOT "digraph g {\n";

    foreach my $item ( keys %tree ) {
        next unless $item;
        if ( $item =~ m/\/\d+$/ ) {
            my @array = ();
            @array = split( /\//, $item );

            # color the terminal elements so we know they are not dominators
            if ( $array[1] eq "32" ) {
                print DOT "\t\"", $item, "\"[ color=crimson, style=filled ];\n";
            }
            else {
                print DOT "\t\"", $item, "\";\n";
            }
        }
        else {

            # this is the root...

            print DOT "\t\"", $item, "\"[ color=yellow, style=filled ];\n";
        }
    }

    # output the linkings

    foreach my $item ( keys %tree ) {
        next unless $item;
        foreach my $c ( @{ $tree{$item}{"C"} } ) {
            next unless $c;
            print DOT "\t\"", $item, "\" -> \"", $c, "\";\n";
        }
    }

    print DOT "}\n";
    close( DOT );
    return;
}

=head2 listMinDoms

Given the tree, 'slice off' the top level of nodes that are
not necessarily representative of the domination (e.g. if they
are just used to direct traffic through the tree, and do not
have direct /32 children).  We return a list of nodes that
represent the minimum set of addresses that can be used to
describe any of the originals.

=cut

sub listMinDoms {

    # First locate the root in the tree

    my @expand = ();
    foreach my $node ( sort keys %tree ) {
        if ( $node and $tree{$node}{"U"} eq "Root" ) {

            # add the root the 'expand' list so we can
            # examine it (and it's children, etc.) then
            # exit
            push @expand, $node;
        }
    }

    my $counter = 0;
    my @minDoms = ();

    # now we are going to walk the tree.  If a non-leaf
    # node has two non-leaf children is is useless to us,
    # so we skip it.  If a non-leaf node has at least one
    # leaf child, this is a part of our 'boundary' so
    # we list it as a minDominator.

    while ( $expand[$counter] ) {
        my $minDomFlag = 0;
        my $expandFlag = 0;

        foreach my $child ( sort @{ $tree{ $expand[$counter] }{"C"} } ) {
            my @array = split( /\//, $child );

            # /32's are leaf nodes, if one of our children is a leaf
            # we are a on the min dominator boundary
            if ( $array[1] eq "32" ) {

                # Make sure we only add the node once...
                if ( ( $#minDoms == -1 ) or ( $minDoms[$#minDoms] ne $expand[$counter] ) ) {
                    push @minDoms, $expand[$counter];
                }
                $minDomFlag++;
            }
            else {

                # If we have a non leaf node as a child, we will probably
                # need to expland that child later...

                push @expand, $child;
                $expandFlag++;
            }
        }

        # corner case: if we have a non leaf child and a leaf
        # child we need to remove the non leaf child from the
        # expand list

        pop @expand if $expandFlag and $minDomFlag;
        $counter++;
    }

    print "Min Dominators:\n\n";
    foreach my $f ( @minDoms ) {
        print $f , "\n";
    }

    return;
}

__END__

=head1 SEE ALSO

L<Net::CIDR>, L<Net::IPTrie>

To join the 'perfSONAR-PS' mailing list, please visit:

  https://mail.internet2.edu/wws/info/perfsonar-developer

The perfSONAR-PS subversion repository is located at:

  https://svn.internet2.edu/svn/perfSONAR-PS

Questions and comments can be directed to the author, or the mailing list.
Bugs, feature requests, and improvements can be directed here:

  https://bugs.internet2.edu/jira/browse/PSPS

=head1 VERSION

$Id$

=head1 AUTHOR

Jason Zurawski, zurawski@internet2.edu

=head1 LICENSE

You should have received a copy of the Internet2 Intellectual Property Framework
along with this software.  If not, see
<http://www.internet2.edu/membership/ip.html>

=head1 COPYRIGHT

Copyright (c) 2008-2009, Internet2

All rights reserved.

=cut
}}}


=== Criticisms (From the Author and Others) ===

 # _K_ dominator selection is arbitrary
   * Yes, my initial decision was based on _*this looks correct*_ instead of some heuristic.
   * It would be nice to define such a heuristic
   * Need to consider the _weight_ of leaves under a given CIDR node, this can effect if we choose it
 # Trie construction only considers _shared_ CIDR ranges
   * I think this is mostly correct, but we may want to consider the _weight_ (see above) and how it effects other nodes in the tree.
 # Pruning the trie is not _destructive_
   * Implement something that allows pruning to remove some ranges and replace it with other, possibly tighter and unrelated ranges.


== Proposal ==

The proposed changes should address the overall algorithm (evaluate for correctness and completeness - compete with other attempts).  Once an suitable algorithm is found in experimentation and verified in testing, the final result will be installed into gLS and tested in a distributed environment (e.g. [https://www.planet-lab.org/ PlanetLab]).  

This work should be done primarily by the student, with help from:

 * Jason - Current Algorithm/Perl/gLS
 * Martin - Current Algorithm/Research Aspects
 * Brian T - Testing
 * Jeff - Current Algorithm/Resources
 * Aaron - Topology Considerations


=== IS WG Thoughts ===

Originally proposed by Brian:

{{{
As this solution is so completely IPV4 specific, I'm wondering if this is the
right path to continue down.

What about using AS numbers instead?

That would work for both V4 and V6 addresses. Clearly there would be a lot of
other issues to work out, such as how to handle multiple hLS's within a AS
domain, but maybe this is worth more thought? 
}}}

This is worth pursuing by the student after the work on the initial algorithm.


=== Proposed Implementation ===

Must be in Perl.  We will not be supporting the Java implementation directly.  The subsequent perl version can be translated by external programmers.


=== Proposed Data Sets ===

The following data sets were gathered from perfSONAR services in March 2009.


==== APAN ====

{{{
203.181.248.150
202.180.34.158
203.181.248.225
203.181.102.130
45.0.0.1
203.178.133.141
203.181.248.242
203.181.249.19
172.24.100.210
203.181.248.154
203.181.249.118
192.203.116.146
203.181.249.25
203.181.248.66
203.181.194.158
203.181.249.100
203.181.194.246
203.181.248.47
203.181.249.117
203.181.248.117
203.181.248.251
203.181.248.110
203.181.248.109
203.181.248.228
203.181.248.185
203.181.249.17
202.178.96.85
133.69.37.1
203.181.248.133
203.181.195.62
203.181.249.11
203.181.194.82
203.181.249.82
203.181.248.102
203.181.194.125
203.181.249.97
203.181.248.62
203.181.249.94
203.181.248.168
203.181.248.101
203.181.249.237
203.181.195.161
203.181.248.115
203.181.248.166
203.181.249.78
203.181.248.170
202.180.34.134
203.181.194.126
203.181.248.238
202.40.161.239
117.103.111.133
203.181.249.90
203.181.248.204
203.181.248.49
203.181.248.250
203.181.248.182
203.181.248.190
203.181.248.209
203.181.249.24
203.181.249.73
202.249.2.160
203.181.194.89
203.181.248.134
203.181.248.81
203.181.249.158
203.181.249.193
203.181.248.69
203.181.248.162
203.181.249.218
203.181.249.129
203.181.195.30
203.181.248.229
203.181.249.238
203.181.248.243
203.181.249.86
203.181.249.137
203.181.249.253
203.181.249.101
203.181.249.105
203.181.249.70
192.203.116.150
163.220.127.238
203.181.248.158
203.181.249.213
10.0.0.4
203.181.248.178
203.181.248.142
203.181.249.177
172.24.61.30
203.181.248.138
203.181.195.193
203.181.249.122
140.221.251.2
203.181.248.147
203.181.194.225
203.181.249.102
192.203.116.154
203.181.248.218
203.181.248.144
203.181.194.254
203.181.249.126
202.179.241.37
203.181.194.198
203.181.248.97
}}}


==== ESnet ====

{{{
198.129.248.121
134.55.217.89
134.55.219.9
134.55.209.41
134.55.218.5
134.55.213.205
134.55.213.74
198.124.194.9
134.55.42.10
134.55.208.126
198.124.216.157
134.55.217.82
134.55.42.18
198.124.238.1
134.55.217.6
134.55.200.74
192.168.201.5
192.107.175.3
134.55.222.62
134.55.221.42
134.55.218.70
134.55.217.113
134.55.8.130
134.55.200.65
134.55.8.162
134.55.209.174
134.55.200.37
198.129.78.113
198.129.248.133
192.245.178.6
134.55.221.33
134.55.209.98
192.84.8.50
134.55.209.218
134.55.218.89
134.55.209.173
134.55.217.81
134.55.219.18
134.55.217.1
134.55.213.210
134.55.220.50
134.55.11.225
198.125.140.97
134.55.213.93
134.55.220.53
134.55.213.85
134.55.200.66
192.33.240.193
134.55.217.17
134.55.219.33
134.55.210.217
134.55.219.86
134.55.218.21
62.40.125.78
134.55.200.15
134.55.218.10
134.55.43.2
134.55.213.217
198.124.216.133
134.55.213.245
134.55.219.38
134.55.218.110
134.55.207.21
198.129.77.5
134.55.217.38
134.55.209.38
134.55.211.14
134.55.222.45
198.129.254.5
134.55.209.85
198.124.194.5
134.55.211.97
198.124.216.137
134.55.209.42
134.55.212.51
134.55.220.25
134.55.209.73
198.124.252.125
134.55.218.42
134.55.213.233
134.55.209.21
198.124.252.102
192.31.96.2
198.129.248.105
134.55.219.10
198.124.216.197
134.55.217.110
134.55.221.13
150.99.198.218
134.55.222.17
134.55.200.79
172.16.32.2
137.164.27.93
134.55.217.5
134.55.213.121
192.5.170.78
134.55.213.221
134.55.207.22
134.55.219.21
134.55.218.98
192.13.56.41
198.124.208.65
134.55.200.38
198.124.224.5
134.55.200.28
134.55.217.57
207.231.241.13
198.124.17.9
134.55.209.65
134.55.200.25
134.55.16.193
211.79.48.173
134.55.200.1
62.40.125.74
198.129.252.142
134.55.219.49
198.125.140.177
134.55.219.85
198.129.76.25
198.125.140.113
134.55.12.100
198.124.252.25
134.55.210.39
134.55.217.21
134.55.212.105
134.55.10.97
134.55.221.14
18.201.0.118
134.55.221.29
198.124.238.33
134.55.219.66
134.55.222.54
207.231.248.130
134.55.217.97
134.55.213.49
134.55.208.205
198.129.77.17
134.55.220.1
134.55.217.106
134.55.200.46
134.55.210.25
198.124.216.149
134.55.200.68
134.55.217.2
134.55.210.222
198.49.208.17
198.129.33.22
134.55.211.1
134.55.200.61
128.115.190.1
198.129.79.17
134.55.6.137
134.55.218.109
134.55.207.14
198.125.140.201
198.124.134.1
198.124.238.13
192.168.201.9
134.55.200.40
134.55.213.81
134.55.209.22
134.55.210.241
134.55.34.97
134.55.207.34
134.55.211.81
198.125.140.13
192.150.29.210
134.55.219.26
134.55.219.77
117.103.111.157
134.55.218.61
207.231.249.2
134.55.212.97
134.55.209.93
134.55.212.33
134.55.213.90
198.125.140.169
207.231.247.2
198.124.216.185
134.55.217.33
134.55.200.72
134.55.221.17
134.55.209.33
134.55.217.101
198.125.140.89
198.124.254.222
198.32.153.13
192.68.191.146
134.55.218.29
134.55.216.1
134.55.218.82
134.55.29.97
207.231.248.13
134.55.38.1
134.55.215.1
134.55.218.93
134.55.211.23
134.55.218.97
198.124.232.254
198.129.76.81
134.55.211.132
134.55.207.13
134.55.217.26
134.55.200.26
198.125.140.205
134.55.218.13
134.55.213.113
199.109.4.150
134.55.211.156
134.55.213.177
134.55.19.133
134.55.220.41
134.55.219.53
134.55.213.226
134.55.219.58
134.55.212.81
134.55.200.48
134.55.200.36
134.55.18.165
134.55.207.37
134.55.200.17
134.55.10.225
134.55.21.129
198.124.216.193
134.55.213.214
134.55.209.46
198.129.33.21
134.55.33.161
134.55.218.38
134.55.200.67
198.125.140.93
134.55.12.225
134.55.213.170
198.124.200.254
134.55.213.66
192.31.99.138
134.55.213.145
134.55.213.161
198.124.252.89
198.124.16.1
134.55.218.81
134.55.16.97
134.55.219.13
134.55.221.6
134.55.213.77
134.55.217.18
134.55.209.242
134.55.222.66
134.55.221.38
134.55.217.46
134.55.200.62
207.231.246.2
192.65.95.2
134.55.213.178
134.55.200.34
134.55.38.2
134.55.217.34
134.55.18.101
134.55.42.17
134.55.20.229
134.55.22.193
198.124.228.6
134.55.213.225
134.55.211.161
134.55.217.50
134.55.209.94
134.55.13.2
134.55.217.10
134.55.210.225
134.55.200.71
134.55.218.94
198.125.140.173
192.12.208.1
134.55.219.90
198.124.252.138
134.55.213.193
134.55.219.93
198.128.15.101
134.55.211.163
134.55.214.26
134.55.212.1
134.55.217.109
198.124.192.98
207.231.245.130
207.231.242.13
134.55.213.78
198.124.252.118
198.129.254.21
198.129.254.1
192.73.7.193
198.125.140.226
198.206.221.254
134.55.209.53
134.55.211.17
134.55.11.226
198.124.238.17
134.55.200.77
134.55.209.106
134.55.219.78
134.55.218.62
134.55.218.57
134.55.213.106
134.55.213.213
134.55.209.222
134.55.209.37
134.55.219.37
134.55.200.49
134.55.218.37
198.124.216.125
134.55.200.69
134.55.20.195
134.55.213.89
134.55.200.24
134.55.220.21
198.129.254.9
134.55.211.113
134.55.200.7
198.129.33.36
134.55.213.109
134.55.213.169
134.55.221.18
134.55.200.20
134.55.219.113
134.55.220.26
134.55.218.85
134.55.23.33
134.55.220.2
134.55.218.46
134.55.42.9
134.55.217.42
134.55.219.81
134.55.219.14
134.55.221.37
147.155.254.1
134.55.211.65
128.115.190.101
134.55.219.110
198.129.33.5
134.55.13.12
134.167.160.49
134.55.210.26
207.231.240.13
134.55.213.50
134.55.217.90
150.99.199.62
134.55.222.41
198.124.238.5
134.55.29.33
134.55.212.25
192.13.56.93
134.55.210.129
134.55.200.60
134.55.209.217
134.55.214.18
134.55.213.122
134.55.218.69
198.124.17.17
134.55.218.78
134.55.209.221
134.55.214.9
198.129.76.65
134.55.213.237
134.55.209.81
134.55.213.249
198.129.78.33
134.55.213.97
198.124.216.89
134.55.207.33
134.55.221.1
134.55.213.149
134.55.213.114
134.55.219.65
134.55.217.114
134.55.212.41
198.124.216.145
134.55.217.58
134.55.219.109
134.55.213.165
134.55.212.89
134.55.219.82
198.124.130.1
198.206.220.1
134.55.12.133
134.55.211.145
198.124.216.181
198.125.140.181
134.55.222.38
134.55.207.18
134.55.222.37
198.129.248.86
134.55.209.30
134.55.209.202
198.124.252.110
198.49.208.229
134.55.210.117
134.55.218.26
134.55.209.61
134.55.217.102
134.55.209.54
192.68.191.162
134.55.209.62
134.55.212.73
134.55.218.126
134.55.220.10
134.55.210.193
134.55.209.105
134.55.216.2
134.55.211.129
198.129.252.46
198.129.254.13
134.55.220.42
134.55.222.42
134.55.207.10
198.151.133.185
134.55.217.13
134.55.212.99
134.55.7.82
198.129.33.25
134.55.218.45
198.124.254.233
198.124.226.1
62.40.125.94
134.55.213.209
198.124.216.153
198.124.252.122
134.55.200.32
134.55.209.45
134.55.212.65
134.55.211.19
134.55.200.42
134.55.213.137
134.55.213.82
134.55.218.41
134.55.207.38
134.55.218.18
192.150.31.78
198.124.238.21
134.55.210.181
134.55.219.89
134.55.214.17
134.55.213.69
134.55.218.25
134.55.217.25
134.55.213.125
134.55.220.78
198.129.226.65
134.55.209.101
134.55.21.130
134.55.12.230
134.55.218.77
134.55.219.34
198.125.140.137
198.9.202.13
134.55.208.37
134.55.210.81
198.129.33.13
198.129.77.13
134.55.12.99
134.55.29.34
134.55.218.101
134.55.222.65
134.55.217.37
134.55.209.158
134.55.219.57
134.55.43.1
198.124.216.209
134.55.216.137
198.129.66.234
134.55.7.81
134.55.219.73
134.55.213.65
198.129.48.5
134.55.218.17
134.55.210.28
134.55.218.66
134.55.209.249
134.55.217.61
134.55.217.9
134.55.30.129
134.55.213.230
134.55.209.241
134.55.210.85
134.55.17.65
198.125.140.189
134.55.208.206
134.55.217.78
134.55.15.133
134.55.12.129
134.55.216.129
198.129.224.2
134.55.200.80
134.55.217.41
134.55.221.25
134.55.210.178
198.125.140.229
134.55.209.97
134.55.213.141
134.55.200.45
198.125.140.141
134.55.213.101
134.55.200.5
198.125.140.222
134.55.217.49
134.55.200.31
207.231.244.2
198.151.133.253
134.55.215.33
198.128.4.5
134.55.207.17
134.55.219.50
134.55.219.22
134.55.7.70
134.55.213.73
134.55.217.105
10.0.0.4
198.124.216.177
134.55.10.70
134.55.213.173
134.55.222.25
134.55.200.85
134.55.213.174
134.55.200.4
138.18.155.22
134.55.215.49
134.55.209.29
134.55.208.241
198.124.252.142
134.55.23.194
134.55.217.30
134.55.15.197
134.55.220.9
198.129.78.82
62.40.124.230
134.55.217.77
134.55.23.197
192.13.56.89
134.55.8.225
134.55.221.2
134.55.222.61
134.55.210.115
134.55.213.229
198.124.230.129
134.55.218.58
134.55.200.84
134.55.217.45
134.55.218.90
134.55.221.41
134.55.200.73
192.203.230.13
134.55.218.102
198.129.44.28
10.31.20.2
134.55.210.122
198.124.252.6
198.129.224.65
134.55.218.65
134.55.217.22
134.55.218.86
198.125.140.217
198.124.216.173
204.134.149.2
198.124.252.98
134.55.212.57
198.125.140.209
134.55.200.29
198.49.208.14
134.55.217.29
134.55.200.87
134.55.218.14
134.55.11.7
134.55.200.14
10.10.10.1
198.129.252.37
134.55.219.74
192.188.106.140
198.129.78.45
198.129.33.26
198.129.248.37
198.124.252.106
134.55.219.25
198.124.216.169
134.55.200.16
134.55.213.150
134.55.222.53
134.55.210.89
134.55.207.9
134.55.212.113
198.129.248.117
134.55.218.6
134.55.220.22
134.55.8.129
192.168.201.52
207.231.243.13
134.55.208.242
134.55.221.5
134.55.213.162
134.55.209.102
134.55.219.54
134.55.213.218
198.124.238.9
198.129.77.9
192.13.56.45
134.55.218.30
207.231.245.13
134.55.8.161
172.16.32.1
134.55.209.77
134.55.209.82
134.55.221.34
134.55.217.14
134.55.209.157
134.55.208.125
134.55.20.193
134.55.209.66
134.55.213.238
134.55.219.114
134.55.218.9
134.55.220.54
}}}


==== FCCN ====

{{{
193.136.5.3
193.137.1.161
193.136.1.189
193.136.249.142
193.136.252.3
193.137.0.42
193.137.1.245
194.210.30.1
193.137.0.145
193.136.1.38
193.137.0.43
193.137.0.4
193.136.1.41
193.136.5.4
193.137.1.213
193.136.249.110
193.136.249.78
193.136.5.9
193.136.5.2
194.210.63.253
193.136.4.161
193.136.249.46
193.136.1.177
193.136.255.254
193.136.249.14
193.137.1.169
193.137.59.113
193.137.0.18
193.137.4.17
193.137.0.153
193.137.0.11
193.136.252.2
193.136.1.37
193.137.0.30
193.136.4.26
193.137.0.2
193.136.1.222
193.136.255.252
193.136.249.174
193.136.1.221
62.40.124.186
193.136.5.1
193.136.5.6
}}}


==== GARR ====

{{{
193.206.134.238
193.206.141.98
193.206.134.190
193.206.136.126
193.206.134.65
193.206.134.218
193.206.143.125
193.206.134.13
193.206.134.210
193.206.141.109
193.206.141.49
193.206.131.221
193.206.134.182
193.206.134.142
193.206.141.62
193.206.134.69
193.206.141.34
193.206.131.249
193.206.141.14
193.206.131.250
193.206.141.6
193.206.134.246
193.206.143.254
193.206.136.125
193.206.134.26
193.206.140.253
193.206.143.252
193.206.141.53
193.206.134.106
193.206.141.22
193.206.134.34
193.206.134.21
193.206.134.114
193.206.131.222
193.206.141.10
193.206.134.121
193.206.136.61
193.206.134.214
193.206.137.254
193.206.134.74
193.206.141.33
193.206.141.102
193.206.141.101
193.206.134.194
193.206.134.118
193.206.140.254
193.206.134.66
193.206.134.193
193.206.134.33
193.206.134.41
193.206.141.5
193.206.143.126
193.206.128.252
193.206.141.9
193.206.141.61
193.206.134.53
193.206.141.89
193.206.134.62
193.206.134.101
193.206.134.89
193.206.134.22
193.206.134.54
193.206.134.213
193.206.141.105
193.206.142.254
193.206.140.190
193.206.141.25
193.206.132.188
193.206.134.105
193.206.134.78
193.206.141.17
193.206.134.198
193.206.143.188
193.206.142.190
193.206.134.61
193.206.134.234
193.206.134.14
193.206.134.6
193.206.137.62
193.206.129.2
193.206.143.122
193.206.134.10
193.206.134.233
193.206.134.25
193.206.134.181
193.206.134.137
193.206.141.90
193.206.134.5
193.206.141.57
193.206.134.209
10.1.2.3
193.206.134.217
193.206.141.65
193.206.141.18
193.206.132.252
193.206.141.21
193.206.134.38
193.206.143.190
193.206.134.90
193.206.141.110
193.206.134.250
193.206.134.253
193.206.131.252
193.206.134.113
193.206.134.141
193.206.134.230
193.206.132.61
193.206.136.253
193.206.134.9
193.206.134.97
193.206.134.98
193.206.134.45
193.206.137.126
193.206.141.30
193.206.140.126
193.206.130.252
193.206.134.237
193.206.134.229
193.206.134.122
193.206.134.222
193.206.143.253
193.206.134.249
193.206.141.29
193.206.134.154
193.206.134.225
193.206.129.3
193.206.134.221
193.206.134.42
193.206.134.205
193.206.134.73
193.206.134.158
193.206.129.4
193.206.134.245
193.206.134.46
193.206.141.26
193.206.141.54
193.206.137.61
193.206.134.153
193.206.134.226
193.206.134.117
193.206.134.206
193.206.134.77
193.206.143.121
193.206.134.254
193.206.136.189
193.206.136.190
193.206.141.106
193.206.141.13
193.206.141.50
193.206.134.109
193.206.134.157
193.206.141.66
193.206.141.97
193.206.134.197
193.206.134.37
193.206.132.125
193.206.134.138
193.206.134.70
193.206.134.110
193.206.134.189
193.206.137.190
193.206.134.102
193.206.141.58
}}}


==== Geant2 ====

{{{
62.40.114.49
150.99.188.202
62.40.125.17
62.40.112.37
62.40.114.56
62.40.124.177
62.40.114.18
62.40.112.25
62.40.125.77
216.24.184.86
62.40.114.48
62.40.112.42
62.40.114.20
62.40.114.8
62.40.112.46
62.40.124.229
62.40.124.253
62.40.124.221
62.40.114.3
62.40.114.42
62.40.112.41
62.40.114.13
128.0.0.6
198.32.11.51
62.40.114.36
62.40.114.53
62.40.124.97
62.40.112.70
62.40.114.5
62.40.124.249
}}}


==== Internet2 ====

{{{
64.57.28.56
211.79.48.158
198.32.11.21
192.122.183.10
208.100.127.33
198.125.140.230
64.57.18.33
205.213.119.14
10.254.254.4
138.18.155.34
64.57.17.129
64.57.28.244
64.57.29.61
64.57.16.193
207.231.240.131
192.122.183.46
64.57.29.13
198.32.11.105
64.57.18.209
192.35.86.226
64.57.28.248
216.249.136.198
64.57.23.81
192.91.246.125
64.57.28.24
198.32.11.97
64.208.110.190
192.88.192.138
198.49.182.7
205.189.32.117
64.57.28.161
192.122.183.30
64.57.18.97
137.164.26.133
64.208.110.26
131.247.47.213
64.57.17.209
64.57.18.81
64.57.29.45
74.125.48.106
64.57.29.17
206.196.177.106
62.40.125.18
149.165.254.3
199.18.156.242
192.88.115.117
64.57.18.249
199.18.156.246
192.35.86.230
64.57.28.45
80.231.134.30
64.57.28.11
64.57.18.17
207.231.242.131
207.210.142.2
64.57.16.213
198.32.10.190
205.189.32.97
207.231.242.8
64.57.23.97
164.113.238.193
205.189.32.93
64.57.17.213
64.57.29.25
192.150.29.6
64.57.28.241
64.57.23.73
64.57.18.113
198.49.182.5
64.57.18.241
208.77.76.130
198.32.11.65
144.92.233.117
198.86.17.66
64.57.29.57
198.32.11.80
216.27.100.54
64.57.28.129
64.57.28.243
192.84.8.254
192.31.99.134
208.100.127.37
137.227.2.182
198.32.173.194
149.165.254.7
64.57.17.85
64.57.28.4
64.57.23.105
131.247.47.225
64.57.18.201
64.57.28.7
64.57.16.97
198.32.11.41
64.57.27.254
64.57.18.225
198.124.194.10
207.231.246.131
64.57.28.15
192.5.89.222
203.181.248.141
205.213.118.10
64.208.110.198
198.9.202.205
192.41.213.113
64.57.29.69
64.57.28.43
64.57.28.25
64.215.195.42
64.57.16.225
64.57.23.1
207.231.243.131
205.213.119.10
64.57.24.254
140.173.1.238
64.57.16.129
128.135.247.125
64.57.17.81
64.57.18.1
205.213.119.30
64.57.28.12
64.57.28.39
64.57.28.33
206.220.240.86
74.125.48.226
204.238.76.6
198.32.11.69
198.32.11.50
64.57.28.44
64.57.28.5
198.32.177.189
64.57.23.89
64.57.23.113
64.57.28.53
64.57.28.40
204.238.76.2
64.57.29.22
64.57.19.21
198.32.153.205
64.57.16.1
64.57.29.20
64.57.17.65
64.57.17.193
64.57.29.5
64.57.16.89
200.0.207.10
198.32.180.67
117.103.111.153
200.23.60.122
64.57.28.26
64.57.28.16
64.57.17.33
149.165.254.23
207.231.241.8
64.57.28.18
216.27.100.62
207.231.240.8
64.57.16.21
69.31.111.90
198.32.165.194
64.57.23.65
64.57.29.65
206.223.119.120
198.32.11.45
164.113.238.142
64.57.28.247
134.75.108.46
209.131.107.142
64.57.28.37
64.57.28.47
143.215.193.10
64.57.25.254
64.57.18.233
198.109.37.22
64.57.16.65
192.35.86.174
207.231.241.131
64.57.18.65
72.36.127.138
198.32.8.83
64.57.28.38
64.57.29.37
198.124.216.158
149.165.254.21
199.109.4.154
64.57.23.49
74.200.187.5
64.57.18.193
64.57.28.61
150.99.199.94
64.57.28.246
10.254.254.9
64.57.29.53
208.77.76.138
150.99.200.194
64.57.28.65
207.72.112.38
198.32.11.13
64.57.17.1
64.57.28.57
64.57.19.17
64.57.28.13
64.57.18.185
64.57.16.17
64.57.26.254
198.32.154.6
64.57.16.161
64.57.29.29
141.225.250.30
64.57.23.121
192.168.1.1
64.57.28.245
141.225.250.26
192.88.192.134
64.57.23.33
64.57.28.177
138.18.47.34
64.57.28.249
64.57.17.25
64.57.29.41
64.57.29.33
64.57.16.33
211.79.48.178
64.208.110.38
198.9.201.205
64.57.17.145
198.32.170.43
64.57.28.17
198.32.14.65
199.18.156.134
207.231.243.8
64.57.17.21
64.57.23.41
207.72.112.34
64.57.28.10
64.57.28.20
64.57.17.17
198.86.53.2
10.254.254.6
64.57.29.49
198.32.11.101
216.249.136.134
206.196.178.46
198.32.11.85
64.57.28.42
64.57.28.242
64.57.29.9
64.57.16.209
205.213.118.6
64.57.28.27
192.17.10.46
192.245.196.110
198.32.118.55
64.57.18.49
64.57.17.225
64.57.28.6
205.213.119.26
138.18.47.42
192.35.86.9
64.57.28.14
156.110.203.2
207.231.245.8
64.57.17.149
198.32.154.133
137.164.26.129
198.32.176.89
198.32.165.66
64.57.28.19
198.32.252.254
199.109.11.2
156.110.203.6
199.18.156.130
64.57.18.129
64.57.28.36
64.57.17.97
64.57.19.1
64.208.110.186
74.125.48.178
198.32.11.29
198.32.11.109
64.57.28.46
64.57.18.217
192.88.115.25
}}}


==== Indianna Univesrity ====

{{{
149.165.227.252
149.165.128.5
149.165.254.225
192.12.206.185
149.165.254.33
149.165.184.6
149.165.254.2
149.165.254.142
149.165.254.54
199.8.220.5
149.165.254.249
149.165.254.22
149.165.227.249
72.36.127.150
192.5.40.179
192.5.40.187
149.165.254.121
149.165.254.81
149.165.254.25
149.165.254.4
149.165.254.89
149.165.128.6
149.165.254.70
149.165.184.130
149.165.254.30
149.165.255.65
149.165.184.1
149.165.227.254
199.8.220.65
149.165.254.74
198.49.182.129
149.165.254.41
149.165.254.58
149.165.255.64
192.12.206.181
192.12.206.225
149.165.254.9
149.165.184.134
149.165.254.245
149.165.254.6
72.12.193.22
149.165.184.3
149.165.254.45
149.165.184.8
149.165.254.50
149.165.254.20
149.159.254.125
199.8.220.1
149.165.183.13
192.12.206.209
149.165.254.237
149.165.129.254
149.165.254.77
149.165.254.13
149.165.184.9
149.165.254.233
199.8.220.73
192.5.40.166
149.165.184.5
149.165.254.37
144.228.154.166
149.165.254.101
149.165.183.17
149.165.254.229
149.165.184.7
192.5.40.134
149.165.254.113
10.10.10.4
149.165.254.134
72.12.215.250
149.165.128.4
149.165.254.29
149.165.227.21
149.165.254.26
149.165.184.4
207.72.112.50
149.165.184.2
72.12.215.254
149.165.254.240
}}}


==== PIONIER ====

{{{
212.191.224.58
212.191.224.130
212.191.126.4
150.254.255.5
212.191.224.70
150.254.255.10
150.254.162.229
212.191.224.186
212.191.224.42
212.191.224.174
212.191.224.38
212.191.224.82
212.191.224.6
212.191.224.50
62.40.124.182
212.191.224.166
212.191.224.18
212.191.224.206
212.191.224.74
212.191.224.106
212.191.224.234
212.191.224.178
212.191.224.90
212.191.224.162
212.191.224.66
212.191.224.170
212.191.224.238
}}}


==== SWITCH ====

{{{
130.59.36.210
130.59.36.250
192.65.184.221
130.59.36.145
130.59.36.90
130.59.36.1
130.59.37.121
130.59.15.14
130.59.36.9
130.59.32.58
130.59.36.109
130.59.36.2
130.59.37.65
130.59.36.57
130.59.32.42
130.59.37.29
130.59.37.18
130.59.32.151
213.248.79.190
130.59.37.142
130.59.36.157
130.59.36.50
130.59.32.160
130.59.32.158
130.59.36.81
130.59.36.106
130.59.37.33
130.59.32.35
130.59.32.60
130.59.36.170
130.59.37.14
130.59.36.49
130.59.36.185
130.59.37.98
130.59.36.58
130.59.36.197
130.59.36.181
130.59.36.85
130.59.36.94
130.59.36.42
130.59.37.30
130.59.37.13
130.59.36.153
130.59.36.214
62.40.124.82
130.59.36.234
130.59.36.102
130.59.32.8
130.59.36.66
130.59.36.158
130.59.36.22
130.59.36.237
130.59.37.82
130.59.37.38
130.59.36.162
130.59.36.46
130.59.37.1
130.59.37.37
130.59.32.11
130.59.32.54
130.59.36.166
130.59.36.113
130.59.36.6
130.59.36.126
130.59.36.173
130.59.37.130
130.59.32.157
130.59.32.14
130.59.36.174
130.59.36.178
130.59.37.90
130.59.32.55
130.59.37.66
130.59.36.193
130.59.37.117
130.59.32.161
130.59.36.117
130.59.36.98
130.59.37.70
130.59.37.41
130.59.32.152
130.59.32.47
130.59.36.217
130.59.36.65
192.65.184.84
130.59.36.129
130.59.36.89
62.40.124.22
130.59.37.105
130.59.37.34
130.59.36.137
130.59.32.51
130.59.37.85
130.59.37.133
130.59.37.109
130.59.37.93
130.59.36.73
130.59.37.22
130.59.36.249
130.59.36.69
130.59.36.45
130.59.37.78
130.59.37.45
130.59.37.102
130.59.36.34
130.59.37.81
130.59.36.21
64.213.33.222
130.59.36.26
130.59.36.53
130.59.32.48
130.59.37.49
130.59.37.2
130.59.36.206
130.59.37.74
130.59.36.194
130.59.36.218
130.59.32.162
130.59.36.110
130.59.36.70
130.59.36.222
130.59.32.56
130.59.37.110
130.59.36.77
130.59.32.12
130.59.36.17
130.59.37.86
130.59.36.118
130.59.36.161
130.59.32.61
130.59.36.209
130.59.32.28
130.59.32.156
130.59.36.245
130.59.32.59
130.59.36.62
130.59.37.53
194.242.34.53
130.59.36.150
130.59.32.153
130.59.36.198
192.65.184.173
130.59.36.238
130.59.36.130
130.59.37.26
130.59.36.177
130.59.36.142
130.59.36.74
130.59.36.33
130.59.37.17
130.59.32.30
130.59.15.15
130.59.36.205
130.59.36.146
130.59.37.101
130.59.36.122
130.59.37.77
130.59.37.42
130.59.37.46
130.59.36.202
130.59.36.221
130.59.36.78
130.59.36.165
130.59.36.97
130.59.37.73
130.59.36.105
130.59.37.50
130.59.36.169
192.65.185.130
130.59.32.57
130.59.36.54
130.59.36.242
130.59.15.13
130.59.36.125
130.59.37.106
130.59.36.18
130.59.37.89
130.59.36.61
130.59.37.21
130.59.32.52
130.59.37.25
130.59.37.97
130.59.36.154
130.59.36.101
130.59.36.5
130.59.32.154
130.59.36.13
130.59.36.213
130.59.32.159
130.59.32.10
130.59.36.182
130.59.36.138
194.242.34.52
130.59.37.129
130.59.36.86
130.59.36.93
130.59.36.226
130.59.36.149
130.59.36.201
64.212.70.62
213.242.73.138
130.59.36.121
130.59.37.94
130.59.36.82
130.59.37.69
130.59.32.53
130.59.36.246
130.59.36.241
129.143.29.42
130.59.32.155
130.59.36.41
130.59.36.114
130.59.36.141
194.42.48.11
}}}


=== Proposed Algorithm:  Independent Children Algorithm with Minimum Summarizing Mask ===

This algorithm works as follows.

Given a list of IP numbers, create a [http://en.wikipedia.org/wiki/Patricia_tree Patricia Tree] (or simply [http://en.wikipedia.org/wiki/Trie Trie]) and iterate over the list, inserting each IP number into the trie.  The trie data structure will automatically create inner nodes which correspond to the (candidate) summarization nodes, or CIDR classes.

When a node is created into the trie, two values are calculated and attached to the node:  the _density_ and the _childCount_.

The _childCount_ is the number of descendants below a node.  Or, in other words, the number of nodes within the subtrees deriving from that node.  Every time a node is added to the trie, its ancestors also have this value updated.

The _density_ is a measure of the density of number of descendants of the node over the maximum possible number of hosts below the node.  The idea here is that, if below a node, there can exist a maximum of 32 hosts, but actually there exists only one, then the density of hosts below that node is low.  If there can exist a maximum of 32 hosts, and there are actually 32 hosts below the node, then the density is high (or maximal in this case).  The density is calculated as:

    `$self->{density} =  $self->{childCount} / (2**(MAX_KEY_LENGTH - $self->{mask}));`
	
where MAX_KEY_LENGTH is typically 32, the _mask_ is the CIDR class (number after the / in the IP number), and _childCount_ is the number of descendants (calculated as above).  The meaning of this equation is:  MAX_KEY_LENGTH - _mask_ yields the number of bits available, in the range of IP addresses, to be assigned to hosts.  Raising 2 to this power results in the equivalent number of hosts available within this range of IP addresses.  Dividing the actual number of descendants by the number of (maximum) available hosts yields the density.  This density value is also updated as new nodes are added to the trie.

Once created, traverse down the trie, starting from the root node (the root node should be the looser, or larger, summarization IP number; in a worst case, it would be 0.0.0.0/0).  At each internal node, evaluate whether the trie should continue to be traversed down, or whether it should be pruned, and the corresponding node is then marked as a summarization node.  The decision of whether to mark a summarization node is done in the method _markIpTrieDensityDistance_, shown below:


{{{
sub markIpTrieDensityDistance {
    my ( $self, $summaryArrayListref, $node ) = @_;

    my @summaryArrayList = @$summaryArrayListref;

    my $c0n = $node->{childZero};
    my $c1n = $node->{childOne};

    if ( !( defined $c0n ) ) {
        $node->setSummaryMember();
        push( @summaryArrayList, $node );

#If either condition below is satisfied, then the program will traverse down the subtrees below the current node and perform
#the same tests on the descendants. If none of the conditions is satisfied, then the current node is marked
#as a summarization node and the subtrees below this node will not be further analyzed.
#The heuristic used for this decision is based on the distance between an internal node and its children,
#and the density. The distance value expresses the number of CIDR classes between the current
#node and its child; basically, it conveys the notion whether the current node represents a too large subnet
#to be considered for summarization. For example, consider that the current node has a mask of 20 and its child
#has a mask of 32. Then the current node represents a subclass of 4096 hosts (12 bits), so there's a possibility
#of having a substantial amount of nodes below the current node. The algorithm then decides to traverse down the subtree.
#Conversely, if the distance is short, then the current node may already comprise sufficient information to be selected
#as a summarization node.
#         *  The reasoning for the density tries to gather whether there exists already a relevant number of descendants
#for the current node; if there is, then it may be convenient to select the current node as a summarization node.
#
#The decision for summarization is based on converting the given granularity setting into a density and distance threshold by
#means of a proper equation.  The real (node) value of the distance and density is then compared to this calculated threshold
#and the decision is made.  The equations represent interpolating functions for each distance and density based on empirical
#points, as shown below:
#
#            Threshold value for comparison
#             Granularity    Distance    Density
#                     0        4        1,00E-05
#                     1        8        1,00E-06
#                     2        12        1,00E-07
#                     3        16        1,00E-08
#
#
#Distance uses equation y = 4x + 4
#Density uses equation y = 1e-5*exp(-2.303x),
#where x is the granularity.  The output is to be compared with the real distance or density value.
#These equations attempt to mimic empirical (ideal) settings for density and distance that perform finer and coarser summarizations.
#
    } elsif ( defined $c0n && ( $node->{mask} < $self->{minMask} ) || #triggers subtrees recursion if this node mask is lower than minMask (not inclusive)
        ( $c0n->{mask} - $node->{mask} > ( 4 * $self->{granularity} + 4 ) )    ||
        ( $c1n->{mask} - $node->{mask} > ( 4 * $self->{granularity} + 4 ) )    ||

        #testing here the independent density for each child
        ( $c0n->{density} < 1e-5 * exp( -2.303 * $self->{granularity} ) ) ||
        ( $c1n->{density} < 1e-5 * exp( -2.303 * $self->{granularity} ) ) ) {
            @summaryArrayList = $self->markIpTrieDensityDistance( \@summaryArrayList, $c0n );
            @summaryArrayList = $self->markIpTrieDensityDistance( \@summaryArrayList, $c1n );
        } else {
            $node->setSummaryMember();
            push( @summaryArrayList, $node );
        }
    return @summaryArrayList;
}
}}}

Basically, the decision upon a candidate for being selected as summarizing node is done in these steps:

The mask for the current candidate node is compared to the minMask parameter.  If the current node's mask is lower than the minMask parameter, the node is considered not suitable and a recursion is immediately triggered for both its children, in order to investigate nodes further down the tree to be selected as summarizing nodes.  This minMask parameter guarantees that a node with too low of a mask do not be selected as summarizing, perhaps then representing a too large subnet.

Next, each child of a node is evaluated for the following conditions:

    _!ChildMask_ - _!NodeMask_ > <font color="firebrick">distanceThreshold</font>

    _Node Density_ < <font color="firebrick">densityThreshold</font> (i.e., low density)

If either is satisfied, then the program will traverse down the subtrees below the current node and perform the same tests on the descendants.  If none of the conditions is satisfied, then the current node is marked as a summarization node and the subtrees below this node will not be further analyzed.

The heuristic used for this decision is based on the _distance_ between an internal node and its children, and the density.  The _distance_ value expresses the number of CIDR classes between the current node and its child; basically, it conveys the notion whether the current node represents a too large subnet to be considered for summarization.  For example, consider that the current node has a mask of 20 and its child has a mask of 32.  Then the current node is claiming approximately 2^11 = 2048 hosts (12 - 1 bits), if the current node is made a summarizing node, hosts that are in fact vacant in the original network.  The algorithm then decides to traverse down the subtree and summarize "tighter" subnets.  Conversely, if the distance is short, then the current node may already comprise sufficient information to be selected as a summarization node.

The reasoning for the density tries to gather whether there exists already a relevant number of descendants for the current node; if there is, then it may be convenient to select the current node as a summarization node.

The algorithm also incorporates "tuning" of the "aggressiveness" of the summarization.  Currently, the tuning has been integrated as a "granularity" parameter, ranging from 0 (the finer granularity, or more specific summarization) to 3 (the coarser granularity, or more general summarization).  The heuristic is based on the calculation as follows:

{{{
elsif ( defined $c0n && ( $node->{mask} < $self->{minMask} ) || #triggers subtrees recursion if this node mask is lower than minMask (not inclusive)
        ( $c0n->{mask} - $node->{mask} > ( 4 * $self->{granularity} + 4 ) )    ||
        ( $c1n->{mask} - $node->{mask} > ( 4 * $self->{granularity} + 4 ) )    ||

        #testing here the independent density for each child
        ( $c0n->{density} < 1e-5 * exp( -2.303 * $self->{granularity} ) ) ||
        ( $c1n->{density} < 1e-5 * exp( -2.303 * $self->{granularity} ) ) ) {
            @summaryArrayList = $self->markIpTrieDensityDistance( \@summaryArrayList, $c0n );
            @summaryArrayList = $self->markIpTrieDensityDistance( \@summaryArrayList, $c1n );
        } else {
            $node->setSummaryMember();
            push( @summaryArrayList, $node );
}
}}}

The decision for summarization is based on converting the given granularity setting into a density and distance threshold by means of a proper equation.  The real (node) value of the distance and density is then compared to this calculated threshold and the decision is made.  The equations represent interpolating functions for each distance and density based on empirical points, as shown below:

 
|| || <font color="mediumblue">*Threshold value for comparison*</font> || ||	
|| <font color="mediumblue">*Granularity*</font> || <font color="mediumblue">*Distance*</font> || <font color="mediumblue">*Density*</font> ||
|| 0 || 4 || 1,00E-05 ||
|| 1 || 8 || 1,00E-06 ||
|| 2 || 12 || 1,00E-07 ||
|| 3|| 16 || 1,00E-08 ||

    Distance uses equation _y = 4x + 4_

    Density uses equation _y = 1E-5*e^-2.303x^_,

where x is the granularity.

The output is to be compared with the real distance or density value.  These equations attempt to mimic empirical (ideal) settings for density and distance that perform finer and coarser summarizations.


==== Comments ====

The coarser or finer result of the granularity setting seems to be highly dependent on the data.  Some data present noticeable differences for each setting, whereas other data displays no change from one setting to a coarser or finer one.


==== Experimentation Results ====

	
	{{{
	

	File                 :  data\APAN.txt
	Granularity setting  :  0
	Minimum Summ. Mask   :  8
	Original set count   :  104
	Summarized set count :  19
	Compression rate     :  0.182692307692308
	(summarized/original)

	10.0.0.4/32
	45.0.0.1/32
	117.103.111.133/32
	133.69.37.1/32
	140.221.251.2/32
	163.220.127.238/32
	172.24.61.30/32
	172.24.100.210/32
	192.203.116.144/28
	202.40.161.239/32
	202.178.96.85/32
	202.179.241.37/32
	202.180.34.134/32
	202.180.34.158/32
	202.249.2.160/32
	203.178.133.141/32
	203.181.102.130/32
	203.181.194.0/23
	203.181.248.0/23


	File                 :  data\APAN.txt
	Granularity setting  :  1
	Minimum Summ. Mask   :  8
	Original set count   :  104
	Summarized set count :  17
	Compression rate     :  0.163461538461538
	(summarized/original)

	10.0.0.4/32
	45.0.0.1/32
	117.103.111.133/32
	133.69.37.1/32
	140.221.251.2/32
	163.220.127.238/32
	172.24.61.30/32
	172.24.100.210/32
	192.203.116.144/28
	202.40.161.239/32
	202.178.96.85/32
	202.179.241.37/32
	202.180.34.128/27
	202.249.2.160/32
	203.178.133.141/32
	203.181.102.130/32
	203.181.192.0/18


	File                 :  data\APAN.txt
	Granularity setting  :  2
	Minimum Summ. Mask   :  8
	Original set count   :  104
	Summarized set count :  17
	Compression rate     :  0.163461538461538
	(summarized/original)

	10.0.0.4/32
	45.0.0.1/32
	117.103.111.133/32
	133.69.37.1/32
	140.221.251.2/32
	163.220.127.238/32
	172.24.61.30/32
	172.24.100.210/32
	192.203.116.144/28
	202.40.161.239/32
	202.178.96.85/32
	202.179.241.37/32
	202.180.34.128/27
	202.249.2.160/32
	203.178.133.141/32
	203.181.102.130/32
	203.181.192.0/18


	File                 :  data\APAN.txt
	Granularity setting  :  3
	Minimum Summ. Mask   :  8
	Original set count   :  104
	Summarized set count :  13
	Compression rate     :  0.125
	(summarized/original)

	10.0.0.4/32
	45.0.0.1/32
	117.103.111.133/32
	133.69.37.1/32
	140.221.251.2/32
	163.220.127.238/32
	172.24.0.0/17
	192.203.116.144/28
	202.40.161.239/32
	202.176.0.0/13
	202.249.2.160/32
	203.178.133.141/32
	203.181.0.0/16


	File                 :  data\ESnet.txt
	Granularity setting  :  0
	Minimum Summ. Mask   :  8
	Original set count   :  618
	Summarized set count :  58
	Compression rate     :  0.0938511326860841
	(summarized/original)

	10.0.0.4/32
	10.10.10.1/32
	10.31.20.2/32
	18.201.0.118/32
	62.40.124.230/32
	62.40.125.72/29
	62.40.125.94/32
	117.103.111.157/32
	128.115.190.1/32
	128.115.190.101/32
	134.55.0.0/16
	134.167.160.49/32
	137.164.27.93/32
	138.18.155.22/32
	147.155.254.1/32
	150.99.198.218/32
	150.99.199.62/32
	172.16.32.0/30
	192.5.170.78/32
	192.12.208.1/32
	192.13.56.0/25
	192.31.96.2/32
	192.31.99.138/32
	192.33.240.193/32
	192.65.95.2/32
	192.68.191.146/32
	192.68.191.162/32
	192.73.7.193/32
	192.84.8.50/32
	192.107.175.3/32
	192.150.29.210/32
	192.150.31.78/32
	192.168.201.0/28
	192.168.201.52/32
	192.188.106.140/32
	192.203.230.13/32
	192.245.178.6/32
	198.9.202.13/32
	198.32.153.13/32
	198.49.208.14/32
	198.49.208.17/32
	198.49.208.229/32
	198.124.16.1/32
	198.124.17.9/32
	198.124.17.17/32
	198.124.128.0/17
	198.125.140.0/24
	198.128.4.5/32
	198.128.15.101/32
	198.129.0.0/16
	198.151.133.185/32
	198.151.133.253/32
	198.206.220.1/32
	198.206.221.254/32
	199.109.4.150/32
	204.134.149.2/32
	207.231.240.0/20
	211.79.48.173/32


	File                 :  data\ESnet.txt
	Granularity setting  :  1
	Minimum Summ. Mask   :  8
	Original set count   :  618
	Summarized set count :  28
	Compression rate     :  0.0453074433656958
	(summarized/original)

	10.0.0.4/32
	10.10.10.1/32
	10.31.20.2/32
	18.201.0.118/32
	62.40.124.230/32
	62.40.125.64/27
	117.103.111.157/32
	128.115.190.0/25
	134.55.0.0/16
	134.167.160.49/32
	137.164.27.93/32
	138.18.155.22/32
	147.155.254.1/32
	150.99.198.218/32
	150.99.199.62/32
	172.16.32.0/30
	192.0.0.0/9
	192.150.29.210/32
	192.150.31.78/32
	192.168.201.0/26
	192.188.106.140/32
	192.203.230.13/32
	192.245.178.6/32
	198.0.0.0/8
	199.109.4.150/32
	204.134.149.2/32
	207.231.240.0/20
	211.79.48.173/32


	File                 :  data\ESnet.txt
	Granularity setting  :  2
	Minimum Summ. Mask   :  8
	Original set count   :  618
	Summarized set count :  20
	Compression rate     :  0.0323624595469256
	(summarized/original)

	10.0.0.4/32
	10.10.10.1/32
	10.31.20.2/32
	18.201.0.118/32
	62.40.124.0/23
	117.103.111.157/32
	128.115.190.0/25
	134.55.0.0/16
	134.167.160.49/32
	137.164.27.93/32
	138.18.155.22/32
	147.155.254.1/32
	150.99.198.0/23
	172.16.32.0/30
	192.0.0.0/8
	198.0.0.0/8
	199.109.4.150/32
	204.134.149.2/32
	207.231.240.0/20
	211.79.48.173/32


	File                 :  data\ESnet.txt
	Granularity setting  :  3
	Minimum Summ. Mask   :  8
	Original set count   :  618
	Summarized set count :  20
	Compression rate     :  0.0323624595469256
	(summarized/original)

	10.0.0.4/32
	10.10.10.1/32
	10.31.20.2/32
	18.201.0.118/32
	62.40.124.0/23
	117.103.111.157/32
	128.115.190.0/25
	134.55.0.0/16
	134.167.160.49/32
	137.164.27.93/32
	138.18.155.22/32
	147.155.254.1/32
	150.99.198.0/23
	172.16.32.0/30
	192.0.0.0/8
	198.0.0.0/8
	199.109.4.150/32
	204.134.149.2/32
	207.231.240.0/20
	211.79.48.173/32


	File                 :  data\FCCN.txt
	Granularity setting  :  0
	Minimum Summ. Mask   :  8
	Original set count   :  43
	Summarized set count :  4
	Compression rate     :  0.0930232558139535
	(summarized/original)

	62.40.124.186/32
	193.136.0.0/15
	194.210.30.1/32
	194.210.63.253/32


	File                 :  data\FCCN.txt
	Granularity setting  :  1
	Minimum Summ. Mask   :  8
	Original set count   :  43
	Summarized set count :  4
	Compression rate     :  0.0930232558139535
	(summarized/original)

	62.40.124.186/32
	193.136.0.0/15
	194.210.30.1/32
	194.210.63.253/32


	File                 :  data\FCCN.txt
	Granularity setting  :  2
	Minimum Summ. Mask   :  8
	Original set count   :  43
	Summarized set count :  4
	Compression rate     :  0.0930232558139535
	(summarized/original)

	62.40.124.186/32
	193.136.0.0/15
	194.210.30.1/32
	194.210.63.253/32


	File                 :  data\FCCN.txt
	Granularity setting  :  3
	Minimum Summ. Mask   :  8
	Original set count   :  43
	Summarized set count :  3
	Compression rate     :  0.0697674418604651
	(summarized/original)

	62.40.124.186/32
	193.136.0.0/15
	194.210.0.0/18


	File                 :  data\GARR.txt
	Granularity setting  :  0
	Minimum Summ. Mask   :  8
	Original set count   :  163
	Summarized set count :  2
	Compression rate     :  0.0122699386503067
	(summarized/original)

	10.1.2.3/32
	193.206.128.0/20


	File                 :  data\GARR.txt
	Granularity setting  :  1
	Minimum Summ. Mask   :  8
	Original set count   :  163
	Summarized set count :  2
	Compression rate     :  0.0122699386503067
	(summarized/original)

	10.1.2.3/32
	193.206.128.0/20


	File                 :  data\GARR.txt
	Granularity setting  :  2
	Minimum Summ. Mask   :  8
	Original set count   :  163
	Summarized set count :  2
	Compression rate     :  0.0122699386503067
	(summarized/original)

	10.1.2.3/32
	193.206.128.0/20


	File                 :  data\GARR.txt
	Granularity setting  :  3
	Minimum Summ. Mask   :  8
	Original set count   :  163
	Summarized set count :  2
	Compression rate     :  0.0122699386503067
	(summarized/original)

	10.1.2.3/32
	193.206.128.0/20


	File                 :  data\Geant.txt
	Granularity setting  :  0
	Minimum Summ. Mask   :  8
	Original set count   :  30
	Summarized set count :  5
	Compression rate     :  0.166666666666667
	(summarized/original)

	62.40.112.0/20
	128.0.0.6/32
	150.99.188.202/32
	198.32.11.51/32
	216.24.184.86/32


	File                 :  data\Geant.txt
	Granularity setting  :  1
	Minimum Summ. Mask   :  8
	Original set count   :  30
	Summarized set count :  5
	Compression rate     :  0.166666666666667
	(summarized/original)

	62.40.112.0/20
	128.0.0.6/32
	150.99.188.202/32
	198.32.11.51/32
	216.24.184.86/32


	File                 :  data\Geant.txt
	Granularity setting  :  2
	Minimum Summ. Mask   :  8
	Original set count   :  30
	Summarized set count :  5
	Compression rate     :  0.166666666666667
	(summarized/original)

	62.40.112.0/20
	128.0.0.6/32
	150.99.188.202/32
	198.32.11.51/32
	216.24.184.86/32


	File                 :  data\Geant.txt
	Granularity setting  :  3
	Minimum Summ. Mask   :  8
	Original set count   :  30
	Summarized set count :  5
	Compression rate     :  0.166666666666667
	(summarized/original)

	62.40.112.0/20
	128.0.0.6/32
	150.99.188.202/32
	198.32.11.51/32
	216.24.184.86/32


	File                 :  data\Internet2.txt
	Granularity setting  :  0
	Minimum Summ. Mask   :  8
	Original set count   :  282
	Summarized set count :  86
	Compression rate     :  0.304964539007092
	(summarized/original)

	10.254.254.0/28
	62.40.125.18/32
	64.57.16.0/20
	64.208.110.0/24
	64.215.195.42/32
	69.31.111.90/32
	72.36.127.138/32
	74.125.48.106/32
	74.125.48.178/32
	74.125.48.226/32
	74.200.187.5/32
	80.231.134.30/32
	117.103.111.153/32
	128.135.247.125/32
	131.247.47.213/32
	131.247.47.225/32
	134.75.108.46/32
	137.164.26.128/29
	137.227.2.182/32
	138.18.47.32/28
	138.18.155.34/32
	140.173.1.238/32
	141.225.250.24/29
	143.215.193.10/32
	144.92.233.117/32
	149.165.254.0/27
	150.99.199.94/32
	150.99.200.194/32
	156.110.203.0/29
	164.113.238.142/32
	164.113.238.193/32
	192.5.89.222/32
	192.17.10.46/32
	192.31.99.134/32
	192.35.86.9/32
	192.35.86.174/32
	192.35.86.224/29
	192.41.213.113/32
	192.84.8.254/32
	192.88.115.25/32
	192.88.115.117/32
	192.88.192.128/28
	192.91.246.125/32
	192.122.183.10/32
	192.122.183.30/32
	192.122.183.46/32
	192.150.29.6/32
	192.168.1.1/32
	192.245.196.110/32
	198.9.201.205/32
	198.9.202.205/32
	198.32.0.0/16
	198.49.182.4/30
	198.86.17.66/32
	198.86.53.2/32
	198.109.37.22/32
	198.124.194.10/32
	198.124.216.158/32
	198.125.140.230/32
	199.18.156.128/25
	199.109.4.154/32
	199.109.11.2/32
	200.0.207.10/32
	200.23.60.122/32
	203.181.248.141/32
	204.238.76.0/29
	205.189.32.93/32
	205.189.32.97/32
	205.189.32.117/32
	205.213.118.0/28
	205.213.119.0/27
	206.196.177.106/32
	206.196.178.46/32
	206.220.240.86/32
	206.223.119.120/32
	207.72.112.32/29
	207.210.142.2/32
	207.231.240.0/21
	208.77.76.128/28
	208.100.127.32/29
	209.131.107.142/32
	211.79.48.158/32
	211.79.48.178/32
	216.27.100.48/28
	216.249.136.134/32
	216.249.136.198/32


	File                 :  data\Internet2.txt
	Granularity setting  :  1
	Minimum Summ. Mask   :  8
	Original set count   :  282
	Summarized set count :  54
	Compression rate     :  0.191489361702128
	(summarized/original)

	10.254.254.0/28
	62.40.125.18/32
	64.57.16.0/20
	64.208.110.0/24
	64.215.195.42/32
	69.31.111.90/32
	72.36.127.138/32
	74.125.48.0/24
	74.200.187.5/32
	80.231.134.30/32
	117.103.111.153/32
	128.135.247.125/32
	131.247.47.192/26
	134.75.108.46/32
	137.164.26.128/29
	137.227.2.182/32
	138.18.47.32/28
	138.18.155.34/32
	140.173.1.238/32
	141.225.250.24/29
	143.215.193.10/32
	144.92.233.117/32
	149.165.254.0/27
	150.99.199.94/32
	150.99.200.194/32
	156.110.203.0/29
	164.113.238.128/25
	192.0.0.0/9
	192.150.29.6/32
	192.168.1.1/32
	192.245.196.110/32
	198.0.0.0/9
	199.18.156.128/25
	199.109.4.154/32
	199.109.11.2/32
	200.0.207.10/32
	200.23.60.122/32
	203.181.248.141/32
	204.238.76.0/29
	205.189.32.64/26
	205.213.118.0/23
	206.196.177.106/32
	206.196.178.46/32
	206.220.240.86/32
	206.223.119.120/32
	207.72.112.32/29
	207.210.142.2/32
	207.231.240.0/21
	208.77.76.128/28
	208.100.127.32/29
	209.131.107.142/32
	211.79.48.128/26
	216.27.100.48/28
	216.249.136.128/25


	File                 :  data\Internet2.txt
	Granularity setting  :  2
	Minimum Summ. Mask   :  8
	Original set count   :  282
	Summarized set count :  44
	Compression rate     :  0.156028368794326
	(summarized/original)

	10.254.254.0/28
	62.40.125.18/32
	64.0.0.0/8
	69.31.111.90/32
	72.36.127.138/32
	74.125.48.0/24
	74.200.187.5/32
	80.231.134.30/32
	117.103.111.153/32
	128.135.247.125/32
	131.247.47.192/26
	134.75.108.46/32
	137.164.26.128/29
	137.227.2.182/32
	138.18.47.32/28
	138.18.155.34/32
	140.173.1.238/32
	141.225.250.24/29
	143.215.193.10/32
	144.92.233.117/32
	149.165.254.0/27
	150.99.192.0/20
	156.110.203.0/29
	164.113.238.128/25
	192.0.0.0/8
	198.0.0.0/9
	199.18.156.128/25
	199.109.0.0/20
	200.0.207.10/32
	200.23.60.122/32
	203.181.248.141/32
	204.238.76.0/29
	205.189.32.64/26
	205.213.118.0/23
	206.192.0.0/11
	207.72.112.32/29
	207.210.142.2/32
	207.231.240.0/21
	208.77.76.128/28
	208.100.127.32/29
	209.131.107.142/32
	211.79.48.128/26
	216.27.100.48/28
	216.249.136.128/25


	File                 :  data\Internet2.txt
	Granularity setting  :  3
	Minimum Summ. Mask   :  8
	Original set count   :  282
	Summarized set count :  42
	Compression rate     :  0.148936170212766
	(summarized/original)

	10.254.254.0/28
	62.40.125.18/32
	64.0.0.0/8
	69.31.111.90/32
	72.36.127.138/32
	74.125.48.0/24
	74.200.187.5/32
	80.231.134.30/32
	117.103.111.153/32
	128.135.247.125/32
	131.247.47.192/26
	134.75.108.46/32
	137.164.26.128/29
	137.227.2.182/32
	138.18.0.0/16
	140.173.1.238/32
	141.225.250.24/29
	143.215.193.10/32
	144.92.233.117/32
	149.165.254.0/27
	150.99.192.0/20
	156.110.203.0/29
	164.113.238.128/25
	192.0.0.0/8
	198.0.0.0/9
	199.0.0.0/9
	200.0.207.10/32
	200.23.60.122/32
	203.181.248.141/32
	204.238.76.0/29
	205.189.32.64/26
	205.213.118.0/23
	206.192.0.0/11
	207.72.112.32/29
	207.210.142.2/32
	207.231.240.0/21
	208.77.76.128/28
	208.100.127.32/29
	209.131.107.142/32
	211.79.48.128/26
	216.27.100.48/28
	216.249.136.128/25


	File                 :  data\iu.txt
	Granularity setting  :  0
	Minimum Summ. Mask   :  8
	Original set count   :  79
	Summarized set count :  14
	Compression rate     :  0.177215189873418
	(summarized/original)

	10.10.10.4/32
	72.12.193.22/32
	72.12.215.248/29
	72.36.127.150/32
	144.228.154.166/32
	149.159.254.125/32
	149.165.128.0/17
	192.5.40.134/32
	192.5.40.166/32
	192.5.40.176/28
	192.12.206.128/25
	198.49.182.129/32
	199.8.220.0/25
	207.72.112.50/32


	File                 :  data\iu.txt
	Granularity setting  :  1
	Minimum Summ. Mask   :  8
	Original set count   :  79
	Summarized set count :  12
	Compression rate     :  0.151898734177215
	(summarized/original)

	10.10.10.4/32
	72.12.193.22/32
	72.12.215.248/29
	72.36.127.150/32
	144.228.154.166/32
	149.159.254.125/32
	149.165.128.0/17
	192.5.40.128/26
	192.12.206.128/25
	198.49.182.129/32
	199.8.220.0/25
	207.72.112.50/32


	File                 :  data\iu.txt
	Granularity setting  :  2
	Minimum Summ. Mask   :  8
	Original set count   :  79
	Summarized set count :  12
	Compression rate     :  0.151898734177215
	(summarized/original)

	10.10.10.4/32
	72.12.193.22/32
	72.12.215.248/29
	72.36.127.150/32
	144.228.154.166/32
	149.159.254.125/32
	149.165.128.0/17
	192.5.40.128/26
	192.12.206.128/25
	198.49.182.129/32
	199.8.220.0/25
	207.72.112.50/32


	File                 :  data\iu.txt
	Granularity setting  :  3
	Minimum Summ. Mask   :  8
	Original set count   :  79
	Summarized set count :  10
	Compression rate     :  0.126582278481013
	(summarized/original)

	10.10.10.4/32
	72.12.192.0/19
	72.36.127.150/32
	144.228.154.166/32
	149.159.254.125/32
	149.165.128.0/17
	192.0.0.0/12
	198.49.182.129/32
	199.8.220.0/25
	207.72.112.50/32


	File                 :  data\Psnc.txt
	Granularity setting  :  0
	Minimum Summ. Mask   :  8
	Original set count   :  27
	Summarized set count :  5
	Compression rate     :  0.185185185185185
	(summarized/original)

	62.40.124.182/32
	150.254.162.229/32
	150.254.255.0/28
	212.191.126.4/32
	212.191.224.0/24


	File                 :  data\Psnc.txt
	Granularity setting  :  1
	Minimum Summ. Mask   :  8
	Original set count   :  27
	Summarized set count :  5
	Compression rate     :  0.185185185185185
	(summarized/original)

	62.40.124.182/32
	150.254.162.229/32
	150.254.255.0/28
	212.191.126.4/32
	212.191.224.0/24


	File                 :  data\Psnc.txt
	Granularity setting  :  2
	Minimum Summ. Mask   :  8
	Original set count   :  27
	Summarized set count :  5
	Compression rate     :  0.185185185185185
	(summarized/original)

	62.40.124.182/32
	150.254.162.229/32
	150.254.255.0/28
	212.191.126.4/32
	212.191.224.0/24


	File                 :  data\Psnc.txt
	Granularity setting  :  3
	Minimum Summ. Mask   :  8
	Original set count   :  27
	Summarized set count :  3
	Compression rate     :  0.111111111111111
	(summarized/original)

	62.40.124.182/32
	150.254.128.0/17
	212.191.0.0/16


	File                 :  data\SWITCH.txt
	Granularity setting  :  0
	Minimum Summ. Mask   :  8
	Original set count   :  214
	Summarized set count :  15
	Compression rate     :  0.0700934579439252
	(summarized/original)

	62.40.124.22/32
	62.40.124.82/32
	64.212.70.62/32
	64.213.33.222/32
	129.143.29.42/32
	130.59.15.12/30
	130.59.32.0/21
	192.65.184.84/32
	192.65.184.173/32
	192.65.184.221/32
	192.65.185.130/32
	194.42.48.11/32
	194.242.34.52/31
	213.242.73.138/32
	213.248.79.190/32


	File                 :  data\SWITCH.txt
	Granularity setting  :  1
	Minimum Summ. Mask   :  8
	Original set count   :  214
	Summarized set count :  12
	Compression rate     :  0.0560747663551402
	(summarized/original)

	62.40.124.0/25
	64.212.70.62/32
	64.213.33.222/32
	129.143.29.42/32
	130.59.15.12/30
	130.59.32.0/21
	192.65.184.0/24
	192.65.185.130/32
	194.42.48.11/32
	194.242.34.52/31
	213.242.73.138/32
	213.248.79.190/32


	File                 :  data\SWITCH.txt
	Granularity setting  :  2
	Minimum Summ. Mask   :  8
	Original set count   :  214
	Summarized set count :  10
	Compression rate     :  0.0467289719626168
	(summarized/original)

	62.40.124.0/25
	64.212.70.62/32
	64.213.33.222/32
	129.143.29.42/32
	130.59.0.0/18
	192.65.184.0/23
	194.42.48.11/32
	194.242.34.52/31
	213.242.73.138/32
	213.248.79.190/32


	File                 :  data\SWITCH.txt
	Granularity setting  :  3
	Minimum Summ. Mask   :  8
	Original set count   :  214
	Summarized set count :  10
	Compression rate     :  0.0467289719626168
	(summarized/original)

	62.40.124.0/25
	64.212.70.62/32
	64.213.33.222/32
	129.143.29.42/32
	130.59.0.0/18
	192.65.184.0/23
	194.42.48.11/32
	194.242.34.52/31
	213.242.73.138/32
	213.248.79.190/32

	}}}
	

== Performance of the Algorithm ==

The graph below brings the amount of time consumed by the Perl implementation of the heuristic in summarizing each test set, for each granularity setting; i.e., the running times.  For the measurement, the Mininum Subnet Mask was kept at 8.  The test environment was:  PC with Core 2 Quad Q9300 @ 2.5GHz and 4% average load on all cores; 4GiB RAM; Gigabyte GA-P35ds2 motherboard; Western Digital Caviar Blue WD50000AAKS hard drive, SATA 3Gib/s, 16MiB cache, 7200 RPM; Vista Ultimate 32-bit; Eclipse 3.4.1; Perl 5.10.0 ActiveState.

The test sets were text files and were read to a data structure in memory.  The timing measurement commenced after all IP addresses in the file were read into the data structure, and stopped after the summarization was completed and contained within its own data structure in memory.  This way, the latency related to reading the data from a text file is not computed into the measurement (but for eventual operating system virtual memory reads and writes).

Ten samples were taken for each IP set and each granularity.  The average was computed and the error margin taken, considering a confidence level of 0.05 (for a t-Student distribution, with t=2.262).

Clearly, the algorithm exhibits a linear running time to the size of the input (number of IP addresses), i.e., O(n).  The particular values are platform-dependent; the linear, O(n) running time result is more relevant in displaying the performance of the algorithm.

http://perfsonar-ps.googlecode.com/svn/wiki/IPSummarization/running_times.png

== Integration with gLS.pm code ==

The algorithm was integrated into the LS code (gLS.pm) in a test branch (branches/jz-lsperformance in perfSONAR svn).  It comprises the files:

{{{
gLS.pm
IpTrie.pm
IpTrieNode.pm
Trie.pm
TrieNode.pm
README_IP_summarization.html
daemon.conf
}}}

All files, but `daemon.conf` reside in the same place as gLS.pm (perfSONAR_PS::Services::LS); file `daemon.conf` continues in its original place.

The Perl library Net::IP must be installed prior to execution.  The command:

{{{
sudo cpan install Net::IP
}}}

or

{{{
sudo yum --nogpgcheck install perl-Net-IP
}}}

(choose depending on which one Linux wants to accept) installs the required library.  The Lookup Service installation scripts must be modified in order to automatically include this library.

=== Operation ===

The integrated code operates in the following manner:

The function `ipSummarization` within gLS.pm receives a list of IPv4 addresses as input and calls the IP summarization algorithm.  The algorithm builds a PATRICIA tree by inserting each individual address, creating other IP address that represent the CIDR classes in the process.  Then, the tree is traversed and some IP addresses are chosen according to the heuristic decisions and parameters.  The algorithm returns a pointer to a list of IP addresses (that represent the summarized IP address list).

Function `ipSummarization` makes use of the modules IpTrie.pm, IpTrieNode.pm, Trie.pm, and TrieNode.pm, all residing in the same place as the file gLS.pm (see above).  Refer to the README_IP_summarization.html file for more information on the algorithm.  The original gLS code was modified only in the function `ipSummarization`, and also the inclusion of some lines to manipulate the additional parameters described next.  No other part of the original gLS code was altered; the LS original functions, besides the IP summarization, should continue to work as before.

There are two parameters to control the algorithm (implemented through the file daemon.conf):

 * summarization_granularity:  The granularity parameter controls the granularity or coarseness of the summarization.  It accepts values from 0 to 3; 0 results in finer summarizations, i.e., more summarizing nodes being generated; 3 results in coarser summarizations, i.e., fewer, more general summarizing nodes. The default is 1.
 
 * summarization_minMask:  The minMask controls the minimum mask that a summarizing node must present.  Nodes that have a mask smaller than minMask will not be selected as summarizing nodes, thus guaranteeing that summarizing nodes do not become too general.  The parameter accepts values from 0 to MAX_KEY_LENGTH, where, for IPv4, MAX_KEY_LENGTH is 32.  Default is 8.
 
=== Configuration File Format ===

This is an example of a full configuration file including the new two parameters for IP summarization.

{{{
<port 9995>
    <endpoint /perfSONAR_PS/services/hLS>
        <gls>
				                                # just an hLS ... (ORG, CITY, STATE, COUNTRY)
			root                            0
				                                # data TTL = 4 days
			ls_ttl                          5760
				                                # 180 minute (3hr) registaration window
			ls_registration_interval        180
				                                # 120 miute cleaning/summary window
			maintenance_interval	        120
				                                # Database options (only change path)
			metadata_db_file	            glsstore.dbxml
			metadata_summary_db_file	    glsstore-summary.dbxml
			metadata_db_name	            /var/lib/perfsonar/lookup_service/xmldb
				                                # Service options (please customize)
			service_accesspoint	            http://localhost:9995/perfSONAR_PS/services/hLS
			service_description             ORG Home Lookup Service (CITY, STATE, COUNTRY)
			service_name                    ORG Home Lookup Service
			service_type	                hLS
			
			summarization_granularity       1   #integer between [0;3]; 0 is coarser, 3 is finer (larger summarization)
			summarization_minMask           8   #minimum CIDR mask in summarization; for IPv4, 0 to 32
                                                            #summarized IP addresses will not have a mask smaller than minMask

			
		</gls>
		disable	                            0
		module	                            perfSONAR_PS::Services::LS::gLS
	</endpoint>
</port>
	                                            # 180 minute (3hr) registaration window
ls_registration_interval	                180
disable_echo	                            0
	                                            # Root hints info, url + local copy location
root_hints_url	                            http://www.perfsonar.net/gls.root.hints
root_hints_file	                            /var/lib/perfsonar/lookup_service/hls.root.hints
	                                            # Daemon management, shouldn't need changing
reaper_interval	                            20
max_worker_lifetime	                        300
max_worker_processes	                    30
pid_dir                                     /var/run
pid_file	                                lookup_service.pid
}}}
 
== Testing ==

The LS with the new algorithm was deployed in server `moonshine` at University of Delaware as a hLS.  `fakeServices`, 30 in total, were deployed from a virtual node in [http://www.planet-lab.org PlanetLab].  Several different settings of granularity and minMask were verified, and both the original IP addresses from the `fakeServices` and the summarized addresses were recorded to files for debugging the integration.

The algorithm was found to be summarizing the IP addresses as expected, and returning a proper list of addresses.

Another round of testing comprised one hLS and one gLS both located in separate virtual nodes in [http://www.planet-lab.org PlanetLab].  This test consisted in:

 * 20 `fakeServices` (10 services from domain 110.100.x.y, and 10 services from domain 200.100.x.y) registering to the hLS, and this hLS publishing the summarization to the gLS.
 * First, both the hLS and the gLS were started with the legacy code, and the complete LSStore was queried and saved in a file for each service.
 * Second, both the hLS and the gLS were started with the new IP summarization code; the same 10 `fakeServices` registered to the hLS, and the complete LSStore was queried and saved in a file for each service.
 * Outputs from the legacy and new code were compared.
 
To query the complete LSStore from the services, the view.cgi script from perfAdmin was used.

The two LS services are:

{{{
http://plonk.cs.uwaterloo.ca:9995/perfSONAR_PS/services/gLS
http://plink.cs.uwaterloo.ca:9995/perfSONAR_PS/services/hLS
}}}

The outputs collected from each service are below:

 * [http://perfsonar-ps.googlecode.com/svn/wiki/IPSummarization/plink_cs_uwaterloo_ca9995-perfSONAR_PS-services-hLS-legacy.html hLS output for the legacy summarization algorithm.]
 * [http://perfsonar-ps.googlecode.com/svn/wiki/IPSummarization/plink_cs_uwaterloo_ca9995-perfSONAR_PS-services-hLS-new.html hLS output for the new summarization algorithm.]
 * [http://perfsonar-ps.googlecode.com/svn/wiki/IPSummarization/plonk_cs_uwaterloo_ca9995-perfSONAR_PS-services-gLS-legacy.html gLS output for the legacy summarization algorithm.]
 * [http://perfsonar-ps.googlecode.com/svn/wiki/IPSummarization/plonk_cs_uwaterloo_ca9995-perfSONAR_PS-services-gLS-new.html gLS output for the new summarization algorithm.]
 
The difference in the compression level of the IP summarization between the legacy and new algorithms is evident, by glancing at the outputs of the gLS.  Moreover, the outputs initially attest that the overall functions of the LS, apart from IP summarization, are working accordingly, both for gLS and hLS modes.

=== Further Testing ===

These results above are for `fakeServices`.  It is furthermore suggested -- for more comprehensive testing and to verify that all of the untouched part of the original LS code remains operational -- that one hLS with the new algorithm be deployed in a real environment with more "legitimate" services registering to it, and its operation be scrutinized (proper registration, response to queries) together with its publishing of the summarized sets (IP addresses and metadata) to the gLS cloud.  The "legitimate" services could be instances configured specifically for this purpose, or non-critical instances already in use.

Also, verify the operation of the integrated code in gLS mode.  This gLS could integrate the normal gLS cloud (such that it would synchronize a large database of services) and allowed to operate for a limited time, during which it would be watched closely.
 
== Final Integration and Deployment to Production ==

To be decided by perfSONAR personnel.

== Project Management ==

Basic outline:

|| _*Dates*_ || _*Task*_ || _*People*_ ||
|| Weekly || Conference Call - Discuss progress || Jason, Martin, Student (Jeff) || 
|| March 9th - 13th || ~~Evaluate, Learn Current Alg - Identify Failure Points || Student (Martin, Jason)~~ || 
|| March 16th - 20th || ~~Propose Changes (in writing), Experiment on Hypothesis (in code), Publish Results (in writing) || Student (Martin, Jason)~~ || 
|| March 23rd - 27th || Finalize Code in prototype, integration into gLS || Student, Jason (Martin) || 
|| March 30th - April 10th || Planet Lab Beta Testing - Construct Testbed? || Student, Brian T, Jason (Jeff, Martin) || 
|| Late April || Slack time, Member Meeting, Beta Release of New Code || All || 


=== Actions ===

 * JZ 
   * Gather Datasets - <font color=green>_*Done - 3/12*_</font>
   * Assist student in any and all tasks
   * gLS Integration
   * Final report on tasks
 * MS
   * Supervise student
   * weekly reports
   * Assist in researching proper algorithms
   * review progress of performance/effectiveness
 * Student
   * Review existing design of algorithm and source code
   * Propose changes to algorithm
   * Implement changes (several prototypes) in source code
   * Experimentation on data sets
   * Evaluation of results (correctness, speed, effectiveness)
   * Final source code review
   * Assist Jason in gLS integration
   * Assist Brian/Jason in test framework design, installation, testing
   * Final report on tasks
 * BT
   * Review current gLS design (April timeframe) 
   * Assist student in designing test framework
   * Assist student in framework deployment
   * review progress of performance/effectiveness
 * AB
   * Review current gLS design (April timeframe) 
   * Think about impact of topology in summarization
 * JB
   * review progress of performance/effectiveness
   * Review current gLS design (April timeframe) 
 * All
   * Review new algorithm (both effectiveness and performance) before gLS integration

== Last Modified ==

$Id$