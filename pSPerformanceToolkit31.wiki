#summary pS Performance Toolkit 3.1

<wiki:toc max_depth="6" />

== Introduction ==

The following guide describes in detail the steps required to set up version 3.1 of the perfSONAR performance Toolkit ([http://internet2.edu/performance/pS-PerformanceToolkit/ pS Performance Toolkit 3.1]).  It is important to follow each step in order.  Upon getting stuck, consult the [pSPerformanceToolkit31#FAQ FAQ] at the end of this document or join the [https://mail.internet2.edu/wws/info/performance-node-users mailing list].

== System Requirements ==

The pS Performance Toolkit requires modern hardware to function properly.  The following are basic guidelines to selecting hardware to power the measurement tools.

 * _*CPU*_
   * x86 or x86_64 Architecture
   * _*Single Core*_
     * 2.4Ghz or better
   * _*Dual Core*_
     * 1.6Ghz or better
 * _*Main Memory*_
   * 2G or better
 * _*Disk Size*_
   * 250G or better
 * _*Network Card*_
   * External NIC preferred to NIC located on the Motherboard
   * Speed depends on intended use
   * NIC choice is dependent on Linux driver availability, suggestions:
     * Intel Chipset (uses the e1000 driver)
       * PRO/1000 PT PCI-Express
       * PRO/1000 MT PCI-X.
       * PRO/1000 GT
     * Linksys/Netgear (uses the ns83820 driver)
       * 1GE PCI-X card
     * Myricom 10G Cards
       * Up to date drivers with each pS Performance Toolkit Release

Further recommendations for specific test situations and environments are available below.  These should be used to supplement the basic information.  

=== Virtual Machines ===

Use of the pS Performance Toolkit as a virtual machine is not recommended.  Due to the emulation of virtual hardware (i.e. Network Card emulation, dependence on a host clock), measurement tools may not feature a completely accurate result.  Observations have shown the following tools and services behave in unexpected ways when used in a virtual environment:

 * _*NTP*_: Virtual Machines (depending on software implementation) may receive a clock signal from the host they are running upon.  This may be delayed and is never as accurate as a true hardware clock; because of this NTP can suffer high jitter and delay characteristics.
 * _*OWAMP*_: OWAMP requires that NTP be running and depends on accurate NTP results to properly measure the packets used in testing.  
 * _*BWCTL*_: BWCTL requires that NTP be running and depends on an accurate clock to schedule tests to run at the proper time.  Additionally, virtual NIC support does not deliver the maximum available bandwidth as the guest machine often must fight with the host for access to the physical network.  

=== Latency Recommendations === 

Long term storage of latency data will require more disk space than recommended in the base.  We recommend having storage available that is greater than or equal to 500G.  This may be accomplished using a single disk, or a combination of several (e.g. LVM or RAID configuration).  *N.B.* [http://en.wikipedia.org/wiki/Nested_RAID_levels#RAID_0.2B1|RAID 0+1] is recommended for storage of OWAMP data due to the high overhead of multiple tiny write operations.  Use of [http://en.wikipedia.org/wiki/Raid_5#RAID_5|RAID 5] is highly discouraged.   

Minimization of _*Jitter*_ is a common goal when performing latency tests.  In general most CPU and Motherboard combinations work well on modern hardware.   It is *highly recommended* that combination Motherboard and NIC be avoided.

=== Bandwidth Recommendations === 

Bandwidth testing often requires that the CPU, Motherboard, and Network card work in harmony to achieve promised speeds.  Testing has shown that using a CPU (Single or Dual Core) with a higher clock speed will work better when managing the needs of the rest of the machine during bandwidth testing.  It is *highly recommended* that combination Motherboard and NIC be avoided. 

== Installation ==

The pS Performance Toolkit [http://software.internet2.edu/pS-Performance_Toolkit/pS-Performance_Toolkit-3.1.1.iso iso] and [http://software.internet2.edu/pS-Performance_Toolkit/pS-Performance_Toolkit-3.1.1.iso.md5 md5 checksum] are available for download to all interested parties.  Once downloaded please verify the MD5 sum:

{{{
user@host:~$ md5sum pS-Performance_Toolkit-3.1.iso;cat pS-Performance_Toolkit-3.1.1.iso.md5 
2f366ddbd0bbf92b910ff74e5db7ee9b  pS-Performance_Toolkit-3.1.1.iso
2f366ddbd0bbf92b910ff74e5db7ee9b  pS-Performance_Toolkit-3.1.1.iso
}}}

If the calculated value matches the downloaded value, the ISO image is complete and should be burned to a CD.  After burning, please insert the CD into your target machine to boot.  Some items to consider:

 * The target machine should have some way to access the console.  This can be via an attached monitor and keyboard or via remote access through serial ports or KVMs.
 * The target machine's BIOS must allow the machine to boot from CD.  If the CD does not boot, adjust the BIOS (normally access via *_F12_*, *_F2_*, *_Del_*, etc.) and try again.  
 * The target hardware should match what is described in [pSPerformanceToolkit31#System_Requirements System Requirements].

After booting the following screen will appear:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/boot.png

Options can be presented at this time (e.g. going into single user mode) but if nothing is required, simply press enter.  The boot process will commence after this:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/boot-msg.png

The pS Performance Toolkit features a system check to be sure some *_very_* minimal system requirements are met.  The following warning is used when the system memory is too low:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/disk-warn.png

The system is configured to search for addresses via DHCP by default.  This may cause the system to pause for a short amount of time if there is no DHCP server on the target network.  Note that in the [pSPerformanceToolkit31#Console Console Configuration] phase a static IP can be specified.  The following shows the DHCP client getting an address:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/dhcp.png

The system will configure and start up services next.  It is normal to see some of these services fail (they will be configured in the [pSPerformanceToolkit31#Console Console] and [pSPerformanceToolkit31#Web Web] portions so they do start up properly).  The final step is to present the console to the user:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/login.png

To log in to your new system, use the _*knoppix*_ user, and a blank password:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/login-knoppix.png

The message at login describes the two main forms of [pSPerformanceToolkit31#Configuration Configuration]:

{{{
To start configuration, login as user knoppix and run 'sudo nptoolkit-configure.py'.
Once you set passwords, you can login to the web interface and finish configuration.
The web interface should be available at: https://lab246.internet2.edu/
}}}

== Configuration ==

Configuration of the pS Performance Toolkit is split into two parts:

 * [pSPerformanceToolkit31#Console Console] - Configured on the target computer
   * _*Caveat*_: The console can be reached via a serial line or tool that may redirect this over a working network connection. 
 * [pSPerformanceToolkit31#Web Web] - Can be configured remotely

In general the [pSPerformanceToolkit31#Console console] configuration contains essential options that should be reviewed and set before the system can operate as a measurement framework.  Note that certain functionality, including the basic measurement tools, will function without any configuration.  The [pSPerformanceToolkit31#Web web based] configuration steps can be performed remotely and should be used to personalize and customize the measurement experience.  

=== Console ===

At the console screen, type the following command:

{{{
sudo nptoolkit-configure.py
}}}

The following menu will appear:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/menu.png

There are 6 options that may be configured through this menu:

 * [pSPerformanceToolkit31#Storage Storage] - Configure a drive to hold measurements and customizations
 * [pSPerformanceToolkit31#Passwords Passwords] - Set the _*root*_ and _*knoppix*_ user passwords
 * [pSPerformanceToolkit31#Networking Networking] - Set networking to be _DHCP_ or _Static_
 * [pSPerformanceToolkit31#Timezone Timezone] - Set the timezone in which the host is deployed
 * [pSPerformanceToolkit31#User_Management User Management] - Add additional users to the system
 * [pSPerformanceToolkit31#Exit Exit] - After exiting the menu

The following sections detail the actions available in each section.  Note that as a menu item is addressed, they will change color.  

==== Storage ====

After choosing _*Option 1*_ from the menu, the following prompt will appear listing what drives were available on the system (experience may vary):

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/drive-1.png

At the time of configuration, the user chose the first option.  In this particular case an internal check requests that the disk have at least 10GB of capacity.  This message will appear as such:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/drive-2.png

If the drive is unformatted, or is not formatted with the ext3 filesystem, there will be an option for format the drive in question. While Linux can natively read and write many filesystems, some filesystems, specifically NTFS and Fat, do not contain support for features required by the toolkit. _*N.B.*_: formatting a hard drive will render any existing old data un-readable.  Please be sure you wish to use the target hard drive before proceeding:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/drive-3.png

The screen will display the results of the formatting step.  Note that a machine reboot is required before the system will be completely usable.  The remainder of the menu can be navigated before the reboot will be requested:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/drive-4.png

After completing this series of questions, the menu will re-appear and mark that this step has been visited:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/menu-2.png

==== Passwords ====

After choosing _*Option 2*_ from the menu, the system will prompt for 2 new passwords:

 * _*root*_ user
 * _*knoppix*_ user

Note that each time this menu option is used, both users will be promoted for.  To set the password of either user individually please see [pSPerformanceToolkit31#User_Management User Management].  The screen will look similar to this:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/pass.png
 

After completing this series of questions, the menu will re-appear and mark that this step has been visited:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/menu-3.png 

==== Networking ====

After choosing _*Option 3*_ from the menu, the following menu will appear:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/networking-1.png

Note that the particular host used in this guide was equipped with only one interface.  If there are multiple interfaces present they will show up in the menu.  To alter the DNS server, choose option 1:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/networking-2.png

In this case the DNS list may be empty, so the option to _add_ a server is all that is available.  To add a server to the list of DNS servers, choose option 1:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/networking-3.png

After this step we could _add_ another server, or delete an existing server.  We will choose to exit.  The second option allows configuration of the interfaces:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/networking-4.png

This option allows the operator to set the networking options (e.g. _*DHCP*_ vs _*Static IP*_, _*MTU*_ size).  The final option, _*Primary Interface*_, is an option that relates to _perfSONAR_ services.  Each service will _advertise_ existence in a global directory.  If for some reason the target system is dual homed, for perfSONAR to work correctly the _*externally facing*_ interface should be advertised instead of something internal.

finally, the changes must be saved:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/networking-5.png

After completing this series of questions, the menu will re-appear and mark that this step has been visited:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/menu-4.png 

==== Timezone ====

After choosing _*Option 4*_ from the menu, the following warning will appear:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/tz-1.png

If you do choose to change the timezone, the following menu will help to narrow down the choices:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/tz-2.png

Finally, the name of the specified timezone should be entered:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/tz-3.png

After completing this series of questions, the menu will re-appear and mark that this step has been visited:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/menu-5.png 

==== User Management ====

After choosing _*Option 5*_ from the menu, the following menu will appear with options:

 * Add a user
 * Delete a user
 * Change a user's password

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/user-1.png

_*Option 1*_ allows a new user to be added to the system:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/user-2.png

_*Option 2*_ will delete a user.  Note the user must be on the system first or the delete will fail:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/user-3.png

To delete the user properly:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/user-4.png

_*Option 3*_ will change the password of a user.  Note the user must be on the system first or the change will fail:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/user-5.png

To properly change the user's password:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/user-6.png

After completing this series of questions, the menu will re-appear and mark that this step has been visited:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/menu-6.png 

==== Exit ====

If the [pSPerformanceToolkit31#Storage Storage] was entered (e.g. even if a change was not requested) the system will request a reboot:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/reboot.png

The screen may appear similar to the following and the system will enter the boot phase again:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/reboot-2.png

Note that if [pSPerformanceToolkit31#Storage Storage] was not entered, you will be returned to the console.  

=== Web ===

Configuration over the web is available after the machine has come online.  First, determine the URL to go to for configuration.

In most cases, the message seen during login will contain the URL:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/getaddress.png

In some cases, the message will have a URL like _https://`[`host address`]`/_:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/getaddress-1.png

If this is the case, login and run _ifconfig_. The URL will be the IP address after _inet addr_. In the following example, the URL will be _https://192.168.69.143/_:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/getaddress-2.png

Enter this address in a web browser, and the following screen will appear:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-home.png

The menu on the left side of the screen has the following areas that can be viewed and configured, this guide will examine each:

 * User Tools
   * [pSPerformanceToolkit31#Services_On_This_Node Services On This Node]
   * [pSPerformanceToolkit31#Global_Set_Of_Services Global Set Of Services]
   * [pSPerformanceToolkit31#JOWAMP JOWAMP]
   * [pSPerformanceToolkit31#Reverse_Traceroute Reverse Traceroute]
   * [pSPerformanceToolkit31#Reverse_Ping Reverse Ping]
   * [pSPerformanceToolkit31#PingER_UI PingER UI]
 * Service Graphs
   * [pSPerformanceToolkit31#perfAdmin_BWCTL BWCTL]
   * [pSPerformanceToolkit31#perfAdmin_OWAMP OWAMP]
   * [pSPerformanceToolkit31#perfAdmin_PingER PingER]
   * [pSPerformanceToolkit31#perfAdmin_SNMP SNMP]
   * [pSPerformanceToolkit31#Cacti_Graphs Cacti Graphs]
 * Toolkit Administration
   * [pSPerformanceToolkit31#Administrative_Info Administrative Info]
   * [pSPerformanceToolkit31#BWCTL_Limits BWCTL Limits]
   * [pSPerformanceToolkit31#OWAMP_Limits OWAMP Limits]
   * [pSPerformanceToolkit31#Enabled_Services Enabled Services]
   * [pSPerformanceToolkit31#NTP NTP]
   * [pSPerformanceToolkit31#Scheduled_Testing Scheduled Testing]
     * [pSPerformanceToolkit31#Scheduled_BWCTL BWCTL]
     * [pSPerformanceToolkit31#Scheduled_PingER PingER]
     * [pSPerformanceToolkit31#Scheduled_OWAMP OWAMP]
   * [pSPerformanceToolkit31#Cacti_Administration Cacti Administration]

==== Services On This Node ====

The _*home*_ page, is linked via the _Services On This Node_ button:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-home.png

This page lists the measurement tools currently on this node as well as the versions of each piece of software.  There are 3 states for each tool:

 * _*Running*_ - The service is functioning normally
 * _*Not Running*_ - The service is stopped
 * _*Disabled*_ - The service has been disabled via the [pSPerformanceToolkit31#Enabled_Services Enabled Services] dialog.  

A service may be in the _*Not Running*_ state for a number of reasons, initially it is likely that the service has not been configured. If when examining this list a service is in this state, and the operator feels it shouldn't be, please try to restart the service and check the logs.  

==== Global Set Of Services ====

Using the _perfSONAR Lookup Service_, the pS Performance Toolkit is able to locate and display information on other perfSONAR services, world-wide.  The [pSPerformanceToolkit31#Global_Set_Of_Services Global Set Of Services] page displays the global set of perfSONAR services:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-global.png

The time when the set of services was retrieved is displayed at the top of the page. The toolkit regularly runs a script to query the global services. This information is used by the [pSPerformanceToolkit31#Global_Set_Of_Services Global Set Of Services] page as well as other pages, including [pSPerformanceToolkit31#Scheduled_Testing Scheduled Testing] page. Note that if the date seems rather old the script could be experiencing an error - please consult the logs if this is the case.  

==== JOWAMP ====

JOWAMP is a Java client of the OWAMP tool that executes an owamp test from the web browser to the server located on that particular node.  Because JOWAMP is a Java applet, it must run in the browser and may trigger several warnings.  These warnings convey information about executing code that is not _signed_ within the browser.  The warnings will look similar to this (will vary by web browser):

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-jowamp-1.png

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-jowamp-2.png

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-jowamp-3.png

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-jowamp-4.png

After accepting this warnings, the JOWAMP main screen will start:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-jowamp-5.png

Running a test between the machine with the web browser and the performance node will produce results similar to this:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-jowamp-6.png

If for some reason an error was experienced, the following items should be checked:

 * _*Firewalls*_ - Check to be sure the performance node and the system with the web browser are either un-firewalled or have setting that would allow OWAMP traffic.  See the [http://www.internet2.edu/performance/owamp/ OWAMP] page for more details.
 * _*NTP*_ - Be sure the performance node has a stable NTP numbers.  The machine with the web browser does not need NTP, but should have synchronized time.  
 * _*Browser Security*_ - Check to be sure your browser allows web applets to be executed, and that all of the warnings were agreed too in the previous steps.  

==== Reverse Traceroute ====

The [http://www.slac.stanford.edu/comp/net/ Reverse Traceroute] tool was developed at [http://www.slac.stanford.edu SLAC] and allows a user to run a traceroute from the performance node to the web browser of the initializing machine.  The GUI appears as so:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-traceroute-1.png

The results of the traceroute are displayed as they complete:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-traceroute-2.png

==== Reverse Ping ====

The [http://www.slac.stanford.edu/comp/net/ Reverse Ping] tool was developed at [http://www.slac.stanford.edu SLAC] and is similar to the [pSPerformanceToolkit31#Reverse_Traceroute Reverse Traceroute].  It allows a user to run a ping from the performance node to the web browser of the initializing machine.  The GUI appears as so:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-traceroute-3.png

==== PingER UI ====

The PingER UI is a tool designed to display and analyse data from the PingER tool:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-pinger-1.png

This GUI can be used to display the results of any PingER instance, in this case we select an instance that is different from the performance node itself:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-pinger-2.png

Graphs are displayed inline:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-pinger-3.png

==== perfAdmin BWCTL ====

_perfAdmin_ is a series of CGI scripts that display data from perfSONAR services.  Each pS Performance Toolkit contains a _perfSONAR-BUOY_ instance that is capable of making regular BWCTL tests to other hosts.  This GUI is used to show the results of these tests.  

The first capture is seen when the service does not have any information to display, or may be in the _Disabled_ or _Not Running_ state:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-pa-throughput-1.png

Once the host is collecting data, a screen similar to the following will appear:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-pa-throughput-2.png

There are three sections to the GUI:

 * _*Current Data*_ - Data that has been collected in the past week.  
 * _*Summary Graph*_ - Shows the aggregate average observed into and out of each host.  
 * _*Historical Data*_ - Data that is present in the system, but older than a week.  

Graphs can be produced for individual tests:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-pa-throughput-3.png

==== perfAdmin OWAMP ====

_perfAdmin_ is a series of CGI scripts that display data from perfSONAR services.  Each pS Performance Toolkit contains a _perfSONAR-BUOY_ instance that is capable of making regular OWAMP tests to other hosts.  This GUI is used to show the results of these tests.  

The first capture is seen when the service does not have any information to display, or may be in the _Disabled_ or _Not Running_ state:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-pa-owd-1.png

Once the host is collecting data, a screen similar to the following will appear:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-pa-owd-2.png

There are three sections to the GUI:

 * _*Current Data*_ - Data that has been collected in the past week.  
 * _*Summary Graph*_ - Shows the aggregate average observed into and out of each host.  
 * _*Historical Data*_ - Data that is present in the system, but older than a week.  

Graphs can be produced for individual tests:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-pa-owd-3.png

==== perfAdmin PingER ====

_perfAdmin_ is a series of CGI scripts that display data from perfSONAR services.  Each pS Performance Toolkit contains a _PingER_ instance that is capable of making regular Ping tests to other hosts.  This GUI is used to show the results of these tests.  

The first capture is seen when the service does not have any information to display, or may be in the _Disabled_ or _Not Running_ state:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-pa-pinger-1.png

Once the host is collecting data, a screen similar to the following will appear:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-pa-pinger-2.png  

Graphs can be produced for individual tests:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-pa-pinger-3.png

==== perfAdmin SNMP ====

_perfAdmin_ is a series of CGI scripts that display data from perfSONAR services.  Each pS Performance Toolkit contains a _Cacti_ instance that is capable of collecting regular SNMP tests and exposing these via the _SNMP MA_.  This GUI is used to show the results of these tests.  

The first capture is seen when the service does not have any information to display, or may be in the _Disabled_ or _Not Running_ state:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-pa-snmp-1.png

Once the host is collecting data (after going through the [pSPerformanceToolkit31#Cacti_Administration Cacti Administration] step), a screen similar to the following will appear:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-pa-snmp-2.png

Graphs can be produced for individual tests:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-pa-snmp-3.png

==== Cacti Graphs ====

Cacti is used to poll SNMP on network devices, this particular interface to Cacti is _read-only_, and can be used to show cacti graphs to un-authenticated users:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-cacti-1.png

[pSPerformanceToolkit31#Cacti_Administration Cacti Administration] describes how to configure Cacti.  

==== Administrative Info ====

This section requires authentication, the following box may appear before you may access any of the functionality:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-auth.png

Authenticate with the _*knoppix*_ user or any other user that has _administrative_ privileges on this system (See [pSPerformanceToolkit31#User_Management User Management] for more information).  

The _administration_ screen will appear like this the first time:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-admin-1.png

Upon clicking _edit_, the following dialog will appear:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-admin-2.png

The information will appear in the web form after entry:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-admin-3.png

Clicking on the communities will add them to your configuration:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-admin-4.png

Clicking _Add New Community_ will display a dialog box:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-admin-5.png

Adding new communities can be done in this manner:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-admin-6.png

Lastly, hit _save_ to be sure your changes are saved.  

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-admin-7.png

Note that if you choose to leave this page before saving the following warning may appear (depending on the web browser used):

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/non-save.png

===== Communities =====

A community identification is a self organizing way to form affiliations within the perfSONAR world.  For instance, if a perfSONAR service if associated with a specific scientific project (e.g. LHC, eVLBI), or has access to a certain network (Internet2, NLR, ESnet), these values can be entered as "community" values and exported into the perfSONAR Information Services.  Participating in this procedure allows others in your community an easy way to identify specific instances throughout the world as being affiliated.  Adding a community value or values is recommended, but not required.  

Selecting which _*communities*_ to identify this installation can be confusing to answer for new users.  This particular question is trying to associate some _loosely coupled_ labels to the data that the pS Performance Toolkit disk will be making available to the larger world.  Think of this step similar to assigning labels to photos or music (e.g. a photo of a dog might have labels: _Dog_, _Rover_, etc. but someone else may choose different labels).  In general there is no _wrong way_ to choose a keyword.  Choose keywords that best describe the circumstances that surround this installation.  

Some examples of valid answers are:

 * *Internet2* - The data made available somehow connects the Internet2 backbone
 * *LHC* (*CMS*, *ATLAS*, etc.) - The disk is part of the LHC deployment structure
 * *eVLBI* - The disk is a part of the larger telescope community
 * *MAX* - A connector of member of the MAX gigapop

We would recommend choosing keywords that:

 * Describe the location/installation (e.g. the name of the organization installing): *MCNC*, *UDel*
 * Network connections: *ESnet*, *GEANT*, *Internet2*, *NLR*, *RNP*
 * Virtual Organizations (VOs): *CMS*, *ATLAS*

Use as many community names as necessary to properly categorize the data from the installation.

==== BWCTL Limits ====

This section requires authentication, the following box may appear before you may access any of the functionality:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-auth.png

Authenticate with the _*knoppix*_ user or any other user that has _administrative_ privileges on this system (See [pSPerformanceToolkit31#User_Management User Management] for more information).  

The _BWCTL Limits_ screen allows the operator to set limits on the resources that the BWCTL tool may consume on the target system.  For instance:

 * Protocols allowed: Whether the users can perform TCP or UDP bandwidth tests.
 * Test duration: The maximum duration of that a user can request for a bandwidth test.
 * UDP bandwidth allowed: The maximum bandwidth a user can request for a UDP bandwidth test.

The screen defaults to these settings:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-bwctllimits-1.png

Clicking an _edit_ link brings up a dialog:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-bwctllimits-2.png

The changes to the settings can be seen after closing the dialog:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-bwctllimits-3.png

Users and networks can be added in a similar manner.  

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-bwctllimits-4.png

When done, press the _save_ button to commit your changes to disk, and restart the affected services.  Note that if you choose to leave this page before saving the following warning may appear (depending on the web browser used):

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/non-save.png

==== OWAMP Limits ====

This section requires authentication, the following box may appear before you may access any of the functionality:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-auth.png

Authenticate with the _*knoppix*_ user or any other user that has _administrative_ privileges on this system (See [pSPerformanceToolkit31#User_Management User Management] for more information).  

The _OWAMP Limits_ screen allows the operator to set limits on the resources that the OWAMP tool may consume on the target system.  For instance:

 * Bandwidth allowed: The amount of network bandwidth that users can request for their OWAMP tests.
 * Disk usage: OWAMP tests record information about all packets received which are stored on disk. The disk usage allows administrators to configure the amount of disk space that users can request for their OWAMP tests. 
 * Saving vs deleting test results: The OWAMP records stored on disk can be deleted when they are fetched or stored for later retrieval. Administrators can configure when the test results are deleted.

The screen defaults to these settings:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-owamplimits-1.png

Clicking an _edit_ link brings up a dialog:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-owamplimits-2.png

Users and networks can be added in a similar manner. 

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-owamplimits-3.png

When done, press the _save_ button to commit your changes to disk, and restart the affected services.  Note that if you choose to leave this page before saving the following warning may appear (depending on the web browser used):

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/non-save.png

==== Enabled Services ====

This section requires authentication, the following box may appear before you may access any of the functionality:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-auth.png

Authenticate with the _*knoppix*_ user or any other user that has _administrative_ privileges on this system (See [pSPerformanceToolkit31#User_Management User Management] for more information).  

The _enabled services_ screen lists the services that will start and stop when the machine does.  The screen looks similar to this:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-enabled.png

A breakdown of each service:

 * _*SSH*_ - Allows administrators to remotely connect to this host using SSH
 * _*NDT*_ - Allows clients at other sites to run NDT tests to this host.
 * _*NPAD*_ - Allows clients at other sites to run NPAD tests to this host.
 * _*BWCTL*_ - Allows clients at other sites to run Throughput tests to this host
 * _*OWAMP*_ - Allows clients at other sites to run One-Way Latency tests to this host
 * _*PingER*_ - Enables this host to perform scheduled ping tests. These tests will periodically ping configured hosts giving administrators a view of the latency from their site over time.
 * _*perfSONAR-BUOY Measurement Archive*_ - Makes available the data collected by the perfSONAR-BUOY Latency and Throughput tests.
 * _*perfSONAR-BUOY Throughput Testing*_	Enables this host to perform scheduled throughput tests. These tests will run periodically giving administrators a view of the throughput to and from their site over time.  _*N.B.*_: Enabling this will disable _*OWAMP*_, _*PingER*_ and _*perfSONAR-BUOY Latency Testing*_.
 * _*perfSONAR-BUOY Latency Testing*_	Enables this host to perform scheduled one-way latency tests. These tests will run periodically giving administrators a view of the latency from their site over time.  _*N.B.*_: Enabling this will disable _*perfSONAR-BUOY Throughput Testing*_, _*BWCTL*_, _*NDT*_, and _*NPAD*_. 

To ease the decision process of selecting the _appropriate_ services for a given deployment (e.g. deploying only _bandwidth-centric_ services) there are two buttons at the bottom of the page:

 * _*Only Enable Bandwidth Services*_ - Turns on bandwidth testing applications, and turns off other services
 * _*Only Enable Latency Services*_ - Turns on latency testing applications, and turns off other services

After selecting which services to enable, press _save_ to save the changes:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-enabled-save.png

Note that if you choose to leave this page before saving the following warning may appear (depending on the web browser used):

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/non-save.png

==== NTP ====

This section requires authentication, the following box may appear before you may access any of the functionality:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-auth.png

Authenticate with the _*knoppix*_ user or any other user that has _administrative_ privileges on this system (See [pSPerformanceToolkit31#User_Management User Management] for more information).  

[http://www.ntp.org/ NTP] is a protocol for keeping accurate time on networked machines.  NTP access is very important to measurement tools (e.g. OWAMP and BWCTL) and the pS Performance Toolkit will require a working NTP configuration to use these tools.  NTP configuration should consist of:

 * 4-5 Servers (for redudency and to help the NTP algorithms make _good_ choices)
 * Of a similar _stratum_ (e.g. all Stratum 1, or all Stratum 2)
 * Geographically _close_ (within the same timezone is a safe assumption)
 * On divergent network paths (prevents problems with failed network paths or asymetric congestion)

The following screen shows a default NTP configuration:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-ntp-1.png

The following NTP clocks have been identified as being valuable to use:

 * United States - Eastern Timezone
   * chronos.es.net	ESnet - New York, NY USA
   * owamp.atla.net.internet2.edu	Internet2 - Atlanta, GA USA
   * owamp.newy.net.internet2.edu	Internet2 - New York, NY USA
   * time-a.nist.gov	NIST - Gaithersburg, MD USA
   * navobs1.oar.net	Naval Observatory - Columbus, OH USA
   * ntp0.usno.navy.mil	Naval Observatory - Washington, DC USA
 * United States - Central Timezone
   * owamp.chic.net.internet2.edu	Internet2 - Chicago, IL USA
   * owamp.hous.net.internet2.edu	Internet2 - Houston, TX USA
 * United States - Mountain Timezone	 	 	 	 	 	 	 
   * owamp.salt.net.internet2.edu	Internet2 - Salt Lake City, UT USA	 	 	 	 	 	 	 
   * tick.usnogps.navy.mil	Naval Observatory - Colorado Springs, CO USA
 * United States - Pacific Timezone	 	 	 	 	 	 	 	 
   * saturn.es.net	ESnet - Sunnyvale, CA USA
   * owamp.losa.net.internet2.edu	Internet2 - Los Angeles, CA USA
   * ntp-ucla.usno.navy.mil	Naval Observatory - Los Angeles, CA USA
   * ntp-uw.usno.navy.mil	Naval Observatory - Seattle, WA USA
 * United States - Alaskan Timezone
   * ntp-ua.usno.navy.mil	Naval Observatory - Fairbanks, AK USA
 * United States - Hawaiian Timezone
   * tick.mhpcc.hpc.mil	Maui HPC Center - Maui, HI USA
 * South America (Brazil)
   * a.ntp.monipe.rnp.br	RNP Time Server #1 - Brazil
   * b.ntp.monipe.rnp.br	RNP Time Server #2 - Brazil
   * c.ntp.monipe.rnp.br	RNP Time Server #3 - Brazil
   * d.ntp.monipe.rnp.br	RNP Time Server #4 - Brazil
   * e.ntp.monipe.rnp.br	RNP Time Server #5 - Brazil

_*N.B.*_: Routing has a large impact on if an NTP time source is _reachable_ and _close_ from your particular instance.  It is recommended that the _Select Closest Servers_ option be used:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-ntp-2.png

After running the closest servers will be selected, and servers that were unreachable will be marked in red:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-ntp-3.png

When done, press the _save_ button to commit your changes to disk, and restart the affected services.  Note that if you choose to leave this page before saving the following warning may appear (depending on the web browser used):

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/non-save.png

==== Scheduled Testing ====

This section requires authentication, the following box may appear before you may access any of the functionality:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-auth.png

Authenticate with the _*knoppix*_ user or any other user that has _administrative_ privileges on this system (See [pSPerformanceToolkit31#User_Management User Management] for more information).  

The _Scheduled Testing_ screen allows the user to schedule several types of regular test:

 * [pSPerformanceToolkit31#Scheduled_BWCTL BWCTL] - Bandwidth Testing
 * [pSPerformanceToolkit31#Scheduled_PingER PingER] - Two-way Latency Testing
 * [pSPerformanceToolkit31#Scheduled_OWAMP OWAMP] - One-way Latency Testing

The screen will look similar to this initially:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-scheduled-1.png

The following sections detail setting up tests for each of these measurement types.

===== Scheduled BWCTL =====

Upon adding a BWCTL test via the _Add New Throughput Test_ button, the following dialog will appear:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-scheduled-bwctl-1.png

Enter the following information:

 * _*Description*_ - Enter a name for this test, e.g. _10 Second BWCTL Tests, every 4 Hours_.  _*N.B.*_ that this will be used to reference the test on the GUI.  
 * _*Time Between Tests*_ - How often to run the BWCTL tests.  _*N.B.*_ that this number, along with _Test Duration_, will dictate how _busy_ the system, and the local network will be.  
 * _*Test Duration*_ - How long of a BWCTL test to run.  The general rule of thumb is that if the round-trip times to all hosts being tested to are less than 50ms, the test duration should be at least 10 seconds. If the round-trip times to all hosts being tested to are less than 100ms, the test duration should be at least 20 seconds. If the round-trip times for any host being tested to is more than 100ms, the test duration should be at least 30 seconds. _*N.B.*_ that this number, along with _Time Between Tests_, will dictate how _busy_ the system, and the local network will be.  
 * _*Tester*_ - Currently only _iperf_ is allowed here. 
 * _*Protocol*_ - TCP or UDP testing.  
 * _*Use Auto-tuning*_ - Allow the linux kernel to tune the buffers or set your own buffer sizes.

After entering these values, the test is saved, but it does not have test hosts (yet):

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-scheduled-bwctl-2.png

Adding test hosts can be done by [pSPerformanceToolkit31#Communities community], or _manually_.  If a community is clicked from the list, the following dialog will appear:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-scheduled-bwctl-3.png

A host can be selected from this list to add to the test:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-scheduled-bwctl-4.png

Once selected the host will show up in the testing dialog.  

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-scheduled-bwctl-5.png

When done, press the _save_ button to commit your changes to disk, and restart the affected services.  Note that if you choose to leave this page before saving the following warning may appear (depending on the web browser used):

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/non-save.png

===== Scheduled PingER =====

PingER functions in a similar manner to [pSPerformanceToolkit31#Scheduled_BWCTL BWCTL].  Upon adding a PingER test via the _Add New Ping Test_ button, the following dialog may appear appear if the system is already configured to test with BWCTL (this will not appear if a BWCTL test was not scheduled):

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-scheduled-pinger-1.png

Enter the following information when the dialog appears:

 * _*Description*_ - Enter a name for this test, e.g. _10 Packet PingER Tests, every 1 Hour_.  _*N.B.*_ that this will be used to reference the test on the GUI.  
 * _*Time Between Tests*_ - How often to run the tests.
 * _*Packets Sent Per Test*_ - How many Ping Packets per test.  Note that sending more will increase the total length of a test.
 * _*Time Between Packets*_ - The interval between Ping Packets.  Setting this higher will increase the total length of a test
 * _*Size Of Test Packets*_ - How large of a Ping packet to use in testing.  

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-scheduled-pinger-2.png

After entering these values, the test is saved, but it does not have test hosts (yet):

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-scheduled-pinger-3.png

Adding test hosts can be done by [pSPerformanceToolkit31#Communities community], or _manually_.  If a community is clicked from the list, the following dialog will appear:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-scheduled-pinger-4.png

A host can be selected from this list to add to the test.  Once selected the host will show up in the testing dialog. 

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-scheduled-pinger-5.png

When done, press the _save_ button to commit your changes to disk, and restart the affected services.  Note that if you choose to leave this page before saving the following warning may appear (depending on the web browser used):

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/non-save.png

===== Scheduled OWAMP =====

OWAMP functions in a similar manner to [pSPerformanceToolkit31#Scheduled_BWCTL BWCTL].  Upon adding a OWAMP test via the _Add New One-Way Delay Test_ button, the following dialog may appear appear if the system is already configured to test with BWCTL (this will not appear if a BWCTL test was not scheduled):

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-scheduled-owamp-1.png

Unlike PingER and BWCTL tests, OWAMP tests run constantly. Enter the following information when the dialog appears:

 * _*Description*_ - Enter a name for this test, e.g. _25 PPS OWAMP Test_.  _*N.B.*_ that this will be used to reference the test on the GUI.  
 * _*Packet Rate*_ - How many packets per second to send.  
 * _*Packet Size*_ - Size of each packet
 
http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-scheduled-owamp-2.png

After entering these values, the test is saved, but it does not have test hosts (yet):

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-scheduled-owamp-3.png

Adding test hosts can be done by [pSPerformanceToolkit31#Communities community], or _manually_.  If a community is clicked from the list, the following dialog will appear:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-scheduled-owamp-4.png

A host can be selected from this list to add to the test.  Once selected the host will show up in the testing dialog. 

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-scheduled-owamp-5.png

Manually adding a host is also possible, simply fill in the fields with the name and port of a host to test against:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-scheduled-owamp-6.png

After completing, the host will show up in the testing dialog. 

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-scheduled-owamp-7.png

When done, press the _save_ button to commit your changes to disk, and restart the affected services.  Note that if you choose to leave this page before saving the following warning may appear (depending on the web browser used):

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/non-save.png

==== Cacti Administration ====

This section requires authentication, the following box may appear before you may access any of the functionality:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/web-auth.png

Authenticate with the _*knoppix*_ user or any other user that has _administrative_ privileges on this system (See [pSPerformanceToolkit31#User_Management User Management] for more information).  

The following steps will explain the basic setup of Cacti (e.g. to poll a network device).  A user wishing to do more with the software should consult the documentation.  

===== Cacti Config Step 1 =====

Visit the Cacti instance:

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/Cacti_1.png

===== Cacti Config Step 2 =====

After logging in you will see the _home_ screen.  In the middle there
will be an option to *Create devices*.  This is where we will begin.

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/Cacti_2.png

===== Cacti Config Step 3 =====

The next screen shows the currently known devices.  The basic setup will
*always* include _localhost_.  The example below shows a previously
configured switch.  On the right side there is an *Add* _button_ (although
it doesn't appear to be so).  Click this to add a new device.

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/Cacti_3.png

===== Cacti Config Step 4 =====

The next screen features many places to add information about your new
network device.  Note that the red circles are representative of the most
common places to make changes.  When you are finished press *Create*.

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/Cacti_4.png
http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/Cacti_5.png

===== Cacti Config Step 5 =====

By default Cacti will only poll the *System* information of the SNMP enabled
host at this stage, just to see if it is alive.  To poll information such
as network statistics it is necessary to create *Graphs*.  We will proceed
by clicking on *Create graphs for this Host*.

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/Cacti_6.png

===== Cacti Config Step 6 =====

The next screen displays the possible interfaces that are available for 
data display.  Note that this may be a *large* number.  In general it is
efficient to simply click the *all* checkbox at the top unless there are 
certain interfaces you wish you only poll or perhaps leave out.  After
checking this, scroll to the bottom.

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/Cacti_7.png

===== Cacti Config Step 7 =====

At the bottom of the page is a drop down for the *format* of the data.  It is
common to use the 64 bit counters (especially for backbone networks) and 
display the information as bytes as shown here.  Other options are of course
available.  When done click *Create*.

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/Cacti_8.png

===== Cacti Config Step 8 =====

The resulting page should show the success or failure of each interface.  At
this point the following actions have happened:

 * RRD Files have been created for the interfaces in question
 * A Poller has been notified that these are values of interest (polling will occur by default every 5 minutes) 
 * Graph templates have been established
 
We now can organize this *set* into a graph tree for later display.  Select
*Graph Trees* on the left hand side.  

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/Cacti_9.png

===== Cacti Config Step 9 =====

Select *Default Tree*.  It is also possible to create your own tree at this
stage if desired.

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/Cacti_10.png

===== Cacti Config Step 10 =====

As in _Step 3_ there is another *Add* button to click because we wish to add
a new host to the tree.

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/Cacti_11.png

===== Cacti Config Step 11 =====

Select *Host* from the drop down.  This will automatically populate the
next drop down with the network device you have set up.  When you are
set click *Create*.

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/Cacti_12.png

===== Cacti Config Step 12 =====

The next menu shows that the device has been added.  To see the graphs
click on *Graphs* on the top.

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/Cacti_13.png


===== Cacti Config Step 13 =====

By default you can view the _localhost_ statistics, but below this the new
network device is present.

http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/Cacti_14.png
http://perfsonar-ps.googlecode.com/svn/wiki/pSPerformanceToolkit31/Cacti_15.png

== Known Bugs ==

TBD

== FAQ ==

 * *Q: How do I run the NPAD system?*
 * *A:* The [http://www.psc.edu/networking/projects/pathdiag/ NPAD] (Network Path and Application Diagnosis) is a client/server program developed by the network research group at Pittsburgh Supercomputer Center ([http://www.psc.edu PSC]). At boot time, the NPToolkit starts the NPAD server process and leaves it listening on TCP port *8200*. To use this server, a user starts a Java-enabled web browser and points it at the NPToolkit server (http://HOST:8200). The server automatically downloads a Java applet to the client. Then the user runs a test to begin the diagnostic process. Once the test has been completed, the server displays a results page on the clients browser. The user may examine these results and follow the recommendations to resolve problems. If the user is unable to repair a reported problem, the results page URL can be emailed to the appropriate system administrator or NOC operator.  The server retains a complete record of the test results and the raw data used to derive these results. This allows post-processing of interesting results to determine what went wrong and to improve the reporting capabilities of the NPAD server.

 * *Q: How do I use BWCTL?*
 * *A:* [http://e2epi.internet2.edu/bwctl/ BWCTL] (Bandwidth Test Controller) is a client/server program developed to simplify [http://www.dast.nlanr.net/Projects/Iperf Iperf], [http://sourceforge.net/projects/thrulay thrulay], and [http://www.wcisd.hpc.mil/nuttcp nuttcp] testing between hosts. At boot time, the NPTookit starts a BWCTL server process and leaves it listening on TCP port *4823*. This server may then be accessed by remote BWCTL clients.  Additionally, the disk contains BWCTL client applications that can be used to test to remote instances.  The BWCTL server allows TCP tests with a maximum duration of *60* seconds. To run a test to a remote BWCTL server:
   # Logon to the NPToolkit server using the *_knoppix_* or other valid userid
   # Identify the remote server
   # Run _bwctl -s remote-bwctl-server_ command to stream data for 10 seconds from the locally instance to the remote BWCTL server. Results are displayed on our console or terminal window.

 * *Q: How do I run the NDT system?*
 * *A:* The [http://e2epi.internet2.edu/ndt/ NDT] (Network Diagnostic Tool) is a client/server program developed to simplify testing to desktop/laptop computers. At boot time, the NPToolkit starts a pair of NDT server processes and leaves them listening on TCP ports *7123* and *3001*. To use this server, a client starts a Java-enabled web browser and points it at the NPToolkit server (http://HOST:7123). The server automatically downloads a Java applet to the client. The end-user can run a test to begin the diagnostic process.  Once the test has been completed, the server displays a results page on the clients browser. The end-user may examine these results and follow the recommendations to resolve problems. If the end-user is unable to repair a reported problem, the user may click the _Report Problems_ button to generate an email that will be addressed to the appropriate NPToolkit administrator.  The server retains a record of the test results to allow the post-processing of interesting results to determine what went wrong and to improve the reporting capabilities of the NDT server.

 * *Q: What is NTP?*
 * *A:* [http://www.ntp.org NTP] (Network Time Protocol) is a program that synchronizes a computers clock to a global time source. An accurate clock is essential for running many of the measurement tests including [http://e2epi.internet2.edu/bwctl/ BWCTL] and [http://e2epi.internet2.edu/owamp/ OWAMP]. The NTP daemon must connect to several, at least four (4), remote time servers to obtain accurately set the local clock. By default the NPToolkit server will synchronize to both Internet2 and public time sources.  See [NPToolkitQuickStart#Step_7 Step 7 - NTP] for information regarding changing the default time sources.

 * *Q: How do I use OWAMP?*
 * *A:* [http://e2epi.internet2.edu/owamp/ OWAMP] (One-Way Ping) is a client server program that was developed to provide delay and jitter measurements between two target computers. At boot time, the NPToolkit starts an OWAMP server process and leaves it listening on TCP port *861*. This server may then be used by remote clients.  Additionally, the disk contains OWAMP client applications that can be used to test to remote instances (including a Java client and a console based application).  By default, the OWAMP server sends a low-level data stream in each direction and measures the one-way delay and jitter between the two hosts. Separate measurements, one for each direction, are reported to the user at the end of the test.
   * To run a test to a remote OWAMP server:
     # Logon to the NPToolkit server using the *_knoppix_* or other valid userid.
     # Identify the remote server.
     # Run the _owping remote-owamp-server_ command to make a pair of 10 second delay measurements (one in each direction) between remote OWAMP server and the local instance. Results are displayed on the console or terminal window.

 * *Q: Where can I ask questions or report bugs?*
 * *A:* 
   * For questions, email to performance-node-users _at_ internet2 _dot_ edu.  You may also join the mailing list by visiting https://mail.internet2.edu/wws/subrequest/performance-node-users
   * For bugs, report at http://code.google.com/p/perfsonar-ps/issues/list . Label the bug as _*Component-NPToolkit*_, or state in the bug description the issue involves the NPToolkit.

 * *Q: Can I Use a Firewall? *
 * *A:* 
   * Yes.  To enable, first add all the desired rules to the firewall then run the command "/etc/init.d/iptables save". The firewall should then automatically come up on the next boot.  Note that there are some caveats to enabling a firewall, namely the amount of holes that must exist for the measurement tools included on the disk:  
     * SNMP MA
       * open port tcp/8065
     * PingER
       * open port tcp/8075
     * perfSONAR-BUOY
       * open port tcp/8085
       * open port tcp/8569
       * open port tcp/8570
     * Lookup Service
       * open port tcp/8095
     * BWCTL
       * open port tcp/4823
       * Edit /usr/local/etc/bwctld.conf, set *peer_port* to a value, open the tcp port for that value
       * Edit /usr/local/etc/bwctld.conf, set *iperf_port*, *thrulay_port* and *nuttcp_port* to a specific range, and open the tcp/udp ports for those ranges. 
     * OWAMP
       * open port tcp/861
       * Edit /usr/local/etc/owampd.conf, set *testports* to range, open the udp ports for that range
     * NDT
       * open port tcp/3001
       * open port tcp/3002
       * open port tcp/3003
       * open port tcp/7123
     * NPAD
       * open port tcp/8100
       * open port tcp/8200
     * Apache HTTP Server
       * open port tcp/80
       * open port tcp/443
     * SSH
       * open port tcp/22
     * NTP 
       * open port udp/123
       
 * *Q: How many ports will BWCTL need to operate effectively behind a firewall?*
 * *A:* 
   * BWCTL has several settings defined in the _*bwctld.conf*_ file that dictate which ports it may use for testing.  It is recommended that several ports be specified to allow for multiple test opportunities for the BWCTL scheduler, otherwise tests will not be completed in a timely fashion.  It is also important not to overlap these ports to prevent contention from the tools.  The configuration options are:
     * _*iperf_port*_ - Port range (e.g. 5001-5005) to run the iperf _receiver_.
     * _*nuttcp_port*_ - Port range (e.g. 5006-5010) to run the nuttcp _receiver_.
     * _*thrulay_port*_ - Port range (e.g. 5011-5015) to run the thurlay _receiver_.
     * _*peer_port*_ - Port range (e.g. 10100-10200) to run the _server_ processes of the above tests.  
   * Note that some simple calculations can be used to determine how many ports are expected for a _*full*_ schedule of tests.  For example in assuming a completely packed schedule of 10 second long tests, there are a maximum of 6 tests per minute available. BWCTL cycles through the port range one-by-one, assigning each scheduled test the next open port in line. The iperf/nuttcp/thrulay applications may leave sockets open for a while after the test has finished. If a test tries to use the same port as was used by a previous test, and that test's socket is still open, the newer test will fail. By default, Linux allows these sockets to stay open for up to a minute. So, to ensure that no tests fail, for 6 tests, the minimum number of ports to make this work would be 7. However, due to environmental factors, it is best to use a number higher than this. Since port ranges are reasonably easy to open, it is recommended that the final number use double the range: 14 ports.

 * *Q: I'd like to PXE boot the NPToolkit. Is that possible?*
 * *A:* Not currently, but this is a consideration of future releases.

 * *Q: When I boot, it gives me the following error _Can't find knoppix file system, sorry. Dropping you to a very limited shell ...._*
 * *A:* This can be attributed to a bad CD burn or a bad ISO image. Check the MD5 sum of the ISO and match this to the posted MD5 value.

 * *Q: What should I enter for the _Communities of interest_ configuration question?*
 * *A:* 
   * This question can be confusing to answer for new users.  The goal is to associate some _loosely coupled_ labels to the data that the perfSONAR NPToolkit disk will be making available to the larger world.  Think of this step similar to assigning labels to photos or music.  Some examples of valid answers are:
     * *Internet2* - The data made available somehow connects the Internet2 backbone
     * *LHC* (*CMS*, *ATLAS*, etc.)  The system is part of the LHC perfSONAR instracture.
       * The USATLAS community has requested that peer sites use the following as the Communities of Interest string:  _*LHC USATLAS*_     
     * *eVLBI* - The disk is a part of the larger telescope community
     * *MAX* - A connector of member of the MAX gigapop
     * *DOE-SC-LAB* - US Department of Energy Office of Science Labs 
   * Use as many community names as necessary to properly categorize the data from the installation. 

 * *Q:* Does my machine have to meet the [pSPerformanceToolkit31#System_Requirements System Requirements]?
 * *A:* There is nothing on the pSPT that will prevent systems that do not meet the requirements from starting.  Erroneous or inaccurate behavior is possible if the hardware cannot support the measurement tools.

 * *Q:* The colors on my [pSPerformanceToolkit31#Console Console Configuration] do not match what I see on the web.  Some are green already.
 * *A:* If you are upgrading from a previous version of the pSPT, the colors may be green already because a particular aspect was configured previously.  These do not need to be configured again.
 
 * *Q:* The [pSPerformanceToolkit31#Services_On_This_Node Services On This Node] screen shows many services in the non-running state when first started, what is wrong?
 * *A:* Many of the services will be in this state because they are missing some key configuration items (e.g. from the [pSPerformanceToolkit31#Administrative_Info Administrative Info]).  After following the configuration steps check this screen again, most should be functional.
 
 * *Q:* I do not see my service in the [pSPerformanceToolkit31#Global_Set_Of_Services Global Set Of Services], where is it?
 * *A:* Much like DNS, the information that will populate the Global Lookup Service will take time to propagate.  Please allow some time (e.g. a few hours) before your service will be fully visible.
 
 * *Q:* When looking at the data display for [pSPerformanceToolkit31#perfAdmin_BWCTL perfAdmin BWCTL]/[pSPerformanceToolkit31#perfAdmin_OWAMP perfAdmin OWAMP] I do not see results, but I filled out information in the [pSPerformanceToolkit31#Scheduled_Testing Scheduled Testing] area.  Where is my data?
 * *A:* Data may take several minutes to show up in this area, possible causes:
   * A Test has not run yet (e.g. a 4 hour testing interval may not produce tests for 4 hours.
   * The testing data may not be available in the database yet.  A test may complete, but may take several minutes to be stored in the database, and therefore become available to the GUI
 
 * *Q:* I do not think I am a member of a [pSPerformanceToolkit31#Communities community], should I put anyting?  
 * *A:* Communities are not required, but they allow other individuals and organizations to find and use your services. It is a good practice to join as many as you may think are applicable.
 
 * *Q:* What is the purpose of [pSPerformanceToolkit31#BWCTL_Limits BWCTL Limits]/[pSPerformanceToolkit31#OWAMP_Limits OWAMP Limits]?
 * *A:* These allow you to limit the influence that outside users have on your system performance.  For example, to prevent your machine/network from being saturated with  BWCTL tests, limit the duration and maximum bandwidth available.  These screens allow a fine grained way to protect resources.

 * *Q:* How many [pSPerformanceToolkit31#NTP NTP] servers do I need, can I select them all?
 * *A:* It is recommended that 4-5 _close_ and _active_ servers be used.  The _Select Closest Servers_ button will help with this decision.  Note that some servers may not be available due to routing (e.g. non-R&E networks vs R&E networks - a common problem for Internet2 and ESnet servers).
 
 * *Q:* When clicking on GUI links the following error is seen:
{{{
Software error: 

Cannot write to '/var/log/perfSONAR/Web_Admin.log': No space left on device at /usr/local/share/perl/5.8.8/Log/Dispatch/File.pm line 134.
For help, please send mail to the webmaster (webmaster@localhost), giving this error message and the time and date of the error.
}}} 
 * *A:*
   * The Disk may be full.  Try the following command to confirm:
{{{
[knoppix@lab246 ~]$ df -h
Filesystem            Size  Used Avail Use% Mounted on
tmpfs                1009M     0 1009M   0% /UNIONFS/lib/init/rw
udev                   10M   64K   10M   1% /dev
tmpfs                1009M     0 1009M   0% /dev/shm
rootfs                3.4M   23K  3.4M   1% /
/dev/hda              587M  587M     0 100% /cdrom
/dev/cloop            1.6G  1.6G     0 100% /KNOPPIX
/ramdisk              404M   65M  339M  17% /ramdisk
/UNIONFS              248M   11M  226M   5% /UNIONFS
/dev/shm             1009M     0 1009M   0% /dev/shm
/dev/mapper/VolGroup00-LogVol00
                      145G   97G   42G  70% /mnt/store
/mnt/store/NPTools/scratch
                      248M   11M  226M   5% /scratch
}}}
   * The important mount point is _/mnt/store_, it this has reached _100%_, the drive is full.  Try removing unnecessary log files from _/usr/local/web/root/admin/log_ first, then remove older logs from the directories in _/var/log_

 * *Q:* PingER displays several sets of duplicate results via the GUI, some of which have _No Data_.
 * *A:* PingER stores the results of all tests ever performed.  To clean out the pinger test sets run the following command:
{{{
sudo /usr/local/bin/reset_pinger.sh
}}}

 * *Q:* The Sun Java environment was on previous versions of the pSPT, has it been removed?
 * *A:* 
   * Java (e.g. the JRE, JDK, and associated browser plugins) have been removed from the pSPT due to license concerns.  Instructions for installing the Java JRE and Plugin (for web browsers on the pSPT):
{{{
[knoppix@Knoppix ~]$ sudo apt-get install sun-java5-jre sun-java5-plugin
}}}
   * The following will appear, noting that other items may need to be installed:
{{{
Reading package lists... Done
Building dependency tree... Done
The following extra packages will be installed:
  sun-java5-bin
Suggested packages:
  libnss-mdns sun-java5-fonts ttf-baekmuk ttf-unfonts ttf-unfonts-core
  ttf-kochi-gothic ttf-sazanami-gothic ttf-kochi-mincho ttf-sazanami-mincho
  ttf-arphic-uming
The following NEW packages will be installed:
  sun-java5-bin sun-java5-jre sun-java5-plugin
0 upgraded, 3 newly installed, 0 to remove and 0 not upgraded.
Need to get 29.9MB of archives.
After unpacking 82.8MB of additional disk space will be used.
Do you want to continue [Y/n]?
}}}
   * After saying yes, the packages will download:
{{{
Get:1 http://http.us.debian.org etch/non-free sun-java5-bin 1.5.0-14-1etch1 [22.4MB]
Get:2 http://http.us.debian.org etch/non-free sun-java5-jre 1.5.0-14-1etch1 [7465kB]
Get:3 http://http.us.debian.org etch/non-free sun-java5-plugin 1.5.0-14-1etch1 [1684B]
Fetched 29.9MB in 1m27s (340kB/s)
Preconfiguring packages ...
Selecting previously deselected package sun-java5-bin.
(Reading database ... 68831 files and directories currently installed.)
Unpacking sun-java5-bin (from .../sun-java5-bin_1.5.0-14-1etch1_i386.deb) ...
}}}
   * A license agreement will appear, you may choose to either agree to this or disagree.  Disagreement will halt installation.  After agreeing the installation will proceed.  More information is available [http://wiki.debian.org/Java | here].

 * *Q:* 
 * *A:* 

== Last Updated ==

$Id$
