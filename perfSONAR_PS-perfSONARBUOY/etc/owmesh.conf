# owmesh.conf - Configuration file for scheduled test component of perfSONAR-BUOY
# $Id$

	# Not likely to change... Probably should move to DEFS in OWP::Conf.pm
BWSessionSuffix	.recv.bw
DevNull			/dev/null
	# SummarySuffix is cat'd onto SessionSuffix
SummarySuffix		.sum

#################
#
# POSSIBLE CHANGE
#
#################
    # binary/location information.  Use this to specify if not found in $PATH
BWCmd			bwctl
BWBinDir		/usr/bin

#################
#
# POSSIBLE CHANGE
#
#################
	# These dirs MUST be in the same filesystem!
BWDataDir           /var/lib/perfsonarbuoy_ma/bwctl
BWCentralDataDir	/var/lib/perfsonarbuoy_ma/bwctl/upload
BWCentralArchDir	/var/lib/perfsonarbuoy_ma/bwctl/archive

	# Global in nature...shouldn't change
ConfigVersion		20080715.0
SecretNames		15Jul2008 FallBack
SecretName		15Jul2008
15Jul2008		AFestivusForTheRestOfUs
FallBack		TingsBeBerryBerryBadMon

    # Logging info
!Debug
!Verbose
SyslogFacility		local5

    # user:group info
UserName		perfsonar
GroupName		perfsonar

	# If set, only allow contact from CONTACTADDR's defined for each node
!VerifyPeerAddr
!BWVerifyPeerAddr

	# read timeout on file upload socket.
BWCentralHostTimeout	3600
BWCentralHost		localhost:8570

#################
#
# POSSIBLE CHANGE
#
#################
	# Database info
!CentralDBHost
CentralDBType		DBI:mysql
CentralDBUser		LHCAmi
CentralDBPass		7hc4m1
BWCentralDBName 	bwctl

	# add a read only user so that the cgis have minimum privileges
CGIDBUser		readonly
CGIDBPass		readonly
CGITmpDir               /tmp
#Ploticus                /usr/bin/pl

	# connect/write/read timeout for sending socket (Can be set on a
	# per-node bases if needed.)
SendTimeout		60
SaveThreshold	25

	# Address types and descriptions
	# On Abilene, LAT addrs map to nms4-* and BW addrs map to nms1-*
	# On I2NET, LAT addrs map to nms-rlat and BW addrs map to nms-?thr?
ADDRTYPES   [[BW4 BW6]]

	# ADDRDESC is relative to 'node' so it can be over-ridden in NODE blocks
	# (Useful for specifying the ISP a given address is associated with.)
BW4ADDRDESC   IPv4 Throughput
BW6ADDRDESC   IPv6 Throughput


#######################################################################
# BWCTL Iperf-TCP Test Definition

<TESTSPEC=BWTCP_6HR>
DESCRIPTION                     6 Hour TCP Throughput (iperf)
TOOL                            bwctl/iperf

	# seconds - every 1 hour (on average)
BWTestInterval			21600

	# alpha - percentage to vary each start interval by. (ranomize 
	# +/- interval)
BWTestIntervalStartAlpha	25

	# seconds
BWReportInterval		2

	# TCP send/recv buffer size. (Might not be good to set for auto-scaling
	# kernels)
BWWindowSize			4m

	# do a tcp test
BWTCP

	# seconds
BWTestDuration		        60
</TESTSPEC>


<TESTSPEC=BWTCP_5MIN>
DESCRIPTION                     5 Minute TCP Throughput (iperf)
TOOL                            bwctl/iperf

	# seconds - every 1 hour (on average)
BWTestInterval			300

	# alpha - percentage to vary each start interval by. (ranomize 
	# +/- interval)
BWTestIntervalStartAlpha	25

	# seconds
BWReportInterval		1

	# TCP send/recv buffer size. (Might not be good to set for auto-scaling
	# kernels)
BWWindowSize			4m

	# do a tcp test
BWTCP

	# seconds
BWTestDuration		        10
</TESTSPEC>

#################
#
# MUST CHANGE
#
#################

#######################################################################
# Host definitions, should equal the result of a `uname -a`, this is
#   how the master will determine which machine is running a test.  Its a good
#   idea to enter all machines that are involved in all tests here.

<HOST=fedora*>
NODE	FEDORA
</HOST>

<HOST=hardy*>
NODE	HARDY
</HOST>

<HOST=centos*>
NODE	CENTOS
</HOST>

<HOST=clean-centos4*>
NODE	CENTOS4
</HOST>

<HOST=clean-centos5*>
NODE	CENTOS5
</HOST>

#################
#
# MUST CHANGE
#
#################

#######################################################################
# Node Definitions, needed for each potential member of a mesh

<NODE=FEDORA>
LONGNAME	    FEDORA_VHOST
CONTACTADDR	    192.168.69.152
BW4ADDR	        192.168.69.152:4823
# Note: this is the machine that is running the master/collector, so 
#   we comment out the next part
#NOAGENT
</NODE>

# The next two are 'targets' of the test.  They are just running bwctl

<NODE=HARDY>
LONGNAME	    HARDY_VHOST
CONTACTADDR	    192.168.69.151
BW4ADDR	        192.168.69.151:4823
NOAGENT
</NODE>

<NODE=CENTOS>
LONGNAME	    CENTOS_VHOST
CONTACTADDR	    192.168.69.150
BW4ADDR	        192.168.69.150:4823
NOAGENT
</NODE>

<NODE=CENTOS4>
LONGNAME	    CENTOS4_VHOST
CONTACTADDR	    192.168.69.174
BW4ADDR	        192.168.69.174:4823
NOAGENT
</NODE>

<NODE=CENTOS5>
LONGNAME	    CENTOS5_VHOST
CONTACTADDR	    192.168.69.172
BW4ADDR	        192.168.69.172:4823
NOAGENT
</NODE>


#################
#
# MUST CHANGE
#
#################

#######################################################################
# Group Definition

<GROUP=TEST-STAR>
DESCRIPTION	    Testing of a star configuration
GROUPTYPE	    STAR

# Change the 'center' node, or 'hauptnode' here.  See the example above.  

HAUPTNODE	    CENTOS4

# Add *all* nodes that pareticipate in the tests here

NODES	        [[ CENTOS4 CENTOS5 ]]

# Add another node in that will 'send' to HAUPTNODE
#INCLUDE_SENDERS
# Remove specific senders from the star - even HAUPTNODE (takes precedence)

#   Note that we want to send from each other node to the center (MDM service
#     desk test).  Enter *only* the hauptnode here

EXCLUDE_SENDERS [[ CENTOS4 ]]
# Add another node in that will 'recv' from HAUPTNODE
#INCLUDE_RECEIVERS
# Remove specific receivers from the star - even HAUPTNODE (takes precedence)
#EXCLUDE_RECEIVERS
</GROUP>

#######################################################################
# Measurement Sets

<MeasurementSet=CENTOS5-BWTCP4>
DESCRIPTION	    Star Testing - 5 Minute TCP Throughput (iperf)
ADDRTYPE	    BW4
GROUP	        TEST-STAR
TESTSPEC	    BWTCP_5MIN
EXCLUDE_SELF
</MeasurementSet>
