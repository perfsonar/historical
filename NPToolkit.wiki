= NPToolkit =

== TOC ==

 * Introduction
 * Features
 * Purpose
 * Getting The NPToolkit
 * Quick Start Guide
 * Configuration
 * FAQ

== Introduction ==

The Network Performance Toolkit ([http://e2epi.internet2.edu/network-performance-toolkit.html NPToolkit]) is an experimental version of a [http://www.knoppix.net/ Knoppix] Live-CD bootable disk. The software consists of an [http://www.perfsonar.net/download/bundles/NPToolkit-2.0-beta1.iso ISO] ([http://www.perfsonar.net/download/bundles/NPToolkit-2.0-beta1.md5 MD5] sum) that can be used in one of two ways:

 * Burn the image to a disk (recommended)
 * Mount the ISO filesystem and run as a virtual machine

After either step, the resulting system features a [http://web100.org/ Web100]-enhanced [http://www.kernel.org/pub/linux/kernel/v2.6/ChangeLog-2.6.23.9 Linux 2.6.23-9 kernel] and will start the network performance tools installed on this disk.  All servers start up using a default configuration, which can be customized if the need arises. The disk also brings up the [http://www.ntp.org/ NTP] daemon using a default configuration.

== Features ==

This disk features several performance tools pre-installed and configured:

 * [http://e2epi.internet2.edu/bwctl/ BWCTL]
 * [http://www.cacti.net/ Cacti]
 * [http://e2epi.internet2.edu/ndt/ NDT]
 * [http://www.psc.edu/networking/projects/pathdiag/ NPAD]
 * [http://e2epi.internet2.edu/owamp/ OWAMP]
 * [http://www.internet2.edu/performance/pS-PS/ perfSONAR-PS Tools]
   * [SNMPMA SNMP Measurement Archive]
   * [PSBMA perfSONAR-BUOY Measurement Archive] and [PSBAGENT Collection Framework]
   * [HLS Lookup Service]
   * [PINGER PingER Measurement Archive and Measurement Point]
 * [http://e2epi.internet2.edu/thrulay/ Thrulay]

Graphical and command line tools are available to aide in the customization process when necessary.

== Purpose ==

The original idea for the NPToolkit came from the [http://e2epi.internet2.edu/npw/ Network Performance Workshop] series sponsored by [http://www.internet2.edu Internet2].  The old format of this workshop consisted of a day of tool installation (e.g. installing the Web100 kernel and other performance tools) followed by some time to test and use them.  This particular format did not allow enough time to get to the primary reason many participants choose to sign up: solving network performance problems.

To lower the bar on this complex topic, this disk offers a complete network performance suite pre-installed (and in most cases pre-configured) that is ready to be dropped directly into the network of a NOC of any size.  With the integration of [http://www.perfsonar.net perfSONAR] tools, the results of both passive and active measurements can be shared in a federated environment with your peers enabling the early detection of performance issues.

== Getting The NPToolkit ==

 # Download the following:
   * [http://www.perfsonar.net/download/bundles/NPToolkit-2.0-beta1.iso]
   * [http://www.perfsonar.net/download/bundles/NPToolkit-2.0-beta1.md5]
 # Verify the MD5 sum:
   * md5sum -c NPToolkit-2.0-beta1.iso 
 # Burn the ISO to a CD-ROM
 # Insert the CD-ROM into the tray and boot the system

== Quick Start Guide ==

  # Download and burn the CD as described above
  # Configure your computer to boot from CD
  # Startup your computer with the CD in the drive
  # During the boot process, you'll be presented with a menu of options. Select "Configure drive to hold data/customizations".
  # From the list, select which drive you would like to allow the disc to use to save data.
  # Say yes to format the drive if asked
  # After the drive is formatted, you will return to the original menu of options
  # Select "Configure site settings". You'll be asked some information about the location and administration of this host.
  # After configuring the site settings, you'll return to the original menu of options.
  # Select "Manage Users"
  # You'll see a new menu of options. Select "Change A User's Password"
  # When asked for the username, type in "root" and hit enter, and then enter a password for the root user
  # You'll be returned to the user management menu again
  # Select "Change A User's Password" again
  # When asked for the username, type in "knoppix" and hit enter, and then enter a password for the knoppix user
  # You'll be returned to the user management menu again
  # At this point, you can either select "Add A New User" or simply use the knoppix user as your admin user
  # If you select "Add A New User", you'll be asked to enter in information about the user such as their username, whether they're an admin and a password
  # Once you have finished adding users, select "Exit", and you will be returned to the original menu.
  # Select "Enable/Disable Services"
  # You will be brought to a menu containing the set of services for the NPToolkit. Everything, but ssh is enabled by default.
  # Select which services you would like to enable/disable.
  # When you are done disabling services, select "Exit", and you'll be returned to the original menu
  # By default interface are configured for DHCP. If you need to configure a static IP address for your host, select "Configure Static IP". You will be prompted with a series of questions needed to configure the address.
  # Once your interface is configured, select "Modify advertised interface". This is the interface that services will advertise for external clients to use.
  # If you would like to configure BWCTL, OWAMP, NDT or NPAD, you may do so now by selecting the appropriate menu option
  # Once you have finished configuration, select "exit".
  # You will be asked to reboot. Select "yes".
  # After your machine has rebooted, you will see the menu again. You can either select exit or wait 20 seconds for it to time out.
  # Once your machine has finished booting, you can login either as a user you created or as the user knoppix.
  # Unless you specifically disabled the service, a web interface will be available by connecting to https://HOST_ADDRESS/. This GUI contains links to the available tools, links to some administrative tools for configuring perfSONAR-BUOY, Cacti and PingER, as well as a listing of which services are running on the host.

== Host Configuration ==

=== Hard Disk Configuration ===

The hard disk is used to store permanent data like logs and measurements. Select '1' to configure the hard disk. You will then be given a list of hard disk or LVM partitions. Select which partition the toolkit should use. You will then be asked whether or not to format the drive. The drive must be formatted in order to use it.At this point, you can either exit and reboot or continue configuring the other services.

=== Site Information Configuration ===

The toolkit requires you to enter site information to help differentiate the many services that will be registering. Select '2' to configure the site information.

=== Static IP Configuration ===

By default, the toolkit uses DHCP to configure the interfaces. If need be, however, you can use configure a static ip address by selecting option '8'. Once the static ip is enabled, dhcp can be re-enabled by selecting "Configure Static IP" again, and answering yes to the prompt asking if you'd like to enable DHCP.

=== External Address Configuration ===

The external address is the address that will be advertised by services by default, and will be the address that external users will use to contact the various services. The toolkit attempts to guess a reasonable default. To change this default, select option 11 (Modify external access point).

=== Set Passwords ===

Selecting option 9 (Optional Tools) will bring about another menu. This menu contains an option to set passwords for the "knoppix" and "root" accounts.

=== Enable SSH ===

Selecting option 9 (Optional Tools) will bring about another menu. This menu contains an option to configure and start the SSH daemon

== Service Configuration ==

=== BWCTL Configuration ===

BWCTL is a tool that allows clients to schedule acheivable bandwidth tests using tools like Iperf. After selecting option 3 (Configure BWCTL), there will be a series of prompts allowing you to configure various options, including the maximum amount of bandwidth available for tests, and what users or networks can perform BWCTL tests.

=== OWAMP Configuration ===

OWAMP is a tool that allows clients to schedule one-way delay measurements to and from the host. After selecting option 4 (Configure OWAMP), there will be a series of prompts allowing you to configure various options, including the maximum amount of bandwidth available for tests, and what users or networks can perform OWAMP tests.

=== NDT Configuration ===

NDT is a tool that allows clients to perform diagnostic tests from their machine to the host. Selecting option 5 (Configure NDT) will configure the NDT web page to use the site information entered previously.

=== NPAD Configuration ===

NPAD is a tool that allows clients to perform diagnostic tests from their machine to the host. Selecting option 6 (Configure NPAD) will configure the NPAD web page to use the site information entered previously.

=== PingER Configuration ===

PingER is a tool that performs regular ping tests, and stores it into a database, that is made available by a web services interface. Step-by-step instructions for configuring the set of hosts for PingER to ping are available on the [NPToolkit_PingER NPToolkit PingER] page.

=== SNMP MA/Cacti ===

Cacti is web-based tool for collecting SNMP statistics and making available graphs of the statistics through a web page. The SNMP MA is a service that makes the SNMP statistics collected by Cacti available through a standardized web services interface. Step by step instructions for configuring Cacti are available on the [CactiConfig] page.

=== perfSONAR-BUOY ===

perfSONAR-BUOY is a framework aimed at collecting and exposing periodic tests of the BWCTL and OWAMP measurement tools.  There are a couple of quick configuration steps that must be taken before this software may run, namely to create a list of machines to test with and start the software after this configuration is done.

A step-by-step guide to configuring perfSONAR-BUOY is available on the [NPToolkit_pSB NPToolkit perfSONAR-BUOY] page.

== FAQ ==

 * *Q: How do I logon to the console?*
 * *A:* The NPToolkit console is accessed by logging in as the user *_knoppix_*. By default, there is no password for this account and no remote access is allowed.

 * *Q: How do I get an X-windows environment?*
 * *A:* The NPToolkit was designed for hands-off operations, so it boots up into the command prompt mode. To bring the system up in X11 mode:
   # After the system has booted, log in as *_knoppix_* and run the _startx_ command.

 * *Q: How do I run the NPAD system?*
 * *A:* The [http://www.psc.edu/networking/projects/pathdiag/ NPAD] (Network Path and Application Diagnosis) is a client/server program developed by the network research group at Pittsburgh Supercomputer Center ([http://www.psc.edu PSC]). At boot time, the NPToolkit starts the NPAD server process and leaves it listening on TCP port *8200*. To use this server, a user starts a Java-enabled web browser and points it at the NPToolkit server (http://HOST:8200). The server automatically downloads a Java applet to the client. Then the user runs a test to begin the diagnostic process. Once the test has been completed, the server displays a results page on the clients browser. The user may examine these results and follow the recommendations to resolve problems. If the user is unable to repair a reported problem, the results page URL can be emailed to the appropriate system administrator or NOC operator.  The server retains a complete record of the test results and the raw data used to derive these results. This allows post-processing of interesting results to determine what went wrong and to improve the reporting capabilities of the NPAD server.

 * *Q: How do I use BWCTL?*
 * *A:* [http://e2epi.internet2.edu/bwctl/ BWCTL] (Bandwidth Test Controller) is a client/server program developed to simplify Iperf testing between hosts. At boot time, the NPTookit starts a BWCTL server process and leaves it listening on TCP port *4823*. This server may then be accessed by remote BWCTL clients or you can logon to this NPToolkit server and run tests to remote BWCTL servers. The BWCTL server allows TCP tests with a maximum duration of 30 seconds.
   * To run a test to a remote BWCTL server:
     # Logon to the NPToolkit server using the *_knoppix_* userid
     # Identify the remote server
     # Run the _bwctl -s remote-bwctl-server_ command to stream data for 10 seconds from the your NPToolkit server to the remote BWCTL server. Results are displayed on our console or terminal window.

 * *Q: How do I run the NDT system?*
 * *A:* The [http://e2epi.internet2.edu/ndt/ NDT] (Network Diagnostic Tool) is a client/server program developed to simplify testing to desktop/laptop computers. At boot time, the NPToolkit starts a pair of NDT server processes and leaves them listening on TCP ports *7123* and *3001*. To use this server, a client starts a Java-enabled web browser and points it at the NPToolkit server (http://HOST:7123). The server automatically downloads a Java applet to the client. The end-user can run a test to begin the diagnostic process.  Once the test has been completed, the server displays a results page on the clients browser. The end-user may examine these results and follow the recommendations to resolve problems. If the end-user is unable to repair a reported problem, the user may click the _Report Problems_ button to generate an email that will be addressed to the appropriate NPToolkit administrator.  The server retains a record of the test results to allow the post-processing of interesting results to determine what went wrong and to improve the reporting capabilities of the NDT server.

 * *Q: What is NTP?*
 * *A:* [http://www.ntp.org NTP] (Network Time Protocol) is a program that synchronizes your computers clock to a global time source. An accurate clock is essential for running many of the measurement tests including [http://e2epi.internet2.edu/bwctl/ BWCTL] and [http://e2epi.internet2.edu/owamp/ OWAMP]. The NTP daemon must connect to several, at least four (4), remote time servers to obtain accurately set the local clock. By default, the NPToolkit server synchronized to both Internet2 and public time sources.

 * *Q: How do I use OWAMP?*
 * *A:* [http://e2epi.internet2.edu/owamp/ OWAMP] (One-Way Ping) is a client server program that was developed to provide delay and jitter measurements between two Internet2 hosts. At boot time, the NPToolkit starts an OWAMP server process and leaves it listening on TCP port *861*. This server may then be used by remote clients or you can logon to this NPToolkit server and run tests to remote OWAMP servers. By default, the OWAMP server sends a low-level data stream in each direction and measures the one-way delay and jitter between the two hosts. Separate measurements, one for each direction, are reported to the user at the end of the test.
   * To run a test to a remote OWAMP server:
     # Logon to the NPToolkit server using the *_knoppix_* userid.
     # Identify the remote server.
     # Run the _owping remote-owamp-server_ command to make a pair of 10 second delay measurements (one in each direction) between remote OWAMP server and your NPToolkit server. Results are displayed on your console or terminal window.

 * *Q: Where can I ask questions or report bugs?*
 * *A:* 
   * For questions, you can email to i2-perfsonar _at_ internet2 _dot_ edu
   * For bugs, report them at http://code.google.com/p/perfsonar-ps/issues/list . Label the bug as "Component-NPToolkit", or state in the bug description that you're using the NPtoolkit.

 * *Q: How do I configure the SNMP MA?*
 * *A:* The SNMP MA is pre-configured to use the Cacti SNMP collection system. A step by step guide to configuring cacti is available here at [CactiConfig].

 * *Q: How do I configure the hosts PingER pings?*
 * *A:* There's an included GUI for configuring the sites PingER should collect ping between. Nagivate to https://HOST/cgi-bin/pinger/configure_landmarks.cgi . With this GUI, add/remove hosts and domains from testing. Hit the _Save landmarks_ button when done and restart PingER by logging into the machine and typing _sudo /etc/init.d/PingER.sh restart_.

 * *Q: How do I test that my services are working?*
 * *A:* 
   * Disk - There is a _self status_ page available on every installation: https://HOST/cgi-bin/services.cgi
   * PingER - Navigate to http://tukki.fnal.gov/pinger/pingerUI.pl, Enter the address of the PingER service into the form. To get the address of the PingER service, navigate to https://HOST/ and scroll to PingER; the address will be listed in this area.
   * SNMP MA - Navigate to https://dc211.internet2.edu/cgi-bin/test.cgi?eventType=http://ggf.org/ns/nmwg/characteristics/utilization/2.0&url=HOST_ADDRESS to verify that the SNMP MA is working. To get the address of the SNMP MA service, navigate to https://HOST/ and scroll to SNMP MA; the address will be listed in this area.
   * perfSONAR-BUOY - Navigate to https://dc211.internet2.edu/cgi-bin/test.cgi?eventType=http://ggf.org/ns/nmwg/tools/iperf/2.0&url=HOST_ADDRESS to verify that perfSONAR-BUOY is working. To get the address of the perfSONAR-BUOY service, navigate to https://HOST/ and scroll to perfSONAR-BUOY; the address will be listed in this area.

 * *Q: I'd like to PXE boot the NPToolkit. Is that possible?*
 * *A:* Not currently, but this is a consideration of future releases.

 * *Q: When I boot, it gives me the following error _Can't find knoppix filesystem, sorry. Dropping you to a very limited shell ...._*
 * *A:* This can be attributed to a bad CD burn or a bad ISO image. Check the MD5 sum of the ISO and match this to the posted MD5 value.

 * *Q: I get an error similar to _DBD::mysql::db selectrow_array failed: Table 'pingerMA.data_200807' doesn't exist at /some/path/to/Base.pm line XXX_.*
 * *A:* Ignore this. Depending on OS scheduling, PingER might try to use a table before creation. It should only happen occasionally.

 * *Q: Can I Use a Firewall? *
 * *A:* 
   * To enable the firewall, add all the desired rules to the firewall, and then run the command "/etc/init.d/iptables save". The firewall should then automatically come up when next you boot.
   * There are some caveats to enabling a firewall. If you're going to disable access by default, there are a large number of firewall holes that you'll need to open, and configure changes you'll need to make.
     * SNMP MA
       * open port tcp/8065
     * PingER
       * open port tcp/8075
     * perfSONAR-BUOY
       * open port tcp/8085
     * Lookup Service
       * open port tcp/8095
     * bwctl
       * open port tcp/4823
       * Edit /usr/local/etc/bwctld.conf, set peer_port to a value, and open the tcp port for that value
     * owamp
       * open port tcp/861
       * Edit /usr/local/etc/owampd.conf, set testports to range, and open the tcp ports for that range
     * NDT
       * open port tcp/3001
       * open port tcp/7123
     * NPAD
       * open port tcp/8100
       * open port tcp/8200
     * Apache HTTP Server
       * open port tcp/443
     * SSH
       * open port tcp/22

== Last Updated ==

$Id$